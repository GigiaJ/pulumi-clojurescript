{:path [], :nextjournal/value {:package :directory, :toc {:path [], :nextjournal/value [{:title "", :emoji nil, :path "#", :items [{:title "Pulumi-CLJS library notebook", :emoji nil, :path "#pulumi-cljs-library-notebook", :items [{:title "Outline of Behavior", :emoji nil, :path "#outline-of-behavior", :items []}]}]}], :nextjournal/render-opts {:toc-visibility false, :set-hash? true}, :nextjournal/viewer {:name nextjournal.clerk.viewer/toc-viewer, :render-fn #clerk/render-fn+opts [{:render-evaluator :sci} nextjournal.clerk.render.navbar/render-items], :hash "5dtesrAmYqLZQQHSMEfFTNpmLtY4nC"}}, :sidenotes? false, :toc-visibility false, :atom-var-name->state {}, :ns #clerk/render-fn+opts [{:eval true} (ns user)], :file "notebooks/home.cljc", :scope user, :header {:path [], :nextjournal/value [:div.viewer.w-full.max-w-prose.px-8.not-prose.mt-3 [:div.mb-8.text-xs.sans-serif.text-slate-400 nil nil [:span "Generated with " [:a.font-medium.border-b.border-dotted.border-slate-300.hover:text-indigo-500.hover:border-indigo-500.dark:border-slate-500.dark:hover:text-white.dark:hover:border-white.transition {:href "https://clerk.vision"} "Clerk"] [:<> " from " [:a.font-medium.border-b.border-dotted.border-slate-300.hover:text-indigo-500.hover:border-indigo-500.dark:border-slate-500.dark:hover:text-white.dark:hover:border-white.transition {:href "https://github.com/GigiaJ/pulumi-clojurescript/blob/1bb92ae17671c2bb3ece37f057882c00167c671b/notebooks/home.cljc"} "notebooks/home.cljc" [:<> "@" [:span.tabular-nums "1bb92ae"]]]]]]], :nextjournal/viewer {:name nextjournal.clerk.viewer/html-viewer, :render-fn #clerk/render-fn+opts [{:render-evaluator :sci} nextjournal.clerk.render/render-html], :hash "5drpr3yzJ1CcHNbRHnK2sVyn7YUmXB"}}, :open-graph {:type "article:clerk", :title "Pulumi-CLJS library notebook", :description "I'll be outlining here my thoughts alongside building functional code to neatly interface with Pulumi I've opted to also experiment with using Clerk for my literate programming needs, so the actual layout of the notebook may end up being messy. A solid upside is that on each of these pages, the code that renders and my notes and comments are visible alongside it."}, :title "Pulumi-CLJS library notebook", :blocks [{:path [], :nextjournal/value [{:path [0], :nextjournal/value {:nextjournal/presented {:path [0], :nextjournal/value [:div [:style "\n    .clerk-sidebar { \n      position: fixed; top: 0; left: 0; bottom: 0; \n      width: 260px; background: #1a202c; color: white;\n      padding: 24px; font-family: sans-serif;\n      z-index: 100; border-right: 1px solid #2d3748;\n    }\n    .clerk-main { margin-left: 260px; padding: 40px; max-width: 800px; }\n    .nav-link { \n      display: block; padding: 10px 14px; color: #cbd5e0; \n      text-decoration: none; border-radius: 6px; margin-bottom: 6px;\n      transition: all 0.2s;\n    }\n    .nav-link:hover { background: #2d3748; color: #fff; }\n    header { display: none !important; }\n  "] [:div.clerk-sidebar [:h2.text-sm.font-semibold.uppercase.tracking-wider.text-gray-500.mb-4 "Notebooks"] [:nav ([:a.nav-link {:href "./../../pulumi-clojurescript/"} "Home"] [:a.nav-link {:href "./../..//pulumi-clojurescript/notebooks/config_processor"} "Config processor"] [:a.nav-link {:href "./../..//pulumi-clojurescript/notebooks/safe_fns"} "Safe fns"] [:a.nav-link {:href "./../..//pulumi-clojurescript/notebooks/sidebar"} "Sidebar"])]]], :nextjournal/visibility {:code :hide, :result :show}, :nextjournal/viewer {:name nextjournal.clerk.viewer/html-viewer, :render-fn #clerk/render-fn+opts [{:render-evaluator :sci} nextjournal.clerk.render/render-html], :hash "5drpr3yzJ1CcHNbRHnK2sVyn7YUmXB"}, :nextjournal/render-opts {:id "home/anon-expr-5drvSJspjD55yxYRaEkMmXsAE7Za5c-result"}}, :nextjournal/blob-id "5dsRoadQAy3zAFNUooCGcBxxnqAfWW"}, :nextjournal/render-opts {:id "home/anon-expr-5drvSJspjD55yxYRaEkMmXsAE7Za5c-result"}, :nextjournal/visibility {:code :hide, :result :show}, :nextjournal/viewer {:name nextjournal.clerk.viewer/result-viewer, :render-fn #clerk/render-fn+opts [{:render-evaluator :sci} nextjournal.clerk.render/render-result], :hash "5dtGVHesd2XCTLFYF3aY4kJvkrX1x1"}}], :nextjournal/viewer {:name nextjournal.clerk.viewer/cell-viewer, :render-fn #clerk/render-fn+opts [{:render-evaluator :sci} (fn [xs opts] (into [:<>] (nextjournal.clerk.render/inspect-children opts) xs))], :hash "5dtX6xLh3vbeFdswBY6jLXmB8QTqo2"}} {:path [], :nextjournal/value [{:path [0], :nextjournal/value {:nextjournal/presented {:path [0], :nextjournal/value [:style "header { display: none !important; }"], :nextjournal/visibility {:code :hide, :result :show}, :nextjournal/viewer {:name nextjournal.clerk.viewer/html-viewer, :render-fn #clerk/render-fn+opts [{:render-evaluator :sci} nextjournal.clerk.render/render-html], :hash "5drpr3yzJ1CcHNbRHnK2sVyn7YUmXB"}, :nextjournal/render-opts {:id "home/anon-expr-5dqxHad1LAwfjpYCEby91Z13tp5eKw-result"}}, :nextjournal/blob-id "5dtSHPCJ3y5ExxtqANfhHjmvMaau4X"}, :nextjournal/render-opts {:id "home/anon-expr-5dqxHad1LAwfjpYCEby91Z13tp5eKw-result"}, :nextjournal/visibility {:code :hide, :result :show}, :nextjournal/viewer {:name nextjournal.clerk.viewer/result-viewer, :render-fn #clerk/render-fn+opts [{:render-evaluator :sci} nextjournal.clerk.render/render-result], :hash "5dtGVHesd2XCTLFYF3aY4kJvkrX1x1"}}], :nextjournal/viewer {:name nextjournal.clerk.viewer/cell-viewer, :render-fn #clerk/render-fn+opts [{:render-evaluator :sci} (fn [xs opts] (into [:<>] (nextjournal.clerk.render/inspect-children opts) xs))], :hash "5dtX6xLh3vbeFdswBY6jLXmB8QTqo2"}} {:path [], :nextjournal/value [:div.viewer.markdown-viewer.w-full.max-w-prose.px-8 {:data-block-id "home/markdown-5dtVSTBLfHCCqc1jStyp8jEaBXABkm"} ["h2" {:id "pulumi-cljs-library-notebook"} [:<> "Pulumi-CLJS library notebook"]] [:p [:<> "I'll be outlining here my thoughts alongside building functional code to neatly interface with Pulumi"] [#clerk/render-fn+opts [{:eval true} nextjournal.clerk.render/inspect-presented] {:nextjournal/value [:<> " "], :nextjournal/viewer {:name nextjournal.clerk.viewer/html-viewer, :render-fn #clerk/render-fn+opts [{:render-evaluator :sci} nextjournal.clerk.render/render-html], :hash "5drpr3yzJ1CcHNbRHnK2sVyn7YUmXB"}}] [:<> "I've opted to also experiment with using Clerk for my literate programming needs, so the actual layout of"] [#clerk/render-fn+opts [{:eval true} nextjournal.clerk.render/inspect-presented] {:nextjournal/value [:<> " "], :nextjournal/viewer {:name nextjournal.clerk.viewer/html-viewer, :render-fn #clerk/render-fn+opts [{:render-evaluator :sci} nextjournal.clerk.render/render-html], :hash "5drpr3yzJ1CcHNbRHnK2sVyn7YUmXB"}}] [:<> "the notebook may end up being messy."] [#clerk/render-fn+opts [{:eval true} nextjournal.clerk.render/inspect-presented] {:nextjournal/value [:<> " "], :nextjournal/viewer {:name nextjournal.clerk.viewer/html-viewer, :render-fn #clerk/render-fn+opts [{:render-evaluator :sci} nextjournal.clerk.render/render-html], :hash "5drpr3yzJ1CcHNbRHnK2sVyn7YUmXB"}}] [:<> "A solid upside is that on each of these pages, the code that renders and my notes and comments are visible alongside it."]] [:p [:<> "The major goal is to allow the configs to be as malluable as needed. Meaning anything you could do in the base JS version should function here and"] [#clerk/render-fn+opts [{:eval true} nextjournal.clerk.render/inspect-presented] {:nextjournal/value [:<> " "], :nextjournal/viewer {:name nextjournal.clerk.viewer/html-viewer, :render-fn #clerk/render-fn+opts [{:render-evaluator :sci} nextjournal.clerk.render/render-html], :hash "5drpr3yzJ1CcHNbRHnK2sVyn7YUmXB"}}] [:<> "be parsed and handled appropriately. Instead of entirely leaning on the automation API, this should both augment normal usage as well as full on"] [#clerk/render-fn+opts [{:eval true} nextjournal.clerk.render/inspect-presented] {:nextjournal/value [:<> " "], :nextjournal/viewer {:name nextjournal.clerk.viewer/html-viewer, :render-fn #clerk/render-fn+opts [{:render-evaluator :sci} nextjournal.clerk.render/render-html], :hash "5drpr3yzJ1CcHNbRHnK2sVyn7YUmXB"}}] [:<> "multi-stage and multi-stack deployments that do want to rely on the automation API."]] [:p [:<> "Initially this was built with the single goal of getting a functional build working and after finishing that it became apparent that configs"] [#clerk/render-fn+opts [{:eval true} nextjournal.clerk.render/inspect-presented] {:nextjournal/value [:<> " "], :nextjournal/viewer {:name nextjournal.clerk.viewer/html-viewer, :render-fn #clerk/render-fn+opts [{:render-evaluator :sci} nextjournal.clerk.render/render-html], :hash "5drpr3yzJ1CcHNbRHnK2sVyn7YUmXB"}}] [:<> "were restrictive and prevented ideal use like declaring multiple resources in a single 'definition'. Definition and resources being something defined below."] [#clerk/render-fn+opts [{:eval true} nextjournal.clerk.render/inspect-presented] {:nextjournal/value [:<> " "], :nextjournal/viewer {:name nextjournal.clerk.viewer/html-viewer, :render-fn #clerk/render-fn+opts [{:render-evaluator :sci} nextjournal.clerk.render/render-html], :hash "5drpr3yzJ1CcHNbRHnK2sVyn7YUmXB"}}] [:<> "A secondary goal for this revision is to abstract out any CLJS away from core CLJ code for both re-use as well as to aid in actually visualizing it"] [#clerk/render-fn+opts [{:eval true} nextjournal.clerk.render/inspect-presented] {:nextjournal/value [:<> " "], :nextjournal/viewer {:name nextjournal.clerk.viewer/html-viewer, :render-fn #clerk/render-fn+opts [{:render-evaluator :sci} nextjournal.clerk.render/render-html], :hash "5drpr3yzJ1CcHNbRHnK2sVyn7YUmXB"}}] [:<> "here in Clerk."]] ["h3" {:id "outline-of-behavior"} [:<> "Outline of Behavior"]] [:p [:<> "To define some terminology fairly exclusive to this idiomatic use of Clojure(script) for Pulumi resource definitions is necessary. Since we go beyond simply defining"] [#clerk/render-fn+opts [{:eval true} nextjournal.clerk.render/inspect-presented] {:nextjournal/value [:<> " "], :nextjournal/viewer {:name nextjournal.clerk.viewer/html-viewer, :render-fn #clerk/render-fn+opts [{:render-evaluator :sci} nextjournal.clerk.render/render-html], :hash "5drpr3yzJ1CcHNbRHnK2sVyn7YUmXB"}}] [:<> "resources alone and we also encapsulate group-able ideas into consistent logical groupings. The general logical groupings being Config Definitions. These define a collection"] [#clerk/render-fn+opts [{:eval true} nextjournal.clerk.render/inspect-presented] {:nextjournal/value [:<> " "], :nextjournal/viewer {:name nextjournal.clerk.viewer/html-viewer, :render-fn #clerk/render-fn+opts [{:render-evaluator :sci} nextjournal.clerk.render/render-html], :hash "5drpr3yzJ1CcHNbRHnK2sVyn7YUmXB"}}] [:<> "of resources needed to get to a functional state. They can rely on other elements already being deployed or existing in another stack, but generally speaking they are a       set of changes or deployments to get, as an example, an application from not deployed nor configured to configured in say the vault or other secret manager, DNS entries made,"] [#clerk/render-fn+opts [{:eval true} nextjournal.clerk.render/inspect-presented] {:nextjournal/value [:<> " "], :nextjournal/viewer {:name nextjournal.clerk.viewer/html-viewer, :render-fn #clerk/render-fn+opts [{:render-evaluator :sci} nextjournal.clerk.render/render-html], :hash "5drpr3yzJ1CcHNbRHnK2sVyn7YUmXB"}}] [:<> "Helm chart configured, K8s secret deployed, K8s Gateway and HTTPRoute configured, and the Helm chart deploying the service, deployment, and whatever else."]] [:p [:<> "As such these encapsulate a single goal in which we have a defined end state for the application as well as a start state. At a higher level we offer the ability to define"] [#clerk/render-fn+opts [{:eval true} nextjournal.clerk.render/inspect-presented] {:nextjournal/value [:<> " "], :nextjournal/viewer {:name nextjournal.clerk.viewer/html-viewer, :render-fn #clerk/render-fn+opts [{:render-evaluator :sci} nextjournal.clerk.render/render-html], :hash "5drpr3yzJ1CcHNbRHnK2sVyn7YUmXB"}}] [:<> "the provider needs for these Config Definitions (effectively the infrastructure dependencies). We define this point as the Stack Processor. The Stack Processor handles"] [#clerk/render-fn+opts [{:eval true} nextjournal.clerk.render/inspect-presented] {:nextjournal/value [:<> " "], :nextjournal/viewer {:name nextjournal.clerk.viewer/html-viewer, :render-fn #clerk/render-fn+opts [{:render-evaluator :sci} nextjournal.clerk.render/render-html], :hash "5drpr3yzJ1CcHNbRHnK2sVyn7YUmXB"}}] [:<> "setting up the state for the providers to be available that the Config Definitions will use and as such some level of Stack Processor Definitions "] [:em [:<> "do"]] [:<> " exist, but generally are"] [#clerk/render-fn+opts [{:eval true} nextjournal.clerk.render/inspect-presented] {:nextjournal/value [:<> " "], :nextjournal/viewer {:name nextjournal.clerk.viewer/html-viewer, :render-fn #clerk/render-fn+opts [{:render-evaluator :sci} nextjournal.clerk.render/render-html], :hash "5drpr3yzJ1CcHNbRHnK2sVyn7YUmXB"}}] [:<> "defined in the Executable Core Processor. To add, the code that handles the Config Definitions is the Config Processor. It does as the name implies. Each of these will be linked and"] [#clerk/render-fn+opts [{:eval true} nextjournal.clerk.render/inspect-presented] {:nextjournal/value [:<> " "], :nextjournal/viewer {:name nextjournal.clerk.viewer/html-viewer, :render-fn #clerk/render-fn+opts [{:render-evaluator :sci} nextjournal.clerk.render/render-html], :hash "5drpr3yzJ1CcHNbRHnK2sVyn7YUmXB"}}] [:<> "templates/examples provided alongside helpful diagram."] [#clerk/render-fn+opts [{:eval true} nextjournal.clerk.render/inspect-presented] {:nextjournal/value [:<> " "], :nextjournal/viewer {:name nextjournal.clerk.viewer/html-viewer, :render-fn #clerk/render-fn+opts [{:render-evaluator :sci} nextjournal.clerk.render/render-html], :hash "5drpr3yzJ1CcHNbRHnK2sVyn7YUmXB"}}] [:<> "Alongside the processors and definitions we have Composable Provider Templates, Resource Definition Templates, and a generic set of utility functions for the library."]]], :nextjournal/render-opts {:id "home/markdown-5dtVSTBLfHCCqc1jStyp8jEaBXABkm"}, :nextjournal/viewer {:name nextjournal.clerk.viewer/markdown-node-viewer, :render-fn #clerk/render-fn+opts [{:render-evaluator :sci} identity], :hash "5dsg4Bx9A9L7WvvCgamUoRtxUsmYCe"}} {:path [], :nextjournal/value [{:path [0], :nextjournal/content-type "image/png", :nextjournal/value {:nextjournal/presented {:path [0], :nextjournal/content-type "image/png", :nextjournal/value "./_data/8VtrZEfySmCAh4GCZBxTCwVyXimpBKnEK7QvAuXVQcvVjH62kpjHEjeu8fimHbPb755iSfv2N8aznHzuZ4JmcyDxWa.png", :nextjournal/width :wide, :nextjournal/viewer {:name nextjournal.clerk.viewer/image-viewer, :render-fn #clerk/render-fn+opts [{:render-evaluator :sci} (fn [blob-or-url] [:div.flex.flex-col.items-center.not-prose [:img {:src (nextjournal.clerk.render/url-for blob-or-url)}]])], :hash "5drT9JGE6qJ8mafafimFkbc2LneM6b"}, :nextjournal/render-opts {:id "home/anon-expr-5dsRdm2ZCkDEUwBKxx7e9zrDjZxPBt-result"}}, :nextjournal/blob-id "5dsXMmNXBQXkrBkd1ojw9HZ9XkyNc8"}, :nextjournal/width :wide, :nextjournal/render-opts {:id "home/anon-expr-5dsRdm2ZCkDEUwBKxx7e9zrDjZxPBt-result"}, :nextjournal/viewer {:name nextjournal.clerk.viewer/result-viewer, :render-fn #clerk/render-fn+opts [{:render-evaluator :sci} nextjournal.clerk.render/render-result], :hash "5dtGVHesd2XCTLFYF3aY4kJvkrX1x1"}}], :nextjournal/viewer {:name nextjournal.clerk.viewer/cell-viewer, :render-fn #clerk/render-fn+opts [{:render-evaluator :sci} (fn [xs opts] (into [:<>] (nextjournal.clerk.render/inspect-children opts) xs))], :hash "5dtX6xLh3vbeFdswBY6jLXmB8QTqo2"}}]}, :nextjournal/viewer {:name nextjournal.clerk.viewer/notebook-viewer, :render-fn #clerk/render-fn+opts [{:render-evaluator :sci} nextjournal.clerk.render/render-notebook], :hash "5duAFDxE4sCnRX71Wo6zeCpC9C3djE"}, :katex? nil}