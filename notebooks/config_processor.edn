{:path [], :nextjournal/value {:package :directory, :toc {:path [], :nextjournal/value [{:title "", :emoji nil, :path "#", :items [{:title "", :emoji nil, :path "#", :items [{:title "Resource Config", :emoji nil, :path "#resource-config", :items []}]}]} {:title "", :emoji nil, :path "#", :items [{:title "", :emoji nil, :path "#", :items [{:title "pulumi namespace", :emoji nil, :path "#pulumi-namespace", :items []}]}]} {:title "", :emoji nil, :path "#-2", :items []} {:title "", :emoji nil, :path "#-3", :items [{:title "", :emoji nil, :path "#", :items [{:title "Testing", :emoji nil, :path "#testing", :items []}]}]}], :nextjournal/render-opts {:toc-visibility false, :set-hash? true}, :nextjournal/viewer {:name nextjournal.clerk.viewer/toc-viewer, :render-fn #clerk/render-fn+opts [{:render-evaluator :sci} nextjournal.clerk.render.navbar/render-items], :hash "5dtesrAmYqLZQQHSMEfFTNpmLtY4nC"}}, :sidenotes? false, :toc-visibility false, :atom-var-name->state {}, :ns #clerk/render-fn+opts [{:eval true} (ns config-processor)], :file "notebooks/config_processor.cljc", :scope config-processor, :header {:path [], :nextjournal/value [:div.viewer.w-full.max-w-prose.px-8.not-prose.mt-3 [:div.mb-8.text-xs.sans-serif.text-slate-400 nil [:<> [:a.font-medium.border-b.border-dotted.border-slate-300.hover:text-indigo-500.hover:border-indigo-500.dark:border-slate-500.dark:hover:text-white.dark:hover:border-white.transition {:href "./../../"} "Index"] [:span.mx-2 "â€¢"]] [:span "Generated with " [:a.font-medium.border-b.border-dotted.border-slate-300.hover:text-indigo-500.hover:border-indigo-500.dark:border-slate-500.dark:hover:text-white.dark:hover:border-white.transition {:href "https://clerk.vision"} "Clerk"] [:<> " from " [:a.font-medium.border-b.border-dotted.border-slate-300.hover:text-indigo-500.hover:border-indigo-500.dark:border-slate-500.dark:hover:text-white.dark:hover:border-white.transition {:href "https://github.com/GigiaJ/pulumi-clojurescript/blob/463b28213eecc5994109e7bdd229659eb3ee9f3d/notebooks/config_processor.cljc"} "notebooks/config_processor.cljc" [:<> "@" [:span.tabular-nums "463b282"]]]]]]], :nextjournal/viewer {:name nextjournal.clerk.viewer/html-viewer, :render-fn #clerk/render-fn+opts [{:render-evaluator :sci} nextjournal.clerk.render/render-html], :hash "5drpr3yzJ1CcHNbRHnK2sVyn7YUmXB"}}, :open-graph {:type "article:clerk", :title "Resource Config", :description "Our first steps are then to start pulling apart the old parsing mechanism and build out a testing template to run against it. We don't need Pulumi yet if we do it in this manner. For this example we'll use Harbor since it feels diverse enough to point to."}, :title "Resource Config", :blocks [{:path [], :nextjournal/value [:div.viewer.markdown-viewer.w-full.max-w-prose.px-8 {:data-block-id "config-processor/markdown-5drAc29cDFn8B3XHMTRPvXxNEFqCdy"} [:p [:<> "Our first steps are then to start pulling apart the old parsing mechanism and build out a testing template to run against it."] [#clerk/render-fn+opts [{:eval true} nextjournal.clerk.render/inspect-presented] {:nextjournal/value [:<> " "], :nextjournal/viewer {:name nextjournal.clerk.viewer/html-viewer, :render-fn #clerk/render-fn+opts [{:render-evaluator :sci} nextjournal.clerk.render/render-html], :hash "5drpr3yzJ1CcHNbRHnK2sVyn7YUmXB"}}] [:<> "We don't need Pulumi yet if we do it in this manner."] [#clerk/render-fn+opts [{:eval true} nextjournal.clerk.render/inspect-presented] {:nextjournal/value [:<> " "], :nextjournal/viewer {:name nextjournal.clerk.viewer/html-viewer, :render-fn #clerk/render-fn+opts [{:render-evaluator :sci} nextjournal.clerk.render/render-html], :hash "5drpr3yzJ1CcHNbRHnK2sVyn7YUmXB"}}] [:<> "For this example we'll use Harbor since it feels diverse enough to point to."]] [:p [:<> "As we wish to modernize the form to handle any need for a Pulumi resource definition, we must first start with"] [#clerk/render-fn+opts [{:eval true} nextjournal.clerk.render/inspect-presented] {:nextjournal/value [:<> " "], :nextjournal/viewer {:name nextjournal.clerk.viewer/html-viewer, :render-fn #clerk/render-fn+opts [{:render-evaluator :sci} nextjournal.clerk.render/render-html], :hash "5drpr3yzJ1CcHNbRHnK2sVyn7YUmXB"}}] [:<> "actually defining said resource config definition."]] ["h3" {:id "resource-config"} [:<> "Resource Config"]] [:p [:<> "This will be the resource config definition we use to test and aid in visualization:"]]], :nextjournal/render-opts {:id "config-processor/markdown-5drAc29cDFn8B3XHMTRPvXxNEFqCdy"}, :nextjournal/viewer {:name nextjournal.clerk.viewer/markdown-node-viewer, :render-fn #clerk/render-fn+opts [{:render-evaluator :sci} identity], :hash "5dsg4Bx9A9L7WvvCgamUoRtxUsmYCe"}} {:path [], :nextjournal/value [{:path [0], :nextjournal/value "(def test-config\n  {:stack [{:vault:retrieve {:app-name 'app-name\n                             :app-namespace 'app-name}\n            :pulumi-options {}}\n           [:harbor\n            {:project {}\n             :pulumi-options {}}\n            {:robot-account {:name '(str \"kube-\" app-name \"-robot\")\n                             :namespace 'app-name\n                             :level \"project\"\n                             :permissions [{:kind \"project\"\n                                            :namespace 'app-name\n                                            :access [{:action \"pull\" :resource \"repository\"}\n                                                     {:action \"list\" :resource \"repository\"}]}]}\n             :pulumi-options {}}]\n           {:k8s:secret {:metadata\n                         {:name \"harbor-creds-secrets\"\n                          :namespace \"kube-system\"\n                          :annotations {\"replicator.v1.mittwald.de/replicate-to\" \"*\"}}\n                         :type \"kubernetes.io/dockerconfigjson\"\n                         :stringData {\".dockerconfigjson\" '(str \"{\\\"auths\\\":{\\\"\"\n                                                                host\n                                                                \"\\\":{\\\"auth\\\":\\\"\"\n                                                                (b64e (str (-> :harbor:robot-account .-fullName) \":\" (-> :harbor:robot-account .-secret)))\n                                                                \"\\\"}}}\")}}\n            :pulumi-options {}}]})", :nextjournal/render-opts {:loc {:line 24, :end-line 50, :column 1, :end-column 35}, :id "config-processor/test-config-code"}, :nextjournal/viewer {:name nextjournal.clerk.viewer/code-block-viewer, :render-fn #clerk/render-fn+opts [{:render-evaluator :sci} nextjournal.clerk.render/render-code-block], :hash "5dru1FUcVRTRrVKJFbNw4FG2wXmiwB"}}], :nextjournal/viewer {:name nextjournal.clerk.viewer/cell-viewer, :render-fn #clerk/render-fn+opts [{:render-evaluator :sci} (fn [xs opts] (into [:<>] (nextjournal.clerk.render/inspect-children opts) xs))], :hash "5dtX6xLh3vbeFdswBY6jLXmB8QTqo2"}} {:path [], :nextjournal/value [:div.viewer.markdown-viewer.w-full.max-w-prose.px-8 {:data-block-id "config-processor/markdown-5dr4WnYA8MRedq3pSxyLYwxpu9WBeX"} ["h1" {:id ""}] ["h3" {:id "pulumi-namespace"} [:<> "pulumi namespace"]] ["h1" {:id "-2"}] [:p [:<> "The next couple methods live inside the Pulumi namespace in the library, but are best described where their usage is"] [#clerk/render-fn+opts [{:eval true} nextjournal.clerk.render/inspect-presented] {:nextjournal/value [:<> " "], :nextjournal/viewer {:name nextjournal.clerk.viewer/html-viewer, :render-fn #clerk/render-fn+opts [{:render-evaluator :sci} nextjournal.clerk.render/render-html], :hash "5drpr3yzJ1CcHNbRHnK2sVyn7YUmXB"}}] [:<> "most relevant."]] ["h1" {:id "-3"}] [:p [:<> "Now we should define the functions that we'll actually use to parse this template and perform the processing on it."] [#clerk/render-fn+opts [{:eval true} nextjournal.clerk.render/inspect-presented] {:nextjournal/value [:<> " "], :nextjournal/viewer {:name nextjournal.clerk.viewer/html-viewer, :render-fn #clerk/render-fn+opts [{:render-evaluator :sci} nextjournal.clerk.render/render-html], :hash "5drpr3yzJ1CcHNbRHnK2sVyn7YUmXB"}}] [:<> "I found a neat feature in Clerk combined with Clojure's REPL ns source-fn allows us to leave the source code neatly in the"] [#clerk/render-fn+opts [{:eval true} nextjournal.clerk.render/inspect-presented] {:nextjournal/value [:<> " "], :nextjournal/viewer {:name nextjournal.clerk.viewer/html-viewer, :render-fn #clerk/render-fn+opts [{:render-evaluator :sci} nextjournal.clerk.render/render-html], :hash "5drpr3yzJ1CcHNbRHnK2sVyn7YUmXB"}}] [:<> "expected location, but both use and document it here."]] [:p [:<> "So this is a monadic lift. A fancy way of saying this method is to operate on wrapped Pulumi output values without the function itself knowing"] [#clerk/render-fn+opts [{:eval true} nextjournal.clerk.render/inspect-presented] {:nextjournal/value [:<> " "], :nextjournal/viewer {:name nextjournal.clerk.viewer/html-viewer, :render-fn #clerk/render-fn+opts [{:render-evaluator :sci} nextjournal.clerk.render/render-html], :hash "5drpr3yzJ1CcHNbRHnK2sVyn7YUmXB"}}] [:<> "anything about Pulumi. So we can use this to handle this with Clojure or Clojurescript."] [#clerk/render-fn+opts [{:eval true} nextjournal.clerk.render/inspect-presented] {:nextjournal/value [:<> " "], :nextjournal/viewer {:name nextjournal.clerk.viewer/html-viewer, :render-fn #clerk/render-fn+opts [{:render-evaluator :sci} nextjournal.clerk.render/render-html], :hash "5drpr3yzJ1CcHNbRHnK2sVyn7YUmXB"}}] [:<> "In short it is what unwraps and allows operating on Pulumi outputs."]]], :nextjournal/render-opts {:id "config-processor/markdown-5dr4WnYA8MRedq3pSxyLYwxpu9WBeX"}, :nextjournal/viewer {:name nextjournal.clerk.viewer/markdown-node-viewer, :render-fn #clerk/render-fn+opts [{:render-evaluator :sci} identity], :hash "5dsg4Bx9A9L7WvvCgamUoRtxUsmYCe"}} {:path [], :nextjournal/value [{:path [0], :nextjournal/value {:nextjournal/presented {:path [0], :nextjournal/value "(defn p-lift [f args]\n  (if (some output? args)\n    (apply-output (all args)\n                  (fn [resolved-args] (apply f resolved-args)))\n    (apply f args)))", :nextjournal/render-opts {:language "clojure", :id "config-processor/anon-expr-5dqv7NxDbP18uaszgX6MByMoWxyiJX-result"}, :nextjournal/visibility {:code :hide, :result :show}, :nextjournal/viewer {:name nextjournal.clerk.viewer/code-viewer, :render-fn #clerk/render-fn+opts [{:render-evaluator :sci} nextjournal.clerk.render/render-code], :hash "5dsJQw12yyyd7TcZEf52VSHxnqnJUC"}}, :nextjournal/blob-id "5dsQd4Et1jA2jgF9XvSbLWvcboAz8T"}, :nextjournal/render-opts {:language "clojure", :id "config-processor/anon-expr-5dqv7NxDbP18uaszgX6MByMoWxyiJX-result"}, :nextjournal/visibility {:code :hide, :result :show}, :nextjournal/viewer {:name nextjournal.clerk.viewer/result-viewer, :render-fn #clerk/render-fn+opts [{:render-evaluator :sci} nextjournal.clerk.render/render-result], :hash "5dtGVHesd2XCTLFYF3aY4kJvkrX1x1"}}], :nextjournal/viewer {:name nextjournal.clerk.viewer/cell-viewer, :render-fn #clerk/render-fn+opts [{:render-evaluator :sci} (fn [xs opts] (into [:<>] (nextjournal.clerk.render/inspect-children opts) xs))], :hash "5dtX6xLh3vbeFdswBY6jLXmB8QTqo2"}} {:path [], :nextjournal/value [:div.viewer.markdown-viewer.w-full.max-w-prose.px-8 {:data-block-id "config-processor/markdown-5dtaeWp3CFDpgZxNbo4vBpzeM7TfTL"} [:p [:<> "This is a monadic bind. This allows values to be moved through. It checks the value to determine if we need to unwrap it."] [#clerk/render-fn+opts [{:eval true} nextjournal.clerk.render/inspect-presented] {:nextjournal/value [:<> " "], :nextjournal/viewer {:name nextjournal.clerk.viewer/html-viewer, :render-fn #clerk/render-fn+opts [{:render-evaluator :sci} nextjournal.clerk.render/render-html], :hash "5drpr3yzJ1CcHNbRHnK2sVyn7YUmXB"}}] [:<> "If it is plain we execute on it immediately, and if it isn't we pass it on and defer the execution."]]], :nextjournal/render-opts {:id "config-processor/markdown-5dtaeWp3CFDpgZxNbo4vBpzeM7TfTL"}, :nextjournal/viewer {:name nextjournal.clerk.viewer/markdown-node-viewer, :render-fn #clerk/render-fn+opts [{:render-evaluator :sci} identity], :hash "5dsg4Bx9A9L7WvvCgamUoRtxUsmYCe"}} {:path [], :nextjournal/value [{:path [0], :nextjournal/value {:nextjournal/presented {:path [0], :nextjournal/value "(defn p-chain [val f]\n  (if (output? val)\n    (apply-output val f)\n    (f val)))", :nextjournal/render-opts {:language "clojure", :id "config-processor/anon-expr-5duF3GCtiqpyKegQf8LTP1Dmcusqh3-result"}, :nextjournal/visibility {:code :hide, :result :show}, :nextjournal/viewer {:name nextjournal.clerk.viewer/code-viewer, :render-fn #clerk/render-fn+opts [{:render-evaluator :sci} nextjournal.clerk.render/render-code], :hash "5dsJQw12yyyd7TcZEf52VSHxnqnJUC"}}, :nextjournal/blob-id "5dtPgTRsR7niNu69URGQbhvEutFa6N"}, :nextjournal/render-opts {:language "clojure", :id "config-processor/anon-expr-5duF3GCtiqpyKegQf8LTP1Dmcusqh3-result"}, :nextjournal/visibility {:code :hide, :result :show}, :nextjournal/viewer {:name nextjournal.clerk.viewer/result-viewer, :render-fn #clerk/render-fn+opts [{:render-evaluator :sci} nextjournal.clerk.render/render-result], :hash "5dtGVHesd2XCTLFYF3aY4kJvkrX1x1"}}], :nextjournal/viewer {:name nextjournal.clerk.viewer/cell-viewer, :render-fn #clerk/render-fn+opts [{:render-evaluator :sci} (fn [xs opts] (into [:<>] (nextjournal.clerk.render/inspect-children opts) xs))], :hash "5dtX6xLh3vbeFdswBY6jLXmB8QTqo2"}} {:path [], :nextjournal/value [:div.viewer.markdown-viewer.w-full.max-w-prose.px-8 {:data-block-id "config-processor/markdown-5drRGShMgbfxFMoWtvpU8cARCVEWps"} [:p [:<> "Now we want to have a \"virtual\" threading operator. It is to provide a clean interpreter to the config"] [#clerk/render-fn+opts [{:eval true} nextjournal.clerk.render/inspect-presented] {:nextjournal/value [:<> " "], :nextjournal/viewer {:name nextjournal.clerk.viewer/html-viewer, :render-fn #clerk/render-fn+opts [{:render-evaluator :sci} nextjournal.clerk.render/render-html], :hash "5drpr3yzJ1CcHNbRHnK2sVyn7YUmXB"}}] [:<> "That is to say it should feel fluid to use. Idiomatic to the Clojure experience and interacting with Pulumi outputs"] [#clerk/render-fn+opts [{:eval true} nextjournal.clerk.render/inspect-presented] {:nextjournal/value [:<> " "], :nextjournal/viewer {:name nextjournal.clerk.viewer/html-viewer, :render-fn #clerk/render-fn+opts [{:render-evaluator :sci} nextjournal.clerk.render/render-html], :hash "5drpr3yzJ1CcHNbRHnK2sVyn7YUmXB"}}] [:<> "So as an example we might want the config to have: (-> :harbor:robot-account .-fullName)"] [#clerk/render-fn+opts [{:eval true} nextjournal.clerk.render/inspect-presented] {:nextjournal/value [:<> " "], :nextjournal/viewer {:name nextjournal.clerk.viewer/html-viewer, :render-fn #clerk/render-fn+opts [{:render-evaluator :sci} nextjournal.clerk.render/render-html], :hash "5drpr3yzJ1CcHNbRHnK2sVyn7YUmXB"}}] [:<> "So firstly :harbor:robot-account would represent a Pulumi Output object. So we can't treat it as a normal object."] [#clerk/render-fn+opts [{:eval true} nextjournal.clerk.render/inspect-presented] {:nextjournal/value [:<> " "], :nextjournal/viewer {:name nextjournal.clerk.viewer/html-viewer, :render-fn #clerk/render-fn+opts [{:render-evaluator :sci} nextjournal.clerk.render/render-html], :hash "5drpr3yzJ1CcHNbRHnK2sVyn7YUmXB"}}] [:<> "Without this our configs have no way of easily stepping through the JS object itself and interact with prior step"] [#clerk/render-fn+opts [{:eval true} nextjournal.clerk.render/inspect-presented] {:nextjournal/value [:<> " "], :nextjournal/viewer {:name nextjournal.clerk.viewer/html-viewer, :render-fn #clerk/render-fn+opts [{:render-evaluator :sci} nextjournal.clerk.render/render-html], :hash "5drpr3yzJ1CcHNbRHnK2sVyn7YUmXB"}}] [:<> "results. This interaction is consistent everywhere possible, so even on exports of the data to Pulumi to store into"] [#clerk/render-fn+opts [{:eval true} nextjournal.clerk.render/inspect-presented] {:nextjournal/value [:<> " "], :nextjournal/viewer {:name nextjournal.clerk.viewer/html-viewer, :render-fn #clerk/render-fn+opts [{:render-evaluator :sci} nextjournal.clerk.render/render-html], :hash "5drpr3yzJ1CcHNbRHnK2sVyn7YUmXB"}}] [:<> "the state file we can easily interact and retrieve."]]], :nextjournal/render-opts {:id "config-processor/markdown-5drRGShMgbfxFMoWtvpU8cARCVEWps"}, :nextjournal/viewer {:name nextjournal.clerk.viewer/markdown-node-viewer, :render-fn #clerk/render-fn+opts [{:render-evaluator :sci} identity], :hash "5dsg4Bx9A9L7WvvCgamUoRtxUsmYCe"}} {:path [], :nextjournal/value [{:path [0], :nextjournal/value {:nextjournal/presented {:path [0], :nextjournal/value "(defmacro p-> [x & forms]\n  (let [wrap (fn [acc form]\n               (cond\n                 ;; Keyword: (:key)\n                 (keyword? form)\n                 `(p-chain ~acc (fn [v#] (get v# ~form)))\n\n                 ;; String: (\"prop\")\n                 (string? form)\n                 `(p-chain ~acc (fn [v#] (aget v# ~form)))\n\n                 ;; Property Access: (.-prop)\n                 (and (symbol? form) (str/starts-with? (name form) \".-\"))\n                 (let [prop (subs (name form) 2)]\n                   `(p-chain ~acc (fn [v#] (aget v# ~prop))))\n\n                 ;; Anonymous Function: (fn [x] ...) or (fn* [] ...)\n                 (and (list? form)\n                      (symbol? (first form))\n                      (#{\"fn\" \"fn*\"} (name (first form))))\n                 `(p-chain ~acc (fn [v#] (~form v#)))\n\n                 ;; Bare Symbol (Function): my-func\n                 (symbol? form)\n                 `(p-chain ~acc (fn [v#] (~form v#)))\n\n                 ;; Standard Function Call: (my-func arg)\n                 (list? form)\n                 (let [f (first form)\n                       args (rest form)]\n                   `(p-chain ~acc (fn [v#] (~f v# ~@args))))\n\n                 :else\n                 (throw (ex-info \"Unsupported form in p->\" {:form form}))))]\n    (reduce wrap x forms)))", :nextjournal/render-opts {:language "clojure", :id "config-processor/anon-expr-5ds5iaJFATrtNnR8pE4TRT7GLuJ5u4-result"}, :nextjournal/visibility {:code :hide, :result :show}, :nextjournal/viewer {:name nextjournal.clerk.viewer/code-viewer, :render-fn #clerk/render-fn+opts [{:render-evaluator :sci} nextjournal.clerk.render/render-code], :hash "5dsJQw12yyyd7TcZEf52VSHxnqnJUC"}}, :nextjournal/blob-id "5dtyy6DfPoNYxXRBk6vFaZ3NE2gPdc"}, :nextjournal/render-opts {:language "clojure", :id "config-processor/anon-expr-5ds5iaJFATrtNnR8pE4TRT7GLuJ5u4-result"}, :nextjournal/visibility {:code :hide, :result :show}, :nextjournal/viewer {:name nextjournal.clerk.viewer/result-viewer, :render-fn #clerk/render-fn+opts [{:render-evaluator :sci} nextjournal.clerk.render/render-result], :hash "5dtGVHesd2XCTLFYF3aY4kJvkrX1x1"}}], :nextjournal/viewer {:name nextjournal.clerk.viewer/cell-viewer, :render-fn #clerk/render-fn+opts [{:render-evaluator :sci} (fn [xs opts] (into [:<>] (nextjournal.clerk.render/inspect-children opts) xs))], :hash "5dtX6xLh3vbeFdswBY6jLXmB8QTqo2"}} {:path [], :nextjournal/value [:div.viewer.markdown-viewer.w-full.max-w-prose.px-8 {:data-block-id "config-processor/markdown-5duAmKvLQpti8r5jUYjtGAjN5AzdL3"} [:p [:<> "This is effectively the config interpreter. It takes a config definition and context"] [#clerk/render-fn+opts [{:eval true} nextjournal.clerk.render/inspect-presented] {:nextjournal/value [:<> " "], :nextjournal/viewer {:name nextjournal.clerk.viewer/html-viewer, :render-fn #clerk/render-fn+opts [{:render-evaluator :sci} nextjournal.clerk.render/render-html], :hash "5drpr3yzJ1CcHNbRHnK2sVyn7YUmXB"}}] [:<> "and evaluates them. The context is typically "] [:em [:<> "everything"]] [:<> " including whatever"] [#clerk/render-fn+opts [{:eval true} nextjournal.clerk.render/inspect-presented] {:nextjournal/value [:<> " "], :nextjournal/viewer {:name nextjournal.clerk.viewer/html-viewer, :render-fn #clerk/render-fn+opts [{:render-evaluator :sci} nextjournal.clerk.render/render-html], :hash "5drpr3yzJ1CcHNbRHnK2sVyn7YUmXB"}}] [:<> "secret provider you use and a retrieval (or setter) step. This way you can"] [#clerk/render-fn+opts [{:eval true} nextjournal.clerk.render/inspect-presented] {:nextjournal/value [:<> " "], :nextjournal/viewer {:name nextjournal.clerk.viewer/html-viewer, :render-fn #clerk/render-fn+opts [{:render-evaluator :sci} nextjournal.clerk.render/render-html], :hash "5drpr3yzJ1CcHNbRHnK2sVyn7YUmXB"}}] [:<> "use evaluated secrets stored in Vault for example."] [#clerk/render-fn+opts [{:eval true} nextjournal.clerk.render/inspect-presented] {:nextjournal/value [:<> " "], :nextjournal/viewer {:name nextjournal.clerk.viewer/html-viewer, :render-fn #clerk/render-fn+opts [{:render-evaluator :sci} nextjournal.clerk.render/render-html], :hash "5drpr3yzJ1CcHNbRHnK2sVyn7YUmXB"}}] [:<> "The postwalk works from the bottom up. So if you have {:stack [:vault:retrieve {:app-name 'app-name}]}"] [#clerk/render-fn+opts [{:eval true} nextjournal.clerk.render/inspect-presented] {:nextjournal/value [:<> " "], :nextjournal/viewer {:name nextjournal.clerk.viewer/html-viewer, :render-fn #clerk/render-fn+opts [{:render-evaluator :sci} nextjournal.clerk.render/render-html], :hash "5drpr3yzJ1CcHNbRHnK2sVyn7YUmXB"}}] [:<> "Then app-name is resolved "] [:em [:<> "first"]] [:<> " and it works its way up to vault:retrieve."] [#clerk/render-fn+opts [{:eval true} nextjournal.clerk.render/inspect-presented] {:nextjournal/value [:<> " "], :nextjournal/viewer {:name nextjournal.clerk.viewer/html-viewer, :render-fn #clerk/render-fn+opts [{:render-evaluator :sci} nextjournal.clerk.render/render-html], :hash "5drpr3yzJ1CcHNbRHnK2sVyn7YUmXB"}}] [:<> "The conditions determine whether we need to use our virtual threading mecro, our function callers (in the safe-fns)"] [#clerk/render-fn+opts [{:eval true} nextjournal.clerk.render/inspect-presented] {:nextjournal/value [:<> " "], :nextjournal/viewer {:name nextjournal.clerk.viewer/html-viewer, :render-fn #clerk/render-fn+opts [{:render-evaluator :sci} nextjournal.clerk.render/render-html], :hash "5drpr3yzJ1CcHNbRHnK2sVyn7YUmXB"}}] [:<> "or our symbol lookup for resolving plain values at the top-level of the config."]]], :nextjournal/render-opts {:id "config-processor/markdown-5duAmKvLQpti8r5jUYjtGAjN5AzdL3"}, :nextjournal/viewer {:name nextjournal.clerk.viewer/markdown-node-viewer, :render-fn #clerk/render-fn+opts [{:render-evaluator :sci} identity], :hash "5dsg4Bx9A9L7WvvCgamUoRtxUsmYCe"}} {:path [], :nextjournal/value [{:path [0], :nextjournal/value {:nextjournal/presented {:path [0], :nextjournal/value "(defn resolve-template [template values]\n  (walk/postwalk\n   (fn [x]\n     (cond\n       (and (list? x) (= (first x) '->))\n       (let [[_ start-val & steps] x\n             resource (cond\n                        ;; Magic Lookup: (:key) -> fetch from values + COERCE\n                        (keyword? start-val)\n                        (coerce-value (get values start-val))\n\n                        ;; Symbol: Already resolved by postwalk, just use it\n                        ;; postwalk visits children first, so the symbol branch below \n                        ;;  already ran and coerced this if it was a symbol lookup\n                        :else start-val)]\n         (p-threading resource steps))\n\n       ;; Standard Handlers\n       (and (list? x) (contains? safe-fns (first x)))\n       (let [f    (get safe-fns (first x))\n             args (rest x)]\n         (p-lift f (doall args)))\n\n       ;; Symbol Lookup (With Coercion)\n       (symbol? x)\n       (let [k (keyword x)]\n         (cond\n           ;; Try Keyword Match (:app-name)\n           (contains? values k) (coerce-value (get values k))\n\n           ;; Try Symbol Match ('app-name)\n           (contains? values x) (coerce-value (get values x))\n\n           ;; Fallback: It's just a symbol (maybe a function name or local var)\n           :else x))\n\n       :else x))\n   template))", :nextjournal/render-opts {:language "clojure", :id "config-processor/anon-expr-5dquzGLu51fnWegGMSKoNc9fUrVX5v-result"}, :nextjournal/visibility {:code :hide, :result :show}, :nextjournal/viewer {:name nextjournal.clerk.viewer/code-viewer, :render-fn #clerk/render-fn+opts [{:render-evaluator :sci} nextjournal.clerk.render/render-code], :hash "5dsJQw12yyyd7TcZEf52VSHxnqnJUC"}}, :nextjournal/blob-id "5du1XmRiBCgFMT3a98TcjEwfZwQNBs"}, :nextjournal/render-opts {:language "clojure", :id "config-processor/anon-expr-5dquzGLu51fnWegGMSKoNc9fUrVX5v-result"}, :nextjournal/visibility {:code :hide, :result :show}, :nextjournal/viewer {:name nextjournal.clerk.viewer/result-viewer, :render-fn #clerk/render-fn+opts [{:render-evaluator :sci} nextjournal.clerk.render/render-result], :hash "5dtGVHesd2XCTLFYF3aY4kJvkrX1x1"}}], :nextjournal/viewer {:name nextjournal.clerk.viewer/cell-viewer, :render-fn #clerk/render-fn+opts [{:render-evaluator :sci} (fn [xs opts] (into [:<>] (nextjournal.clerk.render/inspect-children opts) xs))], :hash "5dtX6xLh3vbeFdswBY6jLXmB8QTqo2"}} {:path [], :nextjournal/value [:div.viewer.markdown-viewer.w-full.max-w-prose.px-8 {:data-block-id "config-processor/markdown-5dtw5dW7EEz5LMAfiBVcMDj4kk2dQd"} [:p [:<> "It might be helpful to include some visualization aids in the form of diagrams in the execution flow for processing"] [#clerk/render-fn+opts [{:eval true} nextjournal.clerk.render/inspect-presented] {:nextjournal/value [:<> " "], :nextjournal/viewer {:name nextjournal.clerk.viewer/html-viewer, :render-fn #clerk/render-fn+opts [{:render-evaluator :sci} nextjournal.clerk.render/render-html], :hash "5drpr3yzJ1CcHNbRHnK2sVyn7YUmXB"}}] [:<> "a config."] [#clerk/render-fn+opts [{:eval true} nextjournal.clerk.render/inspect-presented] {:nextjournal/value [:<> " "], :nextjournal/viewer {:name nextjournal.clerk.viewer/html-viewer, :render-fn #clerk/render-fn+opts [{:render-evaluator :sci} nextjournal.clerk.render/render-html], :hash "5drpr3yzJ1CcHNbRHnK2sVyn7YUmXB"}}] [:<> "This helps illustrate how the postwalk visits each node in our config."]]], :nextjournal/render-opts {:id "config-processor/markdown-5dtw5dW7EEz5LMAfiBVcMDj4kk2dQd"}, :nextjournal/viewer {:name nextjournal.clerk.viewer/markdown-node-viewer, :render-fn #clerk/render-fn+opts [{:render-evaluator :sci} identity], :hash "5dsg4Bx9A9L7WvvCgamUoRtxUsmYCe"}} {:path [], :nextjournal/value [{:path [0], :nextjournal/value {:nextjournal/presented {:path [0], :nextjournal/value "graph BT\n    %% The Leaves (Step 1)\n    L1(\"Leaf: 'app-name\") -->|Resolves to value| P1\n    L2(\"Leaf: :harbor:robot-account\") -->|Evaluated| T1\n    L3(\"Leaf: .-fullName\") -->|Evaluated| T1\n    \n    %% The Inner Expressions (Step 2)\n    subgraph Step 2: Deepest Expressions\n      T1(\"Expr: -> ... .-fullName\") -->|Result: 'robot-main'| B64\n      T2(\"Expr: -> ... .-secret\") -->|Result: 'xyz123'| B64\n    end\n\n    %% The Middle Layers (Step 3)\n    subgraph Step 3: Intermediate Functions\n      B64(\"Expr: b64e ...\") -->|Result: 'Og=='| STR\n      P1(\"Expr: str 'kube-' ...\") -->|Result: 'kube-harbor-robot'| ROBOT_MAP\n    end\n\n    %% The Outer Layers (Step 4)\n    subgraph Step 4: Outer Expressions\n      STR(\"Expr: str 'auths' ... \") -->|Result: JSON String| FINAL_MAP\n    end\n\n    %% The Containers (Step 5)\n    subgraph Step 5: Container Reconstruction\n      ROBOT_MAP{:robot-account ...} --> FINAL_STACK\n      FINAL_MAP{:stringData ...} --> FINAL_STACK\n    end\n\n    FINAL_STACK[Final Vector] --> ROOT[Resulting Map]\n\n    classDef leaf fill:#e1f5fe,stroke:#01579b\n    classDef expr fill:#fff9c4,stroke:#fbc02d\n    classDef container fill:#e8f5e9,stroke:#2e7d32\n    \n    class L1,L2,L3 leaf\n    class T1,T2,B64,P1,STR expr\n    class ROBOT_MAP,FINAL_MAP,FINAL_STACK container", :nextjournal/visibility {:code :hide, :result :show}, :nextjournal/viewer {:render-fn #clerk/render-fn+opts [{:render-evaluator :sci} (fn [value] (when value [nextjournal.clerk.render/with-d3-require {:package ["mermaid@8.14/dist/mermaid.js"]} (fn [mermaid] [:div {:ref (fn [el] (when el (.initialize mermaid (clj->js {:startOnLoad false})) (.render mermaid (str "id" (js/Math.floor (js/Math.random 1000))) value (fn* [p1__16428#] (set! (.-innerHTML el) p1__16428#)))))}])]))], :hash "5dsJck7E9BrHwc95u46xUpJ2vjFgrq"}, :nextjournal/render-opts {:id "config-processor/anon-expr-5dtaJPjJoMuZQMDZaFD4SCNZEhJVvY-result"}}, :nextjournal/blob-id "5du4z6qcxhCpakQH7YSJSmvWYkvLte"}, :nextjournal/render-opts {:id "config-processor/anon-expr-5dtaJPjJoMuZQMDZaFD4SCNZEhJVvY-result"}, :nextjournal/visibility {:code :hide, :result :show}, :nextjournal/viewer {:name nextjournal.clerk.viewer/result-viewer, :render-fn #clerk/render-fn+opts [{:render-evaluator :sci} nextjournal.clerk.render/render-result], :hash "5dtGVHesd2XCTLFYF3aY4kJvkrX1x1"}}], :nextjournal/viewer {:name nextjournal.clerk.viewer/cell-viewer, :render-fn #clerk/render-fn+opts [{:render-evaluator :sci} (fn [xs opts] (into [:<>] (nextjournal.clerk.render/inspect-children opts) xs))], :hash "5dtX6xLh3vbeFdswBY6jLXmB8QTqo2"}} {:path [], :nextjournal/value [:div.viewer.markdown-viewer.w-full.max-w-prose.px-8 {:data-block-id "config-processor/markdown-5drD7JDweMaHv9xLHEou7E6LudF3R9"} [:p [:<> "With this we can note that auto-substitution of variables with their values is occurring."]]], :nextjournal/render-opts {:id "config-processor/markdown-5drD7JDweMaHv9xLHEou7E6LudF3R9"}, :nextjournal/viewer {:name nextjournal.clerk.viewer/markdown-node-viewer, :render-fn #clerk/render-fn+opts [{:render-evaluator :sci} identity], :hash "5dsg4Bx9A9L7WvvCgamUoRtxUsmYCe"}} {:path [], :nextjournal/value [{:path [0], :nextjournal/value "(proc/resolve-template test-config {:app-name \"harbor\"})", :nextjournal/render-opts {:loc {:line 140, :end-line 140, :column 1, :end-column 57}, :id "config-processor/anon-expr-5dqwp6CwNWUW4wm9kPFddjtStSbwL2-code"}, :nextjournal/viewer {:name nextjournal.clerk.viewer/code-block-viewer, :render-fn #clerk/render-fn+opts [{:render-evaluator :sci} nextjournal.clerk.render/render-code-block], :hash "5dru1FUcVRTRrVKJFbNw4FG2wXmiwB"}} {:path [1], :nextjournal/value {:nextjournal/presented {:path [1], :nextjournal/value [{:path [1 0], :nextjournal/value [{:path [1 0 0], :nextjournal/value :stack, :nextjournal/viewer {:name nextjournal.clerk.viewer/keyword-viewer, :render-fn #clerk/render-fn+opts [{:render-evaluator :sci} (fn [x] [:span.cmt-atom.inspected-value (str x)])], :hash "5dsp5Uy2KDqwuALVVk33HXMZdpXGBq"}} {:path [1 0 1], :nextjournal/value [{:path [1 0 1 0], :nextjournal/value [{:path [1 0 1 0 0], :nextjournal/value [{:path [1 0 1 0 0 0], :nextjournal/value :pulumi-options, :nextjournal/viewer {:name nextjournal.clerk.viewer/keyword-viewer, :render-fn #clerk/render-fn+opts [{:render-evaluator :sci} (fn [x] [:span.cmt-atom.inspected-value (str x)])], :hash "5dsp5Uy2KDqwuALVVk33HXMZdpXGBq"}} {:path [1 0 1 0 0 1], :nextjournal/value [], :nextjournal/viewer {:name nextjournal.clerk.viewer/map-viewer, :render-fn #clerk/render-fn+opts [{:render-evaluator :sci} nextjournal.clerk.render/render-map], :opening-paren "{", :closing-paren ("}"), :page-size 10, :hash "5drc3ac5ux7kS4h2vozdxwsrKDqSmn"}}], :nextjournal/viewer {:name nextjournal.clerk.viewer/map-entry-viewer, :render-fn #clerk/render-fn+opts [{:render-evaluator :sci} (fn [xs opts] (into [:<>] (comp (nextjournal.clerk.render/inspect-children opts) (interpose " ")) xs))], :page-size 2, :hash "5dsRuzZximgoCTqHkts5WgKf7zc8xg"}} {:path [1 0 1 0 1], :nextjournal/value [{:path [1 0 1 0 1 0], :nextjournal/value :vault:retrieve, :nextjournal/viewer {:name nextjournal.clerk.viewer/keyword-viewer, :render-fn #clerk/render-fn+opts [{:render-evaluator :sci} (fn [x] [:span.cmt-atom.inspected-value (str x)])], :hash "5dsp5Uy2KDqwuALVVk33HXMZdpXGBq"}} {:path [1 0 1 0 1 1], :nextjournal/value [{:path [1 0 1 0 1 1 0], :nextjournal/value [{:path [1 0 1 0 1 1 0 0], :nextjournal/value :app-name, :nextjournal/viewer {:name nextjournal.clerk.viewer/keyword-viewer, :render-fn #clerk/render-fn+opts [{:render-evaluator :sci} (fn [x] [:span.cmt-atom.inspected-value (str x)])], :hash "5dsp5Uy2KDqwuALVVk33HXMZdpXGBq"}} {:path [1 0 1 0 1 1 0 1], :nextjournal/value "harbor", :nextjournal/viewer {:name nextjournal.clerk.viewer/string-viewer, :render-fn #clerk/render-fn+opts [{:render-evaluator :sci} nextjournal.clerk.render/render-quoted-string], :opening-paren "\"", :closing-paren ("\""), :page-size 80, :hash "5dsDiKZaSjZpuyav79P69dRKiDtE2s"}}], :nextjournal/viewer {:name nextjournal.clerk.viewer/map-entry-viewer, :render-fn #clerk/render-fn+opts [{:render-evaluator :sci} (fn [xs opts] (into [:<>] (comp (nextjournal.clerk.render/inspect-children opts) (interpose " ")) xs))], :page-size 2, :hash "5dsRuzZximgoCTqHkts5WgKf7zc8xg"}} {:path [1 0 1 0 1 1 1], :nextjournal/value [{:path [1 0 1 0 1 1 1 0], :nextjournal/value :app-namespace, :nextjournal/viewer {:name nextjournal.clerk.viewer/keyword-viewer, :render-fn #clerk/render-fn+opts [{:render-evaluator :sci} (fn [x] [:span.cmt-atom.inspected-value (str x)])], :hash "5dsp5Uy2KDqwuALVVk33HXMZdpXGBq"}} {:path [1 0 1 0 1 1 1 1], :nextjournal/value "harbor", :nextjournal/viewer {:name nextjournal.clerk.viewer/string-viewer, :render-fn #clerk/render-fn+opts [{:render-evaluator :sci} nextjournal.clerk.render/render-quoted-string], :opening-paren "\"", :closing-paren ("\"" "}" "}"), :page-size 80, :hash "5dsDiKZaSjZpuyav79P69dRKiDtE2s"}}], :nextjournal/viewer {:name nextjournal.clerk.viewer/map-entry-viewer, :render-fn #clerk/render-fn+opts [{:render-evaluator :sci} (fn [xs opts] (into [:<>] (comp (nextjournal.clerk.render/inspect-children opts) (interpose " ")) xs))], :page-size 2, :hash "5dsRuzZximgoCTqHkts5WgKf7zc8xg"}}], :nextjournal/viewer {:name nextjournal.clerk.viewer/map-viewer, :render-fn #clerk/render-fn+opts [{:render-evaluator :sci} nextjournal.clerk.render/render-map], :opening-paren "{", :page-size 10, :hash "5drc3ac5ux7kS4h2vozdxwsrKDqSmn"}}], :nextjournal/viewer {:name nextjournal.clerk.viewer/map-entry-viewer, :render-fn #clerk/render-fn+opts [{:render-evaluator :sci} (fn [xs opts] (into [:<>] (comp (nextjournal.clerk.render/inspect-children opts) (interpose " ")) xs))], :page-size 2, :hash "5dsRuzZximgoCTqHkts5WgKf7zc8xg"}}], :nextjournal/viewer {:name nextjournal.clerk.viewer/map-viewer, :render-fn #clerk/render-fn+opts [{:render-evaluator :sci} nextjournal.clerk.render/render-map], :opening-paren "{", :page-size 10, :hash "5drc3ac5ux7kS4h2vozdxwsrKDqSmn"}} {:path [1 0 1 1], :nextjournal/value [{:path [1 0 1 1 0], :nextjournal/value :harbor, :nextjournal/viewer {:name nextjournal.clerk.viewer/keyword-viewer, :render-fn #clerk/render-fn+opts [{:render-evaluator :sci} (fn [x] [:span.cmt-atom.inspected-value (str x)])], :hash "5dsp5Uy2KDqwuALVVk33HXMZdpXGBq"}} {:path [1 0 1 1 1], :nextjournal/value [{:path [1 0 1 1 1 0], :nextjournal/value [{:path [1 0 1 1 1 0 0], :nextjournal/value :project, :nextjournal/viewer {:name nextjournal.clerk.viewer/keyword-viewer, :render-fn #clerk/render-fn+opts [{:render-evaluator :sci} (fn [x] [:span.cmt-atom.inspected-value (str x)])], :hash "5dsp5Uy2KDqwuALVVk33HXMZdpXGBq"}} {:path [1 0 1 1 1 0 1], :nextjournal/value [], :nextjournal/viewer {:name nextjournal.clerk.viewer/map-viewer, :render-fn #clerk/render-fn+opts [{:render-evaluator :sci} nextjournal.clerk.render/render-map], :opening-paren "{", :closing-paren ("}"), :page-size 10, :hash "5drc3ac5ux7kS4h2vozdxwsrKDqSmn"}}], :nextjournal/viewer {:name nextjournal.clerk.viewer/map-entry-viewer, :render-fn #clerk/render-fn+opts [{:render-evaluator :sci} (fn [xs opts] (into [:<>] (comp (nextjournal.clerk.render/inspect-children opts) (interpose " ")) xs))], :page-size 2, :hash "5dsRuzZximgoCTqHkts5WgKf7zc8xg"}} {:path [1 0 1 1 1 1], :nextjournal/value [{:path [1 0 1 1 1 1 0], :nextjournal/value :pulumi-options, :nextjournal/viewer {:name nextjournal.clerk.viewer/keyword-viewer, :render-fn #clerk/render-fn+opts [{:render-evaluator :sci} (fn [x] [:span.cmt-atom.inspected-value (str x)])], :hash "5dsp5Uy2KDqwuALVVk33HXMZdpXGBq"}} {:path [1 0 1 1 1 1 1], :nextjournal/value [], :nextjournal/viewer {:name nextjournal.clerk.viewer/map-viewer, :render-fn #clerk/render-fn+opts [{:render-evaluator :sci} nextjournal.clerk.render/render-map], :opening-paren "{", :closing-paren ("}" "}"), :page-size 10, :hash "5drc3ac5ux7kS4h2vozdxwsrKDqSmn"}}], :nextjournal/viewer {:name nextjournal.clerk.viewer/map-entry-viewer, :render-fn #clerk/render-fn+opts [{:render-evaluator :sci} (fn [xs opts] (into [:<>] (comp (nextjournal.clerk.render/inspect-children opts) (interpose " ")) xs))], :page-size 2, :hash "5dsRuzZximgoCTqHkts5WgKf7zc8xg"}}], :nextjournal/viewer {:name nextjournal.clerk.viewer/map-viewer, :render-fn #clerk/render-fn+opts [{:render-evaluator :sci} nextjournal.clerk.render/render-map], :opening-paren "{", :page-size 10, :hash "5drc3ac5ux7kS4h2vozdxwsrKDqSmn"}} {:path [1 0 1 1 2], :nextjournal/value [{:path [1 0 1 1 2 0], :nextjournal/value [{:path [1 0 1 1 2 0 0], :nextjournal/value :pulumi-options, :nextjournal/viewer {:name nextjournal.clerk.viewer/keyword-viewer, :render-fn #clerk/render-fn+opts [{:render-evaluator :sci} (fn [x] [:span.cmt-atom.inspected-value (str x)])], :hash "5dsp5Uy2KDqwuALVVk33HXMZdpXGBq"}} {:path [1 0 1 1 2 0 1], :nextjournal/value [], :nextjournal/viewer {:name nextjournal.clerk.viewer/map-viewer, :render-fn #clerk/render-fn+opts [{:render-evaluator :sci} nextjournal.clerk.render/render-map], :opening-paren "{", :closing-paren ("}"), :page-size 10, :hash "5drc3ac5ux7kS4h2vozdxwsrKDqSmn"}}], :nextjournal/viewer {:name nextjournal.clerk.viewer/map-entry-viewer, :render-fn #clerk/render-fn+opts [{:render-evaluator :sci} (fn [xs opts] (into [:<>] (comp (nextjournal.clerk.render/inspect-children opts) (interpose " ")) xs))], :page-size 2, :hash "5dsRuzZximgoCTqHkts5WgKf7zc8xg"}} {:path [1 0 1 1 2 1], :nextjournal/value [{:path [1 0 1 1 2 1 0], :nextjournal/value :robot-account, :nextjournal/viewer {:name nextjournal.clerk.viewer/keyword-viewer, :render-fn #clerk/render-fn+opts [{:render-evaluator :sci} (fn [x] [:span.cmt-atom.inspected-value (str x)])], :hash "5dsp5Uy2KDqwuALVVk33HXMZdpXGBq"}} {:path [1 0 1 1 2 1 1], :nextjournal/value [{:path [1 0 1 1 2 1 1 0], :nextjournal/value [{:path [1 0 1 1 2 1 1 0 0], :nextjournal/value :level, :nextjournal/viewer {:name nextjournal.clerk.viewer/keyword-viewer, :render-fn #clerk/render-fn+opts [{:render-evaluator :sci} (fn [x] [:span.cmt-atom.inspected-value (str x)])], :hash "5dsp5Uy2KDqwuALVVk33HXMZdpXGBq"}} {:path [1 0 1 1 2 1 1 0 1], :nextjournal/value "project", :nextjournal/viewer {:name nextjournal.clerk.viewer/string-viewer, :render-fn #clerk/render-fn+opts [{:render-evaluator :sci} nextjournal.clerk.render/render-quoted-string], :opening-paren "\"", :closing-paren ("\""), :page-size 80, :hash "5dsDiKZaSjZpuyav79P69dRKiDtE2s"}}], :nextjournal/viewer {:name nextjournal.clerk.viewer/map-entry-viewer, :render-fn #clerk/render-fn+opts [{:render-evaluator :sci} (fn [xs opts] (into [:<>] (comp (nextjournal.clerk.render/inspect-children opts) (interpose " ")) xs))], :page-size 2, :hash "5dsRuzZximgoCTqHkts5WgKf7zc8xg"}} {:path [1 0 1 1 2 1 1 1], :nextjournal/value [{:path [1 0 1 1 2 1 1 1 0], :nextjournal/value :name, :nextjournal/viewer {:name nextjournal.clerk.viewer/keyword-viewer, :render-fn #clerk/render-fn+opts [{:render-evaluator :sci} (fn [x] [:span.cmt-atom.inspected-value (str x)])], :hash "5dsp5Uy2KDqwuALVVk33HXMZdpXGBq"}} {:path [1 0 1 1 2 1 1 1 1], :nextjournal/value "kube-harbor-robot", :nextjournal/viewer {:name nextjournal.clerk.viewer/string-viewer, :render-fn #clerk/render-fn+opts [{:render-evaluator :sci} nextjournal.clerk.render/render-quoted-string], :opening-paren "\"", :closing-paren ("\""), :page-size 80, :hash "5dsDiKZaSjZpuyav79P69dRKiDtE2s"}}], :nextjournal/viewer {:name nextjournal.clerk.viewer/map-entry-viewer, :render-fn #clerk/render-fn+opts [{:render-evaluator :sci} (fn [xs opts] (into [:<>] (comp (nextjournal.clerk.render/inspect-children opts) (interpose " ")) xs))], :page-size 2, :hash "5dsRuzZximgoCTqHkts5WgKf7zc8xg"}} {:path [1 0 1 1 2 1 1 2], :nextjournal/value [{:path [1 0 1 1 2 1 1 2 0], :nextjournal/value :namespace, :nextjournal/viewer {:name nextjournal.clerk.viewer/keyword-viewer, :render-fn #clerk/render-fn+opts [{:render-evaluator :sci} (fn [x] [:span.cmt-atom.inspected-value (str x)])], :hash "5dsp5Uy2KDqwuALVVk33HXMZdpXGBq"}} {:path [1 0 1 1 2 1 1 2 1], :nextjournal/value "harbor", :nextjournal/viewer {:name nextjournal.clerk.viewer/string-viewer, :render-fn #clerk/render-fn+opts [{:render-evaluator :sci} nextjournal.clerk.render/render-quoted-string], :opening-paren "\"", :closing-paren ("\""), :page-size 80, :hash "5dsDiKZaSjZpuyav79P69dRKiDtE2s"}}], :nextjournal/viewer {:name nextjournal.clerk.viewer/map-entry-viewer, :render-fn #clerk/render-fn+opts [{:render-evaluator :sci} (fn [xs opts] (into [:<>] (comp (nextjournal.clerk.render/inspect-children opts) (interpose " ")) xs))], :page-size 2, :hash "5dsRuzZximgoCTqHkts5WgKf7zc8xg"}} {:path [1 0 1 1 2 1 1 3], :nextjournal/value [{:path [1 0 1 1 2 1 1 3 0], :nextjournal/value :permissions, :nextjournal/viewer {:name nextjournal.clerk.viewer/keyword-viewer, :render-fn #clerk/render-fn+opts [{:render-evaluator :sci} (fn [x] [:span.cmt-atom.inspected-value (str x)])], :hash "5dsp5Uy2KDqwuALVVk33HXMZdpXGBq"}} {:path [1 0 1 1 2 1 1 3 1], :nextjournal/value [{:path [1 0 1 1 2 1 1 3 1 0], :nextjournal/value [{:path [1 0 1 1 2 1 1 3 1 0 0], :nextjournal/value [{:path [1 0 1 1 2 1 1 3 1 0 0 0], :nextjournal/value :access, :nextjournal/viewer {:name nextjournal.clerk.viewer/keyword-viewer, :render-fn #clerk/render-fn+opts [{:render-evaluator :sci} (fn [x] [:span.cmt-atom.inspected-value (str x)])], :hash "5dsp5Uy2KDqwuALVVk33HXMZdpXGBq"}} {:path [1 0 1 1 2 1 1 3 1 0 0 1], :nextjournal/value [{:path [1 0 1 1 2 1 1 3 1 0 0 1 0], :nextjournal/value [{:path [1 0 1 1 2 1 1 3 1 0 0 1 0 0], :nextjournal/value [{:path [1 0 1 1 2 1 1 3 1 0 0 1 0 0 0], :nextjournal/value :action, :nextjournal/viewer {:name nextjournal.clerk.viewer/keyword-viewer, :render-fn #clerk/render-fn+opts [{:render-evaluator :sci} (fn [x] [:span.cmt-atom.inspected-value (str x)])], :hash "5dsp5Uy2KDqwuALVVk33HXMZdpXGBq"}} {:path [1 0 1 1 2 1 1 3 1 0 0 1 0 0 1], :nextjournal/value "pull", :nextjournal/viewer {:name nextjournal.clerk.viewer/string-viewer, :render-fn #clerk/render-fn+opts [{:render-evaluator :sci} nextjournal.clerk.render/render-quoted-string], :opening-paren "\"", :closing-paren ("\""), :page-size 80, :hash "5dsDiKZaSjZpuyav79P69dRKiDtE2s"}}], :nextjournal/viewer {:name nextjournal.clerk.viewer/map-entry-viewer, :render-fn #clerk/render-fn+opts [{:render-evaluator :sci} (fn [xs opts] (into [:<>] (comp (nextjournal.clerk.render/inspect-children opts) (interpose " ")) xs))], :page-size 2, :hash "5dsRuzZximgoCTqHkts5WgKf7zc8xg"}} {:path [1 0 1 1 2 1 1 3 1 0 0 1 0 1], :nextjournal/value [{:path [1 0 1 1 2 1 1 3 1 0 0 1 0 1 0], :nextjournal/value :resource, :nextjournal/viewer {:name nextjournal.clerk.viewer/keyword-viewer, :render-fn #clerk/render-fn+opts [{:render-evaluator :sci} (fn [x] [:span.cmt-atom.inspected-value (str x)])], :hash "5dsp5Uy2KDqwuALVVk33HXMZdpXGBq"}} {:path [1 0 1 1 2 1 1 3 1 0 0 1 0 1 1], :nextjournal/value "repository", :nextjournal/viewer {:name nextjournal.clerk.viewer/string-viewer, :render-fn #clerk/render-fn+opts [{:render-evaluator :sci} nextjournal.clerk.render/render-quoted-string], :opening-paren "\"", :closing-paren ("\"" "}"), :page-size 80, :hash "5dsDiKZaSjZpuyav79P69dRKiDtE2s"}}], :nextjournal/viewer {:name nextjournal.clerk.viewer/map-entry-viewer, :render-fn #clerk/render-fn+opts [{:render-evaluator :sci} (fn [xs opts] (into [:<>] (comp (nextjournal.clerk.render/inspect-children opts) (interpose " ")) xs))], :page-size 2, :hash "5dsRuzZximgoCTqHkts5WgKf7zc8xg"}}], :nextjournal/viewer {:name nextjournal.clerk.viewer/map-viewer, :render-fn #clerk/render-fn+opts [{:render-evaluator :sci} nextjournal.clerk.render/render-map], :opening-paren "{", :page-size 10, :hash "5drc3ac5ux7kS4h2vozdxwsrKDqSmn"}} {:path [1 0 1 1 2 1 1 3 1 0 0 1 1], :nextjournal/value [{:path [1 0 1 1 2 1 1 3 1 0 0 1 1 0], :nextjournal/value [{:path [1 0 1 1 2 1 1 3 1 0 0 1 1 0 0], :nextjournal/value :action, :nextjournal/viewer {:name nextjournal.clerk.viewer/keyword-viewer, :render-fn #clerk/render-fn+opts [{:render-evaluator :sci} (fn [x] [:span.cmt-atom.inspected-value (str x)])], :hash "5dsp5Uy2KDqwuALVVk33HXMZdpXGBq"}} {:path [1 0 1 1 2 1 1 3 1 0 0 1 1 0 1], :nextjournal/value "list", :nextjournal/viewer {:name nextjournal.clerk.viewer/string-viewer, :render-fn #clerk/render-fn+opts [{:render-evaluator :sci} nextjournal.clerk.render/render-quoted-string], :opening-paren "\"", :closing-paren ("\""), :page-size 80, :hash "5dsDiKZaSjZpuyav79P69dRKiDtE2s"}}], :nextjournal/viewer {:name nextjournal.clerk.viewer/map-entry-viewer, :render-fn #clerk/render-fn+opts [{:render-evaluator :sci} (fn [xs opts] (into [:<>] (comp (nextjournal.clerk.render/inspect-children opts) (interpose " ")) xs))], :page-size 2, :hash "5dsRuzZximgoCTqHkts5WgKf7zc8xg"}} {:path [1 0 1 1 2 1 1 3 1 0 0 1 1 1], :nextjournal/value [{:path [1 0 1 1 2 1 1 3 1 0 0 1 1 1 0], :nextjournal/value :resource, :nextjournal/viewer {:name nextjournal.clerk.viewer/keyword-viewer, :render-fn #clerk/render-fn+opts [{:render-evaluator :sci} (fn [x] [:span.cmt-atom.inspected-value (str x)])], :hash "5dsp5Uy2KDqwuALVVk33HXMZdpXGBq"}} {:path [1 0 1 1 2 1 1 3 1 0 0 1 1 1 1], :nextjournal/value "repository", :nextjournal/viewer {:name nextjournal.clerk.viewer/string-viewer, :render-fn #clerk/render-fn+opts [{:render-evaluator :sci} nextjournal.clerk.render/render-quoted-string], :opening-paren "\"", :closing-paren ("\"" "}" "]"), :page-size 80, :hash "5dsDiKZaSjZpuyav79P69dRKiDtE2s"}}], :nextjournal/viewer {:name nextjournal.clerk.viewer/map-entry-viewer, :render-fn #clerk/render-fn+opts [{:render-evaluator :sci} (fn [xs opts] (into [:<>] (comp (nextjournal.clerk.render/inspect-children opts) (interpose " ")) xs))], :page-size 2, :hash "5dsRuzZximgoCTqHkts5WgKf7zc8xg"}}], :nextjournal/viewer {:name nextjournal.clerk.viewer/map-viewer, :render-fn #clerk/render-fn+opts [{:render-evaluator :sci} nextjournal.clerk.render/render-map], :opening-paren "{", :page-size 10, :hash "5drc3ac5ux7kS4h2vozdxwsrKDqSmn"}}], :nextjournal/viewer {:name nextjournal.clerk.viewer/vector-viewer, :render-fn #clerk/render-fn+opts [{:render-evaluator :sci} nextjournal.clerk.render/render-coll], :opening-paren "[", :page-size 20, :hash "5dsD1KJESfc8Dy8gPeGQfZCX2ayE8f"}}], :nextjournal/viewer {:name nextjournal.clerk.viewer/map-entry-viewer, :render-fn #clerk/render-fn+opts [{:render-evaluator :sci} (fn [xs opts] (into [:<>] (comp (nextjournal.clerk.render/inspect-children opts) (interpose " ")) xs))], :page-size 2, :hash "5dsRuzZximgoCTqHkts5WgKf7zc8xg"}} {:path [1 0 1 1 2 1 1 3 1 0 1], :nextjournal/value [{:path [1 0 1 1 2 1 1 3 1 0 1 0], :nextjournal/value :kind, :nextjournal/viewer {:name nextjournal.clerk.viewer/keyword-viewer, :render-fn #clerk/render-fn+opts [{:render-evaluator :sci} (fn [x] [:span.cmt-atom.inspected-value (str x)])], :hash "5dsp5Uy2KDqwuALVVk33HXMZdpXGBq"}} {:path [1 0 1 1 2 1 1 3 1 0 1 1], :nextjournal/value "project", :nextjournal/viewer {:name nextjournal.clerk.viewer/string-viewer, :render-fn #clerk/render-fn+opts [{:render-evaluator :sci} nextjournal.clerk.render/render-quoted-string], :opening-paren "\"", :closing-paren ("\""), :page-size 80, :hash "5dsDiKZaSjZpuyav79P69dRKiDtE2s"}}], :nextjournal/viewer {:name nextjournal.clerk.viewer/map-entry-viewer, :render-fn #clerk/render-fn+opts [{:render-evaluator :sci} (fn [xs opts] (into [:<>] (comp (nextjournal.clerk.render/inspect-children opts) (interpose " ")) xs))], :page-size 2, :hash "5dsRuzZximgoCTqHkts5WgKf7zc8xg"}} {:path [1 0 1 1 2 1 1 3 1 0 2], :nextjournal/value [{:path [1 0 1 1 2 1 1 3 1 0 2 0], :nextjournal/value :namespace, :nextjournal/viewer {:name nextjournal.clerk.viewer/keyword-viewer, :render-fn #clerk/render-fn+opts [{:render-evaluator :sci} (fn [x] [:span.cmt-atom.inspected-value (str x)])], :hash "5dsp5Uy2KDqwuALVVk33HXMZdpXGBq"}} {:path [1 0 1 1 2 1 1 3 1 0 2 1], :nextjournal/value "harbor", :nextjournal/viewer {:name nextjournal.clerk.viewer/string-viewer, :render-fn #clerk/render-fn+opts [{:render-evaluator :sci} nextjournal.clerk.render/render-quoted-string], :opening-paren "\"", :closing-paren ("\"" "}" "]" "}" "}" "]"), :page-size 80, :hash "5dsDiKZaSjZpuyav79P69dRKiDtE2s"}}], :nextjournal/viewer {:name nextjournal.clerk.viewer/map-entry-viewer, :render-fn #clerk/render-fn+opts [{:render-evaluator :sci} (fn [xs opts] (into [:<>] (comp (nextjournal.clerk.render/inspect-children opts) (interpose " ")) xs))], :page-size 2, :hash "5dsRuzZximgoCTqHkts5WgKf7zc8xg"}}], :nextjournal/viewer {:name nextjournal.clerk.viewer/map-viewer, :render-fn #clerk/render-fn+opts [{:render-evaluator :sci} nextjournal.clerk.render/render-map], :opening-paren "{", :page-size 10, :hash "5drc3ac5ux7kS4h2vozdxwsrKDqSmn"}}], :nextjournal/viewer {:name nextjournal.clerk.viewer/vector-viewer, :render-fn #clerk/render-fn+opts [{:render-evaluator :sci} nextjournal.clerk.render/render-coll], :opening-paren "[", :page-size 20, :hash "5dsD1KJESfc8Dy8gPeGQfZCX2ayE8f"}}], :nextjournal/viewer {:name nextjournal.clerk.viewer/map-entry-viewer, :render-fn #clerk/render-fn+opts [{:render-evaluator :sci} (fn [xs opts] (into [:<>] (comp (nextjournal.clerk.render/inspect-children opts) (interpose " ")) xs))], :page-size 2, :hash "5dsRuzZximgoCTqHkts5WgKf7zc8xg"}}], :nextjournal/viewer {:name nextjournal.clerk.viewer/map-viewer, :render-fn #clerk/render-fn+opts [{:render-evaluator :sci} nextjournal.clerk.render/render-map], :opening-paren "{", :page-size 10, :hash "5drc3ac5ux7kS4h2vozdxwsrKDqSmn"}}], :nextjournal/viewer {:name nextjournal.clerk.viewer/map-entry-viewer, :render-fn #clerk/render-fn+opts [{:render-evaluator :sci} (fn [xs opts] (into [:<>] (comp (nextjournal.clerk.render/inspect-children opts) (interpose " ")) xs))], :page-size 2, :hash "5dsRuzZximgoCTqHkts5WgKf7zc8xg"}}], :nextjournal/viewer {:name nextjournal.clerk.viewer/map-viewer, :render-fn #clerk/render-fn+opts [{:render-evaluator :sci} nextjournal.clerk.render/render-map], :opening-paren "{", :page-size 10, :hash "5drc3ac5ux7kS4h2vozdxwsrKDqSmn"}}], :nextjournal/viewer {:name nextjournal.clerk.viewer/vector-viewer, :render-fn #clerk/render-fn+opts [{:render-evaluator :sci} nextjournal.clerk.render/render-coll], :opening-paren "[", :page-size 20, :hash "5dsD1KJESfc8Dy8gPeGQfZCX2ayE8f"}} {:path [1 0 1 2], :nextjournal/value [{:path [1 0 1 2 0], :nextjournal/value [{:path [1 0 1 2 0 0], :nextjournal/value :k8s:secret, :nextjournal/viewer {:name nextjournal.clerk.viewer/keyword-viewer, :render-fn #clerk/render-fn+opts [{:render-evaluator :sci} (fn [x] [:span.cmt-atom.inspected-value (str x)])], :hash "5dsp5Uy2KDqwuALVVk33HXMZdpXGBq"}} {:path [1 0 1 2 0 1], :nextjournal/value [{:path [1 0 1 2 0 1 0], :nextjournal/value [{:path [1 0 1 2 0 1 0 0], :nextjournal/value :metadata, :nextjournal/viewer {:name nextjournal.clerk.viewer/keyword-viewer, :render-fn #clerk/render-fn+opts [{:render-evaluator :sci} (fn [x] [:span.cmt-atom.inspected-value (str x)])], :hash "5dsp5Uy2KDqwuALVVk33HXMZdpXGBq"}} {:path [1 0 1 2 0 1 0 1], :nextjournal/value [{:path [1 0 1 2 0 1 0 1 0], :nextjournal/value [{:path [1 0 1 2 0 1 0 1 0 0], :nextjournal/value :annotations, :nextjournal/viewer {:name nextjournal.clerk.viewer/keyword-viewer, :render-fn #clerk/render-fn+opts [{:render-evaluator :sci} (fn [x] [:span.cmt-atom.inspected-value (str x)])], :hash "5dsp5Uy2KDqwuALVVk33HXMZdpXGBq"}} {:path [1 0 1 2 0 1 0 1 0 1], :nextjournal/value [{:path [1 0 1 2 0 1 0 1 0 1 0], :nextjournal/value [{:path [1 0 1 2 0 1 0 1 0 1 0 0], :nextjournal/value "replicator.v1.mittwald.de/replicate-to", :nextjournal/viewer {:name nextjournal.clerk.viewer/string-viewer, :render-fn #clerk/render-fn+opts [{:render-evaluator :sci} nextjournal.clerk.render/render-quoted-string], :opening-paren "\"", :closing-paren ("\""), :page-size 80, :hash "5dsDiKZaSjZpuyav79P69dRKiDtE2s"}} {:path [1 0 1 2 0 1 0 1 0 1 0 1], :nextjournal/value "*", :nextjournal/viewer {:name nextjournal.clerk.viewer/string-viewer, :render-fn #clerk/render-fn+opts [{:render-evaluator :sci} nextjournal.clerk.render/render-quoted-string], :opening-paren "\"", :closing-paren ("\"" "}"), :page-size 80, :hash "5dsDiKZaSjZpuyav79P69dRKiDtE2s"}}], :nextjournal/viewer {:name nextjournal.clerk.viewer/map-entry-viewer, :render-fn #clerk/render-fn+opts [{:render-evaluator :sci} (fn [xs opts] (into [:<>] (comp (nextjournal.clerk.render/inspect-children opts) (interpose " ")) xs))], :page-size 2, :hash "5dsRuzZximgoCTqHkts5WgKf7zc8xg"}}], :nextjournal/viewer {:name nextjournal.clerk.viewer/map-viewer, :render-fn #clerk/render-fn+opts [{:render-evaluator :sci} nextjournal.clerk.render/render-map], :opening-paren "{", :page-size 10, :hash "5drc3ac5ux7kS4h2vozdxwsrKDqSmn"}}], :nextjournal/viewer {:name nextjournal.clerk.viewer/map-entry-viewer, :render-fn #clerk/render-fn+opts [{:render-evaluator :sci} (fn [xs opts] (into [:<>] (comp (nextjournal.clerk.render/inspect-children opts) (interpose " ")) xs))], :page-size 2, :hash "5dsRuzZximgoCTqHkts5WgKf7zc8xg"}} {:path [1 0 1 2 0 1 0 1 1], :nextjournal/value [{:path [1 0 1 2 0 1 0 1 1 0], :nextjournal/value :name, :nextjournal/viewer {:name nextjournal.clerk.viewer/keyword-viewer, :render-fn #clerk/render-fn+opts [{:render-evaluator :sci} (fn [x] [:span.cmt-atom.inspected-value (str x)])], :hash "5dsp5Uy2KDqwuALVVk33HXMZdpXGBq"}} {:path [1 0 1 2 0 1 0 1 1 1], :nextjournal/value "harbor-creds-secrets", :nextjournal/viewer {:name nextjournal.clerk.viewer/string-viewer, :render-fn #clerk/render-fn+opts [{:render-evaluator :sci} nextjournal.clerk.render/render-quoted-string], :opening-paren "\"", :closing-paren ("\""), :page-size 80, :hash "5dsDiKZaSjZpuyav79P69dRKiDtE2s"}}], :nextjournal/viewer {:name nextjournal.clerk.viewer/map-entry-viewer, :render-fn #clerk/render-fn+opts [{:render-evaluator :sci} (fn [xs opts] (into [:<>] (comp (nextjournal.clerk.render/inspect-children opts) (interpose " ")) xs))], :page-size 2, :hash "5dsRuzZximgoCTqHkts5WgKf7zc8xg"}} {:path [1 0 1 2 0 1 0 1 2], :nextjournal/value [{:path [1 0 1 2 0 1 0 1 2 0], :nextjournal/value :namespace, :nextjournal/viewer {:name nextjournal.clerk.viewer/keyword-viewer, :render-fn #clerk/render-fn+opts [{:render-evaluator :sci} (fn [x] [:span.cmt-atom.inspected-value (str x)])], :hash "5dsp5Uy2KDqwuALVVk33HXMZdpXGBq"}} {:path [1 0 1 2 0 1 0 1 2 1], :nextjournal/value "kube-system", :nextjournal/viewer {:name nextjournal.clerk.viewer/string-viewer, :render-fn #clerk/render-fn+opts [{:render-evaluator :sci} nextjournal.clerk.render/render-quoted-string], :opening-paren "\"", :closing-paren ("\"" "}"), :page-size 80, :hash "5dsDiKZaSjZpuyav79P69dRKiDtE2s"}}], :nextjournal/viewer {:name nextjournal.clerk.viewer/map-entry-viewer, :render-fn #clerk/render-fn+opts [{:render-evaluator :sci} (fn [xs opts] (into [:<>] (comp (nextjournal.clerk.render/inspect-children opts) (interpose " ")) xs))], :page-size 2, :hash "5dsRuzZximgoCTqHkts5WgKf7zc8xg"}}], :nextjournal/viewer {:name nextjournal.clerk.viewer/map-viewer, :render-fn #clerk/render-fn+opts [{:render-evaluator :sci} nextjournal.clerk.render/render-map], :opening-paren "{", :page-size 10, :hash "5drc3ac5ux7kS4h2vozdxwsrKDqSmn"}}], :nextjournal/viewer {:name nextjournal.clerk.viewer/map-entry-viewer, :render-fn #clerk/render-fn+opts [{:render-evaluator :sci} (fn [xs opts] (into [:<>] (comp (nextjournal.clerk.render/inspect-children opts) (interpose " ")) xs))], :page-size 2, :hash "5dsRuzZximgoCTqHkts5WgKf7zc8xg"}} {:path [1 0 1 2 0 1 1], :nextjournal/value [{:path [1 0 1 2 0 1 1 0], :nextjournal/value :stringData, :nextjournal/viewer {:name nextjournal.clerk.viewer/keyword-viewer, :render-fn #clerk/render-fn+opts [{:render-evaluator :sci} (fn [x] [:span.cmt-atom.inspected-value (str x)])], :hash "5dsp5Uy2KDqwuALVVk33HXMZdpXGBq"}} {:path [1 0 1 2 0 1 1 1], :nextjournal/value [{:path [1 0 1 2 0 1 1 1 0], :nextjournal/value [{:path [1 0 1 2 0 1 1 1 0 0], :nextjournal/value ".dockerconfigjson", :nextjournal/viewer {:name nextjournal.clerk.viewer/string-viewer, :render-fn #clerk/render-fn+opts [{:render-evaluator :sci} nextjournal.clerk.render/render-quoted-string], :opening-paren "\"", :closing-paren ("\""), :page-size 80, :hash "5dsDiKZaSjZpuyav79P69dRKiDtE2s"}} {:path [1 0 1 2 0 1 1 1 0 1], :nextjournal/value "{\"auths\":{\"host\":{\"auth\":\"Og==\"}}}", :nextjournal/viewer {:name nextjournal.clerk.viewer/string-viewer, :render-fn #clerk/render-fn+opts [{:render-evaluator :sci} nextjournal.clerk.render/render-quoted-string], :opening-paren "\"", :closing-paren ("\"" "}"), :page-size 80, :hash "5dsDiKZaSjZpuyav79P69dRKiDtE2s"}}], :nextjournal/viewer {:name nextjournal.clerk.viewer/map-entry-viewer, :render-fn #clerk/render-fn+opts [{:render-evaluator :sci} (fn [xs opts] (into [:<>] (comp (nextjournal.clerk.render/inspect-children opts) (interpose " ")) xs))], :page-size 2, :hash "5dsRuzZximgoCTqHkts5WgKf7zc8xg"}}], :nextjournal/viewer {:name nextjournal.clerk.viewer/map-viewer, :render-fn #clerk/render-fn+opts [{:render-evaluator :sci} nextjournal.clerk.render/render-map], :opening-paren "{", :page-size 10, :hash "5drc3ac5ux7kS4h2vozdxwsrKDqSmn"}}], :nextjournal/viewer {:name nextjournal.clerk.viewer/map-entry-viewer, :render-fn #clerk/render-fn+opts [{:render-evaluator :sci} (fn [xs opts] (into [:<>] (comp (nextjournal.clerk.render/inspect-children opts) (interpose " ")) xs))], :page-size 2, :hash "5dsRuzZximgoCTqHkts5WgKf7zc8xg"}} {:path [1 0 1 2 0 1 2], :nextjournal/value [{:path [1 0 1 2 0 1 2 0], :nextjournal/value :type, :nextjournal/viewer {:name nextjournal.clerk.viewer/keyword-viewer, :render-fn #clerk/render-fn+opts [{:render-evaluator :sci} (fn [x] [:span.cmt-atom.inspected-value (str x)])], :hash "5dsp5Uy2KDqwuALVVk33HXMZdpXGBq"}} {:path [1 0 1 2 0 1 2 1], :nextjournal/value "kubernetes.io/dockerconfigjson", :nextjournal/viewer {:name nextjournal.clerk.viewer/string-viewer, :render-fn #clerk/render-fn+opts [{:render-evaluator :sci} nextjournal.clerk.render/render-quoted-string], :opening-paren "\"", :closing-paren ("\"" "}"), :page-size 80, :hash "5dsDiKZaSjZpuyav79P69dRKiDtE2s"}}], :nextjournal/viewer {:name nextjournal.clerk.viewer/map-entry-viewer, :render-fn #clerk/render-fn+opts [{:render-evaluator :sci} (fn [xs opts] (into [:<>] (comp (nextjournal.clerk.render/inspect-children opts) (interpose " ")) xs))], :page-size 2, :hash "5dsRuzZximgoCTqHkts5WgKf7zc8xg"}}], :nextjournal/viewer {:name nextjournal.clerk.viewer/map-viewer, :render-fn #clerk/render-fn+opts [{:render-evaluator :sci} nextjournal.clerk.render/render-map], :opening-paren "{", :page-size 10, :hash "5drc3ac5ux7kS4h2vozdxwsrKDqSmn"}}], :nextjournal/viewer {:name nextjournal.clerk.viewer/map-entry-viewer, :render-fn #clerk/render-fn+opts [{:render-evaluator :sci} (fn [xs opts] (into [:<>] (comp (nextjournal.clerk.render/inspect-children opts) (interpose " ")) xs))], :page-size 2, :hash "5dsRuzZximgoCTqHkts5WgKf7zc8xg"}} {:path [1 0 1 2 1], :nextjournal/value [{:path [1 0 1 2 1 0], :nextjournal/value :pulumi-options, :nextjournal/viewer {:name nextjournal.clerk.viewer/keyword-viewer, :render-fn #clerk/render-fn+opts [{:render-evaluator :sci} (fn [x] [:span.cmt-atom.inspected-value (str x)])], :hash "5dsp5Uy2KDqwuALVVk33HXMZdpXGBq"}} {:path [1 0 1 2 1 1], :nextjournal/value [], :nextjournal/viewer {:name nextjournal.clerk.viewer/map-viewer, :render-fn #clerk/render-fn+opts [{:render-evaluator :sci} nextjournal.clerk.render/render-map], :opening-paren "{", :closing-paren ("}" "}" "]" "}"), :page-size 10, :hash "5drc3ac5ux7kS4h2vozdxwsrKDqSmn"}}], :nextjournal/viewer {:name nextjournal.clerk.viewer/map-entry-viewer, :render-fn #clerk/render-fn+opts [{:render-evaluator :sci} (fn [xs opts] (into [:<>] (comp (nextjournal.clerk.render/inspect-children opts) (interpose " ")) xs))], :page-size 2, :hash "5dsRuzZximgoCTqHkts5WgKf7zc8xg"}}], :nextjournal/viewer {:name nextjournal.clerk.viewer/map-viewer, :render-fn #clerk/render-fn+opts [{:render-evaluator :sci} nextjournal.clerk.render/render-map], :opening-paren "{", :page-size 10, :hash "5drc3ac5ux7kS4h2vozdxwsrKDqSmn"}}], :nextjournal/viewer {:name nextjournal.clerk.viewer/vector-viewer, :render-fn #clerk/render-fn+opts [{:render-evaluator :sci} nextjournal.clerk.render/render-coll], :opening-paren "[", :page-size 20, :hash "5dsD1KJESfc8Dy8gPeGQfZCX2ayE8f"}}], :nextjournal/viewer {:name nextjournal.clerk.viewer/map-entry-viewer, :render-fn #clerk/render-fn+opts [{:render-evaluator :sci} (fn [xs opts] (into [:<>] (comp (nextjournal.clerk.render/inspect-children opts) (interpose " ")) xs))], :page-size 2, :hash "5dsRuzZximgoCTqHkts5WgKf7zc8xg"}}], :nextjournal/viewer {:name nextjournal.clerk.viewer/map-viewer, :render-fn #clerk/render-fn+opts [{:render-evaluator :sci} nextjournal.clerk.render/render-map], :opening-paren "{", :page-size 10, :hash "5drc3ac5ux7kS4h2vozdxwsrKDqSmn"}, :nextjournal/render-opts {:id "config-processor/anon-expr-5dqwp6CwNWUW4wm9kPFddjtStSbwL2-result-1"}}, :nextjournal/blob-id "5du27LUsW7pNJmpx21BUMzHAidmDkA"}, :nextjournal/render-opts {:id "config-processor/anon-expr-5dqwp6CwNWUW4wm9kPFddjtStSbwL2-result-1"}, :nextjournal/viewer {:name nextjournal.clerk.viewer/result-viewer, :render-fn #clerk/render-fn+opts [{:render-evaluator :sci} nextjournal.clerk.render/render-result], :hash "5dtGVHesd2XCTLFYF3aY4kJvkrX1x1"}}], :nextjournal/viewer {:name nextjournal.clerk.viewer/cell-viewer, :render-fn #clerk/render-fn+opts [{:render-evaluator :sci} (fn [xs opts] (into [:<>] (nextjournal.clerk.render/inspect-children opts) xs))], :hash "5dtX6xLh3vbeFdswBY6jLXmB8QTqo2"}} {:path [], :nextjournal/value [:div.viewer.markdown-viewer.w-full.max-w-prose.px-8 {:data-block-id "config-processor/markdown-5dsXZQh4TD3sAeA79ECy4fhEdbB4p7"} [:p [:<> "However, what if we wanted to convert a value that is the result of an operation step."]]], :nextjournal/render-opts {:id "config-processor/markdown-5dsXZQh4TD3sAeA79ECy4fhEdbB4p7"}, :nextjournal/viewer {:name nextjournal.clerk.viewer/markdown-node-viewer, :render-fn #clerk/render-fn+opts [{:render-evaluator :sci} identity], :hash "5dsg4Bx9A9L7WvvCgamUoRtxUsmYCe"}} {:path [], :nextjournal/value [{:path [0], :nextjournal/value "(defn run-simulation [stack initial-values]\n  (let [final-state\n        (reduce (fn [{:keys [ctx results]} item]\n                  (let [resolved-item (proc/resolve-template item ctx)\n\n                        ;; In a real engine, we'd deploy here.\n                        ;; In simulation, we decide what \"outputs\" this step created.\n                        ;; We look at the definition to see if we need to mock a return value.\n                        resource-outputs\n                        (cond\n                          (and (vector? item) (= (first item) :harbor))\n                          {:fullName (pulumi/output \"robot$test\")\n                           :secret   (pulumi/output \"secret-123\")}\n                          :else {})\n\n                        ;; In your config, you used :harbor:robot-account\n                        new-key (if (and (vector? item) (= (first item) :harbor))\n                                  :harbor:robot-account\n                                  nil)]\n\n                    {:results (conj results resolved-item)\n                     :ctx     (if new-key\n                                (assoc ctx new-key resource-outputs)\n                                ctx)}))\n                ;; Initial State\n                {:ctx initial-values :results []}\n                stack)]\n\n    (:results final-state)))", :nextjournal/render-opts {:loc {:line 143, :end-line 172, :column 1, :end-column 29}, :id "config-processor/run-simulation-code"}, :nextjournal/viewer {:name nextjournal.clerk.viewer/code-block-viewer, :render-fn #clerk/render-fn+opts [{:render-evaluator :sci} nextjournal.clerk.render/render-code-block], :hash "5dru1FUcVRTRrVKJFbNw4FG2wXmiwB"}}], :nextjournal/viewer {:name nextjournal.clerk.viewer/cell-viewer, :render-fn #clerk/render-fn+opts [{:render-evaluator :sci} (fn [xs opts] (into [:<>] (nextjournal.clerk.render/inspect-children opts) xs))], :hash "5dtX6xLh3vbeFdswBY6jLXmB8QTqo2"}} {:path [], :nextjournal/value [:div.viewer.markdown-viewer.w-full.max-w-prose.px-8 {:data-block-id "config-processor/markdown-5dr9ZTKPiNTjHYHbZSpSiEibV93iTf"} [:p [:<> "and running that produces"]]], :nextjournal/render-opts {:id "config-processor/markdown-5dr9ZTKPiNTjHYHbZSpSiEibV93iTf"}, :nextjournal/viewer {:name nextjournal.clerk.viewer/markdown-node-viewer, :render-fn #clerk/render-fn+opts [{:render-evaluator :sci} identity], :hash "5dsg4Bx9A9L7WvvCgamUoRtxUsmYCe"}} {:path [], :nextjournal/value [{:path [0], :nextjournal/value "(run-simulation test-config {:app-name \"harbor\"})", :nextjournal/render-opts {:loc {:line 175, :end-line 177, :column 1, :end-column 50}, :id "config-processor/anon-expr-5dtyaMceyqit2yVKk59SFyMgxEDQZZ-code"}, :nextjournal/viewer {:name nextjournal.clerk.viewer/code-block-viewer, :render-fn #clerk/render-fn+opts [{:render-evaluator :sci} nextjournal.clerk.render/render-code-block], :hash "5dru1FUcVRTRrVKJFbNw4FG2wXmiwB"}} {:path [1], :nextjournal/value {:nextjournal/presented {:path [1], :nextjournal/value [{:path [1 0], :nextjournal/value [{:path [1 0 0], :nextjournal/value :stack, :nextjournal/viewer {:name nextjournal.clerk.viewer/keyword-viewer, :render-fn #clerk/render-fn+opts [{:render-evaluator :sci} (fn [x] [:span.cmt-atom.inspected-value (str x)])], :hash "5dsp5Uy2KDqwuALVVk33HXMZdpXGBq"}} {:path [1 0 1], :nextjournal/value [{:path [1 0 1 0], :nextjournal/value [{:path [1 0 1 0 0], :nextjournal/value [{:path [1 0 1 0 0 0], :nextjournal/value :pulumi-options, :nextjournal/viewer {:name nextjournal.clerk.viewer/keyword-viewer, :render-fn #clerk/render-fn+opts [{:render-evaluator :sci} (fn [x] [:span.cmt-atom.inspected-value (str x)])], :hash "5dsp5Uy2KDqwuALVVk33HXMZdpXGBq"}} {:path [1 0 1 0 0 1], :nextjournal/value [], :nextjournal/viewer {:name nextjournal.clerk.viewer/map-viewer, :render-fn #clerk/render-fn+opts [{:render-evaluator :sci} nextjournal.clerk.render/render-map], :opening-paren "{", :closing-paren ("}"), :page-size 10, :hash "5drc3ac5ux7kS4h2vozdxwsrKDqSmn"}}], :nextjournal/viewer {:name nextjournal.clerk.viewer/map-entry-viewer, :render-fn #clerk/render-fn+opts [{:render-evaluator :sci} (fn [xs opts] (into [:<>] (comp (nextjournal.clerk.render/inspect-children opts) (interpose " ")) xs))], :page-size 2, :hash "5dsRuzZximgoCTqHkts5WgKf7zc8xg"}} {:path [1 0 1 0 1], :nextjournal/value [{:path [1 0 1 0 1 0], :nextjournal/value :vault:retrieve, :nextjournal/viewer {:name nextjournal.clerk.viewer/keyword-viewer, :render-fn #clerk/render-fn+opts [{:render-evaluator :sci} (fn [x] [:span.cmt-atom.inspected-value (str x)])], :hash "5dsp5Uy2KDqwuALVVk33HXMZdpXGBq"}} {:path [1 0 1 0 1 1], :nextjournal/value [{:path [1 0 1 0 1 1 0], :nextjournal/value [{:path [1 0 1 0 1 1 0 0], :nextjournal/value :app-name, :nextjournal/viewer {:name nextjournal.clerk.viewer/keyword-viewer, :render-fn #clerk/render-fn+opts [{:render-evaluator :sci} (fn [x] [:span.cmt-atom.inspected-value (str x)])], :hash "5dsp5Uy2KDqwuALVVk33HXMZdpXGBq"}} {:path [1 0 1 0 1 1 0 1], :nextjournal/value "harbor", :nextjournal/viewer {:name nextjournal.clerk.viewer/string-viewer, :render-fn #clerk/render-fn+opts [{:render-evaluator :sci} nextjournal.clerk.render/render-quoted-string], :opening-paren "\"", :closing-paren ("\""), :page-size 80, :hash "5dsDiKZaSjZpuyav79P69dRKiDtE2s"}}], :nextjournal/viewer {:name nextjournal.clerk.viewer/map-entry-viewer, :render-fn #clerk/render-fn+opts [{:render-evaluator :sci} (fn [xs opts] (into [:<>] (comp (nextjournal.clerk.render/inspect-children opts) (interpose " ")) xs))], :page-size 2, :hash "5dsRuzZximgoCTqHkts5WgKf7zc8xg"}} {:path [1 0 1 0 1 1 1], :nextjournal/value [{:path [1 0 1 0 1 1 1 0], :nextjournal/value :app-namespace, :nextjournal/viewer {:name nextjournal.clerk.viewer/keyword-viewer, :render-fn #clerk/render-fn+opts [{:render-evaluator :sci} (fn [x] [:span.cmt-atom.inspected-value (str x)])], :hash "5dsp5Uy2KDqwuALVVk33HXMZdpXGBq"}} {:path [1 0 1 0 1 1 1 1], :nextjournal/value "harbor", :nextjournal/viewer {:name nextjournal.clerk.viewer/string-viewer, :render-fn #clerk/render-fn+opts [{:render-evaluator :sci} nextjournal.clerk.render/render-quoted-string], :opening-paren "\"", :closing-paren ("\"" "}" "}"), :page-size 80, :hash "5dsDiKZaSjZpuyav79P69dRKiDtE2s"}}], :nextjournal/viewer {:name nextjournal.clerk.viewer/map-entry-viewer, :render-fn #clerk/render-fn+opts [{:render-evaluator :sci} (fn [xs opts] (into [:<>] (comp (nextjournal.clerk.render/inspect-children opts) (interpose " ")) xs))], :page-size 2, :hash "5dsRuzZximgoCTqHkts5WgKf7zc8xg"}}], :nextjournal/viewer {:name nextjournal.clerk.viewer/map-viewer, :render-fn #clerk/render-fn+opts [{:render-evaluator :sci} nextjournal.clerk.render/render-map], :opening-paren "{", :page-size 10, :hash "5drc3ac5ux7kS4h2vozdxwsrKDqSmn"}}], :nextjournal/viewer {:name nextjournal.clerk.viewer/map-entry-viewer, :render-fn #clerk/render-fn+opts [{:render-evaluator :sci} (fn [xs opts] (into [:<>] (comp (nextjournal.clerk.render/inspect-children opts) (interpose " ")) xs))], :page-size 2, :hash "5dsRuzZximgoCTqHkts5WgKf7zc8xg"}}], :nextjournal/viewer {:name nextjournal.clerk.viewer/map-viewer, :render-fn #clerk/render-fn+opts [{:render-evaluator :sci} nextjournal.clerk.render/render-map], :opening-paren "{", :page-size 10, :hash "5drc3ac5ux7kS4h2vozdxwsrKDqSmn"}} {:path [1 0 1 1], :nextjournal/value [{:path [1 0 1 1 0], :nextjournal/value :harbor, :nextjournal/viewer {:name nextjournal.clerk.viewer/keyword-viewer, :render-fn #clerk/render-fn+opts [{:render-evaluator :sci} (fn [x] [:span.cmt-atom.inspected-value (str x)])], :hash "5dsp5Uy2KDqwuALVVk33HXMZdpXGBq"}} {:path [1 0 1 1 1], :nextjournal/value [{:path [1 0 1 1 1 0], :nextjournal/value [{:path [1 0 1 1 1 0 0], :nextjournal/value :project, :nextjournal/viewer {:name nextjournal.clerk.viewer/keyword-viewer, :render-fn #clerk/render-fn+opts [{:render-evaluator :sci} (fn [x] [:span.cmt-atom.inspected-value (str x)])], :hash "5dsp5Uy2KDqwuALVVk33HXMZdpXGBq"}} {:path [1 0 1 1 1 0 1], :nextjournal/value [], :nextjournal/viewer {:name nextjournal.clerk.viewer/map-viewer, :render-fn #clerk/render-fn+opts [{:render-evaluator :sci} nextjournal.clerk.render/render-map], :opening-paren "{", :closing-paren ("}"), :page-size 10, :hash "5drc3ac5ux7kS4h2vozdxwsrKDqSmn"}}], :nextjournal/viewer {:name nextjournal.clerk.viewer/map-entry-viewer, :render-fn #clerk/render-fn+opts [{:render-evaluator :sci} (fn [xs opts] (into [:<>] (comp (nextjournal.clerk.render/inspect-children opts) (interpose " ")) xs))], :page-size 2, :hash "5dsRuzZximgoCTqHkts5WgKf7zc8xg"}} {:path [1 0 1 1 1 1], :nextjournal/value [{:path [1 0 1 1 1 1 0], :nextjournal/value :pulumi-options, :nextjournal/viewer {:name nextjournal.clerk.viewer/keyword-viewer, :render-fn #clerk/render-fn+opts [{:render-evaluator :sci} (fn [x] [:span.cmt-atom.inspected-value (str x)])], :hash "5dsp5Uy2KDqwuALVVk33HXMZdpXGBq"}} {:path [1 0 1 1 1 1 1], :nextjournal/value [], :nextjournal/viewer {:name nextjournal.clerk.viewer/map-viewer, :render-fn #clerk/render-fn+opts [{:render-evaluator :sci} nextjournal.clerk.render/render-map], :opening-paren "{", :closing-paren ("}" "}"), :page-size 10, :hash "5drc3ac5ux7kS4h2vozdxwsrKDqSmn"}}], :nextjournal/viewer {:name nextjournal.clerk.viewer/map-entry-viewer, :render-fn #clerk/render-fn+opts [{:render-evaluator :sci} (fn [xs opts] (into [:<>] (comp (nextjournal.clerk.render/inspect-children opts) (interpose " ")) xs))], :page-size 2, :hash "5dsRuzZximgoCTqHkts5WgKf7zc8xg"}}], :nextjournal/viewer {:name nextjournal.clerk.viewer/map-viewer, :render-fn #clerk/render-fn+opts [{:render-evaluator :sci} nextjournal.clerk.render/render-map], :opening-paren "{", :page-size 10, :hash "5drc3ac5ux7kS4h2vozdxwsrKDqSmn"}} {:path [1 0 1 1 2], :nextjournal/value [{:path [1 0 1 1 2 0], :nextjournal/value [{:path [1 0 1 1 2 0 0], :nextjournal/value :pulumi-options, :nextjournal/viewer {:name nextjournal.clerk.viewer/keyword-viewer, :render-fn #clerk/render-fn+opts [{:render-evaluator :sci} (fn [x] [:span.cmt-atom.inspected-value (str x)])], :hash "5dsp5Uy2KDqwuALVVk33HXMZdpXGBq"}} {:path [1 0 1 1 2 0 1], :nextjournal/value [], :nextjournal/viewer {:name nextjournal.clerk.viewer/map-viewer, :render-fn #clerk/render-fn+opts [{:render-evaluator :sci} nextjournal.clerk.render/render-map], :opening-paren "{", :closing-paren ("}"), :page-size 10, :hash "5drc3ac5ux7kS4h2vozdxwsrKDqSmn"}}], :nextjournal/viewer {:name nextjournal.clerk.viewer/map-entry-viewer, :render-fn #clerk/render-fn+opts [{:render-evaluator :sci} (fn [xs opts] (into [:<>] (comp (nextjournal.clerk.render/inspect-children opts) (interpose " ")) xs))], :page-size 2, :hash "5dsRuzZximgoCTqHkts5WgKf7zc8xg"}} {:path [1 0 1 1 2 1], :nextjournal/value [{:path [1 0 1 1 2 1 0], :nextjournal/value :robot-account, :nextjournal/viewer {:name nextjournal.clerk.viewer/keyword-viewer, :render-fn #clerk/render-fn+opts [{:render-evaluator :sci} (fn [x] [:span.cmt-atom.inspected-value (str x)])], :hash "5dsp5Uy2KDqwuALVVk33HXMZdpXGBq"}} {:path [1 0 1 1 2 1 1], :nextjournal/value [{:path [1 0 1 1 2 1 1 0], :nextjournal/value [{:path [1 0 1 1 2 1 1 0 0], :nextjournal/value :level, :nextjournal/viewer {:name nextjournal.clerk.viewer/keyword-viewer, :render-fn #clerk/render-fn+opts [{:render-evaluator :sci} (fn [x] [:span.cmt-atom.inspected-value (str x)])], :hash "5dsp5Uy2KDqwuALVVk33HXMZdpXGBq"}} {:path [1 0 1 1 2 1 1 0 1], :nextjournal/value "project", :nextjournal/viewer {:name nextjournal.clerk.viewer/string-viewer, :render-fn #clerk/render-fn+opts [{:render-evaluator :sci} nextjournal.clerk.render/render-quoted-string], :opening-paren "\"", :closing-paren ("\""), :page-size 80, :hash "5dsDiKZaSjZpuyav79P69dRKiDtE2s"}}], :nextjournal/viewer {:name nextjournal.clerk.viewer/map-entry-viewer, :render-fn #clerk/render-fn+opts [{:render-evaluator :sci} (fn [xs opts] (into [:<>] (comp (nextjournal.clerk.render/inspect-children opts) (interpose " ")) xs))], :page-size 2, :hash "5dsRuzZximgoCTqHkts5WgKf7zc8xg"}} {:path [1 0 1 1 2 1 1 1], :nextjournal/value [{:path [1 0 1 1 2 1 1 1 0], :nextjournal/value :name, :nextjournal/viewer {:name nextjournal.clerk.viewer/keyword-viewer, :render-fn #clerk/render-fn+opts [{:render-evaluator :sci} (fn [x] [:span.cmt-atom.inspected-value (str x)])], :hash "5dsp5Uy2KDqwuALVVk33HXMZdpXGBq"}} {:path [1 0 1 1 2 1 1 1 1], :nextjournal/value "kube-harbor-robot", :nextjournal/viewer {:name nextjournal.clerk.viewer/string-viewer, :render-fn #clerk/render-fn+opts [{:render-evaluator :sci} nextjournal.clerk.render/render-quoted-string], :opening-paren "\"", :closing-paren ("\""), :page-size 80, :hash "5dsDiKZaSjZpuyav79P69dRKiDtE2s"}}], :nextjournal/viewer {:name nextjournal.clerk.viewer/map-entry-viewer, :render-fn #clerk/render-fn+opts [{:render-evaluator :sci} (fn [xs opts] (into [:<>] (comp (nextjournal.clerk.render/inspect-children opts) (interpose " ")) xs))], :page-size 2, :hash "5dsRuzZximgoCTqHkts5WgKf7zc8xg"}} {:path [1 0 1 1 2 1 1 2], :nextjournal/value [{:path [1 0 1 1 2 1 1 2 0], :nextjournal/value :namespace, :nextjournal/viewer {:name nextjournal.clerk.viewer/keyword-viewer, :render-fn #clerk/render-fn+opts [{:render-evaluator :sci} (fn [x] [:span.cmt-atom.inspected-value (str x)])], :hash "5dsp5Uy2KDqwuALVVk33HXMZdpXGBq"}} {:path [1 0 1 1 2 1 1 2 1], :nextjournal/value "harbor", :nextjournal/viewer {:name nextjournal.clerk.viewer/string-viewer, :render-fn #clerk/render-fn+opts [{:render-evaluator :sci} nextjournal.clerk.render/render-quoted-string], :opening-paren "\"", :closing-paren ("\""), :page-size 80, :hash "5dsDiKZaSjZpuyav79P69dRKiDtE2s"}}], :nextjournal/viewer {:name nextjournal.clerk.viewer/map-entry-viewer, :render-fn #clerk/render-fn+opts [{:render-evaluator :sci} (fn [xs opts] (into [:<>] (comp (nextjournal.clerk.render/inspect-children opts) (interpose " ")) xs))], :page-size 2, :hash "5dsRuzZximgoCTqHkts5WgKf7zc8xg"}} {:path [1 0 1 1 2 1 1 3], :nextjournal/value [{:path [1 0 1 1 2 1 1 3 0], :nextjournal/value :permissions, :nextjournal/viewer {:name nextjournal.clerk.viewer/keyword-viewer, :render-fn #clerk/render-fn+opts [{:render-evaluator :sci} (fn [x] [:span.cmt-atom.inspected-value (str x)])], :hash "5dsp5Uy2KDqwuALVVk33HXMZdpXGBq"}} {:path [1 0 1 1 2 1 1 3 1], :nextjournal/value [{:path [1 0 1 1 2 1 1 3 1 0], :nextjournal/value [{:path [1 0 1 1 2 1 1 3 1 0 0], :nextjournal/value [{:path [1 0 1 1 2 1 1 3 1 0 0 0], :nextjournal/value :access, :nextjournal/viewer {:name nextjournal.clerk.viewer/keyword-viewer, :render-fn #clerk/render-fn+opts [{:render-evaluator :sci} (fn [x] [:span.cmt-atom.inspected-value (str x)])], :hash "5dsp5Uy2KDqwuALVVk33HXMZdpXGBq"}} {:path [1 0 1 1 2 1 1 3 1 0 0 1], :nextjournal/value [{:path [1 0 1 1 2 1 1 3 1 0 0 1 0], :nextjournal/value [{:path [1 0 1 1 2 1 1 3 1 0 0 1 0 0], :nextjournal/value [{:path [1 0 1 1 2 1 1 3 1 0 0 1 0 0 0], :nextjournal/value :action, :nextjournal/viewer {:name nextjournal.clerk.viewer/keyword-viewer, :render-fn #clerk/render-fn+opts [{:render-evaluator :sci} (fn [x] [:span.cmt-atom.inspected-value (str x)])], :hash "5dsp5Uy2KDqwuALVVk33HXMZdpXGBq"}} {:path [1 0 1 1 2 1 1 3 1 0 0 1 0 0 1], :nextjournal/value "pull", :nextjournal/viewer {:name nextjournal.clerk.viewer/string-viewer, :render-fn #clerk/render-fn+opts [{:render-evaluator :sci} nextjournal.clerk.render/render-quoted-string], :opening-paren "\"", :closing-paren ("\""), :page-size 80, :hash "5dsDiKZaSjZpuyav79P69dRKiDtE2s"}}], :nextjournal/viewer {:name nextjournal.clerk.viewer/map-entry-viewer, :render-fn #clerk/render-fn+opts [{:render-evaluator :sci} (fn [xs opts] (into [:<>] (comp (nextjournal.clerk.render/inspect-children opts) (interpose " ")) xs))], :page-size 2, :hash "5dsRuzZximgoCTqHkts5WgKf7zc8xg"}} {:path [1 0 1 1 2 1 1 3 1 0 0 1 0 1], :nextjournal/value [{:path [1 0 1 1 2 1 1 3 1 0 0 1 0 1 0], :nextjournal/value :resource, :nextjournal/viewer {:name nextjournal.clerk.viewer/keyword-viewer, :render-fn #clerk/render-fn+opts [{:render-evaluator :sci} (fn [x] [:span.cmt-atom.inspected-value (str x)])], :hash "5dsp5Uy2KDqwuALVVk33HXMZdpXGBq"}} {:path [1 0 1 1 2 1 1 3 1 0 0 1 0 1 1], :nextjournal/value "repository", :nextjournal/viewer {:name nextjournal.clerk.viewer/string-viewer, :render-fn #clerk/render-fn+opts [{:render-evaluator :sci} nextjournal.clerk.render/render-quoted-string], :opening-paren "\"", :closing-paren ("\"" "}"), :page-size 80, :hash "5dsDiKZaSjZpuyav79P69dRKiDtE2s"}}], :nextjournal/viewer {:name nextjournal.clerk.viewer/map-entry-viewer, :render-fn #clerk/render-fn+opts [{:render-evaluator :sci} (fn [xs opts] (into [:<>] (comp (nextjournal.clerk.render/inspect-children opts) (interpose " ")) xs))], :page-size 2, :hash "5dsRuzZximgoCTqHkts5WgKf7zc8xg"}}], :nextjournal/viewer {:name nextjournal.clerk.viewer/map-viewer, :render-fn #clerk/render-fn+opts [{:render-evaluator :sci} nextjournal.clerk.render/render-map], :opening-paren "{", :page-size 10, :hash "5drc3ac5ux7kS4h2vozdxwsrKDqSmn"}} {:path [1 0 1 1 2 1 1 3 1 0 0 1 1], :nextjournal/value [{:path [1 0 1 1 2 1 1 3 1 0 0 1 1 0], :nextjournal/value [{:path [1 0 1 1 2 1 1 3 1 0 0 1 1 0 0], :nextjournal/value :action, :nextjournal/viewer {:name nextjournal.clerk.viewer/keyword-viewer, :render-fn #clerk/render-fn+opts [{:render-evaluator :sci} (fn [x] [:span.cmt-atom.inspected-value (str x)])], :hash "5dsp5Uy2KDqwuALVVk33HXMZdpXGBq"}} {:path [1 0 1 1 2 1 1 3 1 0 0 1 1 0 1], :nextjournal/value "list", :nextjournal/viewer {:name nextjournal.clerk.viewer/string-viewer, :render-fn #clerk/render-fn+opts [{:render-evaluator :sci} nextjournal.clerk.render/render-quoted-string], :opening-paren "\"", :closing-paren ("\""), :page-size 80, :hash "5dsDiKZaSjZpuyav79P69dRKiDtE2s"}}], :nextjournal/viewer {:name nextjournal.clerk.viewer/map-entry-viewer, :render-fn #clerk/render-fn+opts [{:render-evaluator :sci} (fn [xs opts] (into [:<>] (comp (nextjournal.clerk.render/inspect-children opts) (interpose " ")) xs))], :page-size 2, :hash "5dsRuzZximgoCTqHkts5WgKf7zc8xg"}} {:path [1 0 1 1 2 1 1 3 1 0 0 1 1 1], :nextjournal/value [{:path [1 0 1 1 2 1 1 3 1 0 0 1 1 1 0], :nextjournal/value :resource, :nextjournal/viewer {:name nextjournal.clerk.viewer/keyword-viewer, :render-fn #clerk/render-fn+opts [{:render-evaluator :sci} (fn [x] [:span.cmt-atom.inspected-value (str x)])], :hash "5dsp5Uy2KDqwuALVVk33HXMZdpXGBq"}} {:path [1 0 1 1 2 1 1 3 1 0 0 1 1 1 1], :nextjournal/value "repository", :nextjournal/viewer {:name nextjournal.clerk.viewer/string-viewer, :render-fn #clerk/render-fn+opts [{:render-evaluator :sci} nextjournal.clerk.render/render-quoted-string], :opening-paren "\"", :closing-paren ("\"" "}" "]"), :page-size 80, :hash "5dsDiKZaSjZpuyav79P69dRKiDtE2s"}}], :nextjournal/viewer {:name nextjournal.clerk.viewer/map-entry-viewer, :render-fn #clerk/render-fn+opts [{:render-evaluator :sci} (fn [xs opts] (into [:<>] (comp (nextjournal.clerk.render/inspect-children opts) (interpose " ")) xs))], :page-size 2, :hash "5dsRuzZximgoCTqHkts5WgKf7zc8xg"}}], :nextjournal/viewer {:name nextjournal.clerk.viewer/map-viewer, :render-fn #clerk/render-fn+opts [{:render-evaluator :sci} nextjournal.clerk.render/render-map], :opening-paren "{", :page-size 10, :hash "5drc3ac5ux7kS4h2vozdxwsrKDqSmn"}}], :nextjournal/viewer {:name nextjournal.clerk.viewer/vector-viewer, :render-fn #clerk/render-fn+opts [{:render-evaluator :sci} nextjournal.clerk.render/render-coll], :opening-paren "[", :page-size 20, :hash "5dsD1KJESfc8Dy8gPeGQfZCX2ayE8f"}}], :nextjournal/viewer {:name nextjournal.clerk.viewer/map-entry-viewer, :render-fn #clerk/render-fn+opts [{:render-evaluator :sci} (fn [xs opts] (into [:<>] (comp (nextjournal.clerk.render/inspect-children opts) (interpose " ")) xs))], :page-size 2, :hash "5dsRuzZximgoCTqHkts5WgKf7zc8xg"}} {:path [1 0 1 1 2 1 1 3 1 0 1], :nextjournal/value [{:path [1 0 1 1 2 1 1 3 1 0 1 0], :nextjournal/value :kind, :nextjournal/viewer {:name nextjournal.clerk.viewer/keyword-viewer, :render-fn #clerk/render-fn+opts [{:render-evaluator :sci} (fn [x] [:span.cmt-atom.inspected-value (str x)])], :hash "5dsp5Uy2KDqwuALVVk33HXMZdpXGBq"}} {:path [1 0 1 1 2 1 1 3 1 0 1 1], :nextjournal/value "project", :nextjournal/viewer {:name nextjournal.clerk.viewer/string-viewer, :render-fn #clerk/render-fn+opts [{:render-evaluator :sci} nextjournal.clerk.render/render-quoted-string], :opening-paren "\"", :closing-paren ("\""), :page-size 80, :hash "5dsDiKZaSjZpuyav79P69dRKiDtE2s"}}], :nextjournal/viewer {:name nextjournal.clerk.viewer/map-entry-viewer, :render-fn #clerk/render-fn+opts [{:render-evaluator :sci} (fn [xs opts] (into [:<>] (comp (nextjournal.clerk.render/inspect-children opts) (interpose " ")) xs))], :page-size 2, :hash "5dsRuzZximgoCTqHkts5WgKf7zc8xg"}} {:path [1 0 1 1 2 1 1 3 1 0 2], :nextjournal/value [{:path [1 0 1 1 2 1 1 3 1 0 2 0], :nextjournal/value :namespace, :nextjournal/viewer {:name nextjournal.clerk.viewer/keyword-viewer, :render-fn #clerk/render-fn+opts [{:render-evaluator :sci} (fn [x] [:span.cmt-atom.inspected-value (str x)])], :hash "5dsp5Uy2KDqwuALVVk33HXMZdpXGBq"}} {:path [1 0 1 1 2 1 1 3 1 0 2 1], :nextjournal/value "harbor", :nextjournal/viewer {:name nextjournal.clerk.viewer/string-viewer, :render-fn #clerk/render-fn+opts [{:render-evaluator :sci} nextjournal.clerk.render/render-quoted-string], :opening-paren "\"", :closing-paren ("\"" "}" "]" "}" "}" "]"), :page-size 80, :hash "5dsDiKZaSjZpuyav79P69dRKiDtE2s"}}], :nextjournal/viewer {:name nextjournal.clerk.viewer/map-entry-viewer, :render-fn #clerk/render-fn+opts [{:render-evaluator :sci} (fn [xs opts] (into [:<>] (comp (nextjournal.clerk.render/inspect-children opts) (interpose " ")) xs))], :page-size 2, :hash "5dsRuzZximgoCTqHkts5WgKf7zc8xg"}}], :nextjournal/viewer {:name nextjournal.clerk.viewer/map-viewer, :render-fn #clerk/render-fn+opts [{:render-evaluator :sci} nextjournal.clerk.render/render-map], :opening-paren "{", :page-size 10, :hash "5drc3ac5ux7kS4h2vozdxwsrKDqSmn"}}], :nextjournal/viewer {:name nextjournal.clerk.viewer/vector-viewer, :render-fn #clerk/render-fn+opts [{:render-evaluator :sci} nextjournal.clerk.render/render-coll], :opening-paren "[", :page-size 20, :hash "5dsD1KJESfc8Dy8gPeGQfZCX2ayE8f"}}], :nextjournal/viewer {:name nextjournal.clerk.viewer/map-entry-viewer, :render-fn #clerk/render-fn+opts [{:render-evaluator :sci} (fn [xs opts] (into [:<>] (comp (nextjournal.clerk.render/inspect-children opts) (interpose " ")) xs))], :page-size 2, :hash "5dsRuzZximgoCTqHkts5WgKf7zc8xg"}}], :nextjournal/viewer {:name nextjournal.clerk.viewer/map-viewer, :render-fn #clerk/render-fn+opts [{:render-evaluator :sci} nextjournal.clerk.render/render-map], :opening-paren "{", :page-size 10, :hash "5drc3ac5ux7kS4h2vozdxwsrKDqSmn"}}], :nextjournal/viewer {:name nextjournal.clerk.viewer/map-entry-viewer, :render-fn #clerk/render-fn+opts [{:render-evaluator :sci} (fn [xs opts] (into [:<>] (comp (nextjournal.clerk.render/inspect-children opts) (interpose " ")) xs))], :page-size 2, :hash "5dsRuzZximgoCTqHkts5WgKf7zc8xg"}}], :nextjournal/viewer {:name nextjournal.clerk.viewer/map-viewer, :render-fn #clerk/render-fn+opts [{:render-evaluator :sci} nextjournal.clerk.render/render-map], :opening-paren "{", :page-size 10, :hash "5drc3ac5ux7kS4h2vozdxwsrKDqSmn"}}], :nextjournal/viewer {:name nextjournal.clerk.viewer/vector-viewer, :render-fn #clerk/render-fn+opts [{:render-evaluator :sci} nextjournal.clerk.render/render-coll], :opening-paren "[", :page-size 20, :hash "5dsD1KJESfc8Dy8gPeGQfZCX2ayE8f"}} {:path [1 0 1 2], :nextjournal/value [{:path [1 0 1 2 0], :nextjournal/value [{:path [1 0 1 2 0 0], :nextjournal/value :k8s:secret, :nextjournal/viewer {:name nextjournal.clerk.viewer/keyword-viewer, :render-fn #clerk/render-fn+opts [{:render-evaluator :sci} (fn [x] [:span.cmt-atom.inspected-value (str x)])], :hash "5dsp5Uy2KDqwuALVVk33HXMZdpXGBq"}} {:path [1 0 1 2 0 1], :nextjournal/value [{:path [1 0 1 2 0 1 0], :nextjournal/value [{:path [1 0 1 2 0 1 0 0], :nextjournal/value :metadata, :nextjournal/viewer {:name nextjournal.clerk.viewer/keyword-viewer, :render-fn #clerk/render-fn+opts [{:render-evaluator :sci} (fn [x] [:span.cmt-atom.inspected-value (str x)])], :hash "5dsp5Uy2KDqwuALVVk33HXMZdpXGBq"}} {:path [1 0 1 2 0 1 0 1], :nextjournal/value [{:path [1 0 1 2 0 1 0 1 0], :nextjournal/value [{:path [1 0 1 2 0 1 0 1 0 0], :nextjournal/value :annotations, :nextjournal/viewer {:name nextjournal.clerk.viewer/keyword-viewer, :render-fn #clerk/render-fn+opts [{:render-evaluator :sci} (fn [x] [:span.cmt-atom.inspected-value (str x)])], :hash "5dsp5Uy2KDqwuALVVk33HXMZdpXGBq"}} {:path [1 0 1 2 0 1 0 1 0 1], :nextjournal/value [{:path [1 0 1 2 0 1 0 1 0 1 0], :nextjournal/value [{:path [1 0 1 2 0 1 0 1 0 1 0 0], :nextjournal/value "replicator.v1.mittwald.de/replicate-to", :nextjournal/viewer {:name nextjournal.clerk.viewer/string-viewer, :render-fn #clerk/render-fn+opts [{:render-evaluator :sci} nextjournal.clerk.render/render-quoted-string], :opening-paren "\"", :closing-paren ("\""), :page-size 80, :hash "5dsDiKZaSjZpuyav79P69dRKiDtE2s"}} {:path [1 0 1 2 0 1 0 1 0 1 0 1], :nextjournal/value "*", :nextjournal/viewer {:name nextjournal.clerk.viewer/string-viewer, :render-fn #clerk/render-fn+opts [{:render-evaluator :sci} nextjournal.clerk.render/render-quoted-string], :opening-paren "\"", :closing-paren ("\"" "}"), :page-size 80, :hash "5dsDiKZaSjZpuyav79P69dRKiDtE2s"}}], :nextjournal/viewer {:name nextjournal.clerk.viewer/map-entry-viewer, :render-fn #clerk/render-fn+opts [{:render-evaluator :sci} (fn [xs opts] (into [:<>] (comp (nextjournal.clerk.render/inspect-children opts) (interpose " ")) xs))], :page-size 2, :hash "5dsRuzZximgoCTqHkts5WgKf7zc8xg"}}], :nextjournal/viewer {:name nextjournal.clerk.viewer/map-viewer, :render-fn #clerk/render-fn+opts [{:render-evaluator :sci} nextjournal.clerk.render/render-map], :opening-paren "{", :page-size 10, :hash "5drc3ac5ux7kS4h2vozdxwsrKDqSmn"}}], :nextjournal/viewer {:name nextjournal.clerk.viewer/map-entry-viewer, :render-fn #clerk/render-fn+opts [{:render-evaluator :sci} (fn [xs opts] (into [:<>] (comp (nextjournal.clerk.render/inspect-children opts) (interpose " ")) xs))], :page-size 2, :hash "5dsRuzZximgoCTqHkts5WgKf7zc8xg"}} {:path [1 0 1 2 0 1 0 1 1], :nextjournal/value [{:path [1 0 1 2 0 1 0 1 1 0], :nextjournal/value :name, :nextjournal/viewer {:name nextjournal.clerk.viewer/keyword-viewer, :render-fn #clerk/render-fn+opts [{:render-evaluator :sci} (fn [x] [:span.cmt-atom.inspected-value (str x)])], :hash "5dsp5Uy2KDqwuALVVk33HXMZdpXGBq"}} {:path [1 0 1 2 0 1 0 1 1 1], :nextjournal/value "harbor-creds-secrets", :nextjournal/viewer {:name nextjournal.clerk.viewer/string-viewer, :render-fn #clerk/render-fn+opts [{:render-evaluator :sci} nextjournal.clerk.render/render-quoted-string], :opening-paren "\"", :closing-paren ("\""), :page-size 80, :hash "5dsDiKZaSjZpuyav79P69dRKiDtE2s"}}], :nextjournal/viewer {:name nextjournal.clerk.viewer/map-entry-viewer, :render-fn #clerk/render-fn+opts [{:render-evaluator :sci} (fn [xs opts] (into [:<>] (comp (nextjournal.clerk.render/inspect-children opts) (interpose " ")) xs))], :page-size 2, :hash "5dsRuzZximgoCTqHkts5WgKf7zc8xg"}} {:path [1 0 1 2 0 1 0 1 2], :nextjournal/value [{:path [1 0 1 2 0 1 0 1 2 0], :nextjournal/value :namespace, :nextjournal/viewer {:name nextjournal.clerk.viewer/keyword-viewer, :render-fn #clerk/render-fn+opts [{:render-evaluator :sci} (fn [x] [:span.cmt-atom.inspected-value (str x)])], :hash "5dsp5Uy2KDqwuALVVk33HXMZdpXGBq"}} {:path [1 0 1 2 0 1 0 1 2 1], :nextjournal/value "kube-system", :nextjournal/viewer {:name nextjournal.clerk.viewer/string-viewer, :render-fn #clerk/render-fn+opts [{:render-evaluator :sci} nextjournal.clerk.render/render-quoted-string], :opening-paren "\"", :closing-paren ("\"" "}"), :page-size 80, :hash "5dsDiKZaSjZpuyav79P69dRKiDtE2s"}}], :nextjournal/viewer {:name nextjournal.clerk.viewer/map-entry-viewer, :render-fn #clerk/render-fn+opts [{:render-evaluator :sci} (fn [xs opts] (into [:<>] (comp (nextjournal.clerk.render/inspect-children opts) (interpose " ")) xs))], :page-size 2, :hash "5dsRuzZximgoCTqHkts5WgKf7zc8xg"}}], :nextjournal/viewer {:name nextjournal.clerk.viewer/map-viewer, :render-fn #clerk/render-fn+opts [{:render-evaluator :sci} nextjournal.clerk.render/render-map], :opening-paren "{", :page-size 10, :hash "5drc3ac5ux7kS4h2vozdxwsrKDqSmn"}}], :nextjournal/viewer {:name nextjournal.clerk.viewer/map-entry-viewer, :render-fn #clerk/render-fn+opts [{:render-evaluator :sci} (fn [xs opts] (into [:<>] (comp (nextjournal.clerk.render/inspect-children opts) (interpose " ")) xs))], :page-size 2, :hash "5dsRuzZximgoCTqHkts5WgKf7zc8xg"}} {:path [1 0 1 2 0 1 1], :nextjournal/value [{:path [1 0 1 2 0 1 1 0], :nextjournal/value :stringData, :nextjournal/viewer {:name nextjournal.clerk.viewer/keyword-viewer, :render-fn #clerk/render-fn+opts [{:render-evaluator :sci} (fn [x] [:span.cmt-atom.inspected-value (str x)])], :hash "5dsp5Uy2KDqwuALVVk33HXMZdpXGBq"}} {:path [1 0 1 2 0 1 1 1], :nextjournal/value [{:path [1 0 1 2 0 1 1 1 0], :nextjournal/value [{:path [1 0 1 2 0 1 1 1 0 0], :nextjournal/value ".dockerconfigjson", :nextjournal/viewer {:name nextjournal.clerk.viewer/string-viewer, :render-fn #clerk/render-fn+opts [{:render-evaluator :sci} nextjournal.clerk.render/render-quoted-string], :opening-paren "\"", :closing-paren ("\""), :page-size 80, :hash "5dsDiKZaSjZpuyav79P69dRKiDtE2s"}} {:path [1 0 1 2 0 1 1 1 0 1], :nextjournal/value "{\"auths\":{\"host\":{\"auth\":\"Og==\"}}}", :nextjournal/viewer {:name nextjournal.clerk.viewer/string-viewer, :render-fn #clerk/render-fn+opts [{:render-evaluator :sci} nextjournal.clerk.render/render-quoted-string], :opening-paren "\"", :closing-paren ("\"" "}"), :page-size 80, :hash "5dsDiKZaSjZpuyav79P69dRKiDtE2s"}}], :nextjournal/viewer {:name nextjournal.clerk.viewer/map-entry-viewer, :render-fn #clerk/render-fn+opts [{:render-evaluator :sci} (fn [xs opts] (into [:<>] (comp (nextjournal.clerk.render/inspect-children opts) (interpose " ")) xs))], :page-size 2, :hash "5dsRuzZximgoCTqHkts5WgKf7zc8xg"}}], :nextjournal/viewer {:name nextjournal.clerk.viewer/map-viewer, :render-fn #clerk/render-fn+opts [{:render-evaluator :sci} nextjournal.clerk.render/render-map], :opening-paren "{", :page-size 10, :hash "5drc3ac5ux7kS4h2vozdxwsrKDqSmn"}}], :nextjournal/viewer {:name nextjournal.clerk.viewer/map-entry-viewer, :render-fn #clerk/render-fn+opts [{:render-evaluator :sci} (fn [xs opts] (into [:<>] (comp (nextjournal.clerk.render/inspect-children opts) (interpose " ")) xs))], :page-size 2, :hash "5dsRuzZximgoCTqHkts5WgKf7zc8xg"}} {:path [1 0 1 2 0 1 2], :nextjournal/value [{:path [1 0 1 2 0 1 2 0], :nextjournal/value :type, :nextjournal/viewer {:name nextjournal.clerk.viewer/keyword-viewer, :render-fn #clerk/render-fn+opts [{:render-evaluator :sci} (fn [x] [:span.cmt-atom.inspected-value (str x)])], :hash "5dsp5Uy2KDqwuALVVk33HXMZdpXGBq"}} {:path [1 0 1 2 0 1 2 1], :nextjournal/value "kubernetes.io/dockerconfigjson", :nextjournal/viewer {:name nextjournal.clerk.viewer/string-viewer, :render-fn #clerk/render-fn+opts [{:render-evaluator :sci} nextjournal.clerk.render/render-quoted-string], :opening-paren "\"", :closing-paren ("\"" "}"), :page-size 80, :hash "5dsDiKZaSjZpuyav79P69dRKiDtE2s"}}], :nextjournal/viewer {:name nextjournal.clerk.viewer/map-entry-viewer, :render-fn #clerk/render-fn+opts [{:render-evaluator :sci} (fn [xs opts] (into [:<>] (comp (nextjournal.clerk.render/inspect-children opts) (interpose " ")) xs))], :page-size 2, :hash "5dsRuzZximgoCTqHkts5WgKf7zc8xg"}}], :nextjournal/viewer {:name nextjournal.clerk.viewer/map-viewer, :render-fn #clerk/render-fn+opts [{:render-evaluator :sci} nextjournal.clerk.render/render-map], :opening-paren "{", :page-size 10, :hash "5drc3ac5ux7kS4h2vozdxwsrKDqSmn"}}], :nextjournal/viewer {:name nextjournal.clerk.viewer/map-entry-viewer, :render-fn #clerk/render-fn+opts [{:render-evaluator :sci} (fn [xs opts] (into [:<>] (comp (nextjournal.clerk.render/inspect-children opts) (interpose " ")) xs))], :page-size 2, :hash "5dsRuzZximgoCTqHkts5WgKf7zc8xg"}} {:path [1 0 1 2 1], :nextjournal/value [{:path [1 0 1 2 1 0], :nextjournal/value :pulumi-options, :nextjournal/viewer {:name nextjournal.clerk.viewer/keyword-viewer, :render-fn #clerk/render-fn+opts [{:render-evaluator :sci} (fn [x] [:span.cmt-atom.inspected-value (str x)])], :hash "5dsp5Uy2KDqwuALVVk33HXMZdpXGBq"}} {:path [1 0 1 2 1 1], :nextjournal/value [], :nextjournal/viewer {:name nextjournal.clerk.viewer/map-viewer, :render-fn #clerk/render-fn+opts [{:render-evaluator :sci} nextjournal.clerk.render/render-map], :opening-paren "{", :closing-paren ("}" "}" "]" "]"), :page-size 10, :hash "5drc3ac5ux7kS4h2vozdxwsrKDqSmn"}}], :nextjournal/viewer {:name nextjournal.clerk.viewer/map-entry-viewer, :render-fn #clerk/render-fn+opts [{:render-evaluator :sci} (fn [xs opts] (into [:<>] (comp (nextjournal.clerk.render/inspect-children opts) (interpose " ")) xs))], :page-size 2, :hash "5dsRuzZximgoCTqHkts5WgKf7zc8xg"}}], :nextjournal/viewer {:name nextjournal.clerk.viewer/map-viewer, :render-fn #clerk/render-fn+opts [{:render-evaluator :sci} nextjournal.clerk.render/render-map], :opening-paren "{", :page-size 10, :hash "5drc3ac5ux7kS4h2vozdxwsrKDqSmn"}}], :nextjournal/viewer {:name nextjournal.clerk.viewer/vector-viewer, :render-fn #clerk/render-fn+opts [{:render-evaluator :sci} nextjournal.clerk.render/render-coll], :opening-paren "[", :page-size 20, :hash "5dsD1KJESfc8Dy8gPeGQfZCX2ayE8f"}}], :nextjournal/viewer {:name nextjournal.clerk.viewer/map-entry-viewer, :render-fn #clerk/render-fn+opts [{:render-evaluator :sci} (fn [xs opts] (into [:<>] (comp (nextjournal.clerk.render/inspect-children opts) (interpose " ")) xs))], :page-size 2, :hash "5dsRuzZximgoCTqHkts5WgKf7zc8xg"}}], :nextjournal/viewer {:name nextjournal.clerk.viewer/vector-viewer, :render-fn #clerk/render-fn+opts [{:render-evaluator :sci} nextjournal.clerk.render/render-coll], :opening-paren "[", :page-size 20, :hash "5dsD1KJESfc8Dy8gPeGQfZCX2ayE8f"}, :nextjournal/render-opts {:auto-expand-results? true, :id "config-processor/anon-expr-5dtyaMceyqit2yVKk59SFyMgxEDQZZ-result-1"}}, :nextjournal/blob-id "5dsWiopAzfrhU11gtBG2HfW4vzM2eY"}, :nextjournal/render-opts {:auto-expand-results? true, :id "config-processor/anon-expr-5dtyaMceyqit2yVKk59SFyMgxEDQZZ-result-1"}, :nextjournal/viewer {:name nextjournal.clerk.viewer/result-viewer, :render-fn #clerk/render-fn+opts [{:render-evaluator :sci} nextjournal.clerk.render/render-result], :hash "5dtGVHesd2XCTLFYF3aY4kJvkrX1x1"}}], :nextjournal/viewer {:name nextjournal.clerk.viewer/cell-viewer, :render-fn #clerk/render-fn+opts [{:render-evaluator :sci} (fn [xs opts] (into [:<>] (nextjournal.clerk.render/inspect-children opts) xs))], :hash "5dtX6xLh3vbeFdswBY6jLXmB8QTqo2"}} {:path [], :nextjournal/value [:div.viewer.markdown-viewer.w-full.max-w-prose.px-8 {:data-block-id "config-processor/markdown-5dtAy1noXcj5oDGPLugzC5YNE7bDSW"} [:p [:<> "With that we can be conclusive that at least in our simulation (using Clojure)"] [#clerk/render-fn+opts [{:eval true} nextjournal.clerk.render/inspect-presented] {:nextjournal/value [:<> " "], :nextjournal/viewer {:name nextjournal.clerk.viewer/html-viewer, :render-fn #clerk/render-fn+opts [{:render-evaluator :sci} nextjournal.clerk.render/render-html], :hash "5drpr3yzJ1CcHNbRHnK2sVyn7YUmXB"}}] [:<> "Ensuring that runtime resolution occurs as expected with the deeply nested potential of"] [#clerk/render-fn+opts [{:eval true} nextjournal.clerk.render/inspect-presented] {:nextjournal/value [:<> " "], :nextjournal/viewer {:name nextjournal.clerk.viewer/html-viewer, :render-fn #clerk/render-fn+opts [{:render-evaluator :sci} nextjournal.clerk.render/render-html], :hash "5drpr3yzJ1CcHNbRHnK2sVyn7YUmXB"}}] [:<> "Pulumi outputs is essential to making sure this is a smooth experience for the developer."]] ["h3" {:id "testing"} [:<> "Testing"]] [:p [:<> "Something interesting we could do is add a unit test against the result of the simulation."]] [:p [:<> "So after the runtime evaluation this is what the harbor config's internal state would look like:"]]], :nextjournal/render-opts {:id "config-processor/markdown-5dtAy1noXcj5oDGPLugzC5YNE7bDSW"}, :nextjournal/viewer {:name nextjournal.clerk.viewer/markdown-node-viewer, :render-fn #clerk/render-fn+opts [{:render-evaluator :sci} identity], :hash "5dsg4Bx9A9L7WvvCgamUoRtxUsmYCe"}} {:path [], :nextjournal/value [{:path [0], :nextjournal/value "(def expected-harbor-state\n  [[:stack [{:vault:retrieve {:app-name \"harbor\", :app-namespace \"harbor\"}, :pulumi-options {}}\n            [:harbor\n             {:project {}, :pulumi-options {}}\n             {:robot-account {:name \"kube-harbor-robot\",\n                              :namespace \"harbor\",\n                              :level \"project\",\n                              :permissions [{:kind \"project\",\n                                             :namespace \"harbor\",\n                                             :access [{:action \"pull\", :resource \"repository\"}\n                                                      {:action \"list\", :resource \"repository\"}]}]},\n              :pulumi-options {}}]\n            {:k8s:secret {:metadata {:name \"harbor-creds-secrets\",\n                                     :namespace \"kube-system\",\n                                     :annotations {\"replicator.v1.mittwald.de/replicate-to\" \"*\"}},\n                          :type \"kubernetes.io/dockerconfigjson\",\n                          :stringData {\".dockerconfigjson\" \"{\\\"auths\\\":{\\\"host\\\":{\\\"auth\\\":\\\"Og==\\\"}}}\"}},\n             :pulumi-options {}}]]])", :nextjournal/render-opts {:loc {:line 188, :end-line 206, :column 1, :end-column 37}, :id "config-processor/expected-harbor-state-code"}, :nextjournal/viewer {:name nextjournal.clerk.viewer/code-block-viewer, :render-fn #clerk/render-fn+opts [{:render-evaluator :sci} nextjournal.clerk.render/render-code-block], :hash "5dru1FUcVRTRrVKJFbNw4FG2wXmiwB"}}], :nextjournal/viewer {:name nextjournal.clerk.viewer/cell-viewer, :render-fn #clerk/render-fn+opts [{:render-evaluator :sci} (fn [xs opts] (into [:<>] (nextjournal.clerk.render/inspect-children opts) xs))], :hash "5dtX6xLh3vbeFdswBY6jLXmB8QTqo2"}} {:path [], :nextjournal/value [:div.viewer.markdown-viewer.w-full.max-w-prose.px-8 {:data-block-id "config-processor/markdown-5du3cq9wGXSAPePaVwSdaesevxsifT"} [:p [:<> "We can very simply run now an integrity test as Pulumi will treat this in a very simple manner. The key to all of"] [#clerk/render-fn+opts [{:eval true} nextjournal.clerk.render/inspect-presented] {:nextjournal/value [:<> " "], :nextjournal/viewer {:name nextjournal.clerk.viewer/html-viewer, :render-fn #clerk/render-fn+opts [{:render-evaluator :sci} nextjournal.clerk.render/render-html], :hash "5drpr3yzJ1CcHNbRHnK2sVyn7YUmXB"}}] [:<> "this, of course, is the evaluation behind the scenes to make writing these extremely fluid and organized."]]], :nextjournal/render-opts {:id "config-processor/markdown-5du3cq9wGXSAPePaVwSdaesevxsifT"}, :nextjournal/viewer {:name nextjournal.clerk.viewer/markdown-node-viewer, :render-fn #clerk/render-fn+opts [{:render-evaluator :sci} identity], :hash "5dsg4Bx9A9L7WvvCgamUoRtxUsmYCe"}} {:path [], :nextjournal/value [{:path [0], :nextjournal/value "(deftest harbor-integrity-test\n  (let [actual (run-simulation test-config {:app-name \"harbor\"})\n        [only-in-expected only-in-actual common] (diff expected-harbor-state actual)]\n    (is (and (nil? only-in-expected)\n             (nil? only-in-actual))\n        (str \"Config mismatch! Diff: \" {:missing only-in-expected\n                                        :extra only-in-actual}))))", :nextjournal/render-opts {:loc {:line 211, :end-line 218, :column 1, :end-column 67}, :id "config-processor/harbor-integrity-test-code"}, :nextjournal/viewer {:name nextjournal.clerk.viewer/code-block-viewer, :render-fn #clerk/render-fn+opts [{:render-evaluator :sci} nextjournal.clerk.render/render-code-block], :hash "5dru1FUcVRTRrVKJFbNw4FG2wXmiwB"}}], :nextjournal/viewer {:name nextjournal.clerk.viewer/cell-viewer, :render-fn #clerk/render-fn+opts [{:render-evaluator :sci} (fn [xs opts] (into [:<>] (nextjournal.clerk.render/inspect-children opts) xs))], :hash "5dtX6xLh3vbeFdswBY6jLXmB8QTqo2"}} {:path [], :nextjournal/value [{:path [0], :nextjournal/value {:nextjournal/presented {:path [0], :nextjournal/value [{:path [0 0], :nextjournal/value [{:path [0 0 0], :nextjournal/value :error, :nextjournal/viewer {:name nextjournal.clerk.viewer/keyword-viewer, :render-fn #clerk/render-fn+opts [{:render-evaluator :sci} (fn [x] [:span.cmt-atom.inspected-value (str x)])], :hash "5dsp5Uy2KDqwuALVVk33HXMZdpXGBq"}} {:path [0 0 1], :nextjournal/value 0, :nextjournal/viewer {:name nextjournal.clerk.viewer/number-viewer, :render-fn #clerk/render-fn+opts [{:render-evaluator :sci} nextjournal.clerk.render/render-number], :hash "5dr3R1ZvHCoRHpxsQq4D4ARv9BQC7o"}}], :nextjournal/viewer {:name nextjournal.clerk.viewer/map-entry-viewer, :render-fn #clerk/render-fn+opts [{:render-evaluator :sci} (fn [xs opts] (into [:<>] (comp (nextjournal.clerk.render/inspect-children opts) (interpose " ")) xs))], :page-size 2, :hash "5dsRuzZximgoCTqHkts5WgKf7zc8xg"}} {:path [0 1], :nextjournal/value [{:path [0 1 0], :nextjournal/value :fail, :nextjournal/viewer {:name nextjournal.clerk.viewer/keyword-viewer, :render-fn #clerk/render-fn+opts [{:render-evaluator :sci} (fn [x] [:span.cmt-atom.inspected-value (str x)])], :hash "5dsp5Uy2KDqwuALVVk33HXMZdpXGBq"}} {:path [0 1 1], :nextjournal/value 0, :nextjournal/viewer {:name nextjournal.clerk.viewer/number-viewer, :render-fn #clerk/render-fn+opts [{:render-evaluator :sci} nextjournal.clerk.render/render-number], :hash "5dr3R1ZvHCoRHpxsQq4D4ARv9BQC7o"}}], :nextjournal/viewer {:name nextjournal.clerk.viewer/map-entry-viewer, :render-fn #clerk/render-fn+opts [{:render-evaluator :sci} (fn [xs opts] (into [:<>] (comp (nextjournal.clerk.render/inspect-children opts) (interpose " ")) xs))], :page-size 2, :hash "5dsRuzZximgoCTqHkts5WgKf7zc8xg"}} {:path [0 2], :nextjournal/value [{:path [0 2 0], :nextjournal/value :pass, :nextjournal/viewer {:name nextjournal.clerk.viewer/keyword-viewer, :render-fn #clerk/render-fn+opts [{:render-evaluator :sci} (fn [x] [:span.cmt-atom.inspected-value (str x)])], :hash "5dsp5Uy2KDqwuALVVk33HXMZdpXGBq"}} {:path [0 2 1], :nextjournal/value 1, :nextjournal/viewer {:name nextjournal.clerk.viewer/number-viewer, :render-fn #clerk/render-fn+opts [{:render-evaluator :sci} nextjournal.clerk.render/render-number], :hash "5dr3R1ZvHCoRHpxsQq4D4ARv9BQC7o"}}], :nextjournal/viewer {:name nextjournal.clerk.viewer/map-entry-viewer, :render-fn #clerk/render-fn+opts [{:render-evaluator :sci} (fn [xs opts] (into [:<>] (comp (nextjournal.clerk.render/inspect-children opts) (interpose " ")) xs))], :page-size 2, :hash "5dsRuzZximgoCTqHkts5WgKf7zc8xg"}} {:path [0 3], :nextjournal/value [{:path [0 3 0], :nextjournal/value :test, :nextjournal/viewer {:name nextjournal.clerk.viewer/keyword-viewer, :render-fn #clerk/render-fn+opts [{:render-evaluator :sci} (fn [x] [:span.cmt-atom.inspected-value (str x)])], :hash "5dsp5Uy2KDqwuALVVk33HXMZdpXGBq"}} {:path [0 3 1], :nextjournal/value 1, :nextjournal/viewer {:name nextjournal.clerk.viewer/number-viewer, :render-fn #clerk/render-fn+opts [{:render-evaluator :sci} nextjournal.clerk.render/render-number], :hash "5dr3R1ZvHCoRHpxsQq4D4ARv9BQC7o"}}], :nextjournal/viewer {:name nextjournal.clerk.viewer/map-entry-viewer, :render-fn #clerk/render-fn+opts [{:render-evaluator :sci} (fn [xs opts] (into [:<>] (comp (nextjournal.clerk.render/inspect-children opts) (interpose " ")) xs))], :page-size 2, :hash "5dsRuzZximgoCTqHkts5WgKf7zc8xg"}} {:path [0 4], :nextjournal/value [{:path [0 4 0], :nextjournal/value :type, :nextjournal/viewer {:name nextjournal.clerk.viewer/keyword-viewer, :render-fn #clerk/render-fn+opts [{:render-evaluator :sci} (fn [x] [:span.cmt-atom.inspected-value (str x)])], :hash "5dsp5Uy2KDqwuALVVk33HXMZdpXGBq"}} {:path [0 4 1], :nextjournal/value :summary, :nextjournal/viewer {:name nextjournal.clerk.viewer/keyword-viewer, :render-fn #clerk/render-fn+opts [{:render-evaluator :sci} (fn [x] [:span.cmt-atom.inspected-value (str x)])], :hash "5dsp5Uy2KDqwuALVVk33HXMZdpXGBq"}}], :nextjournal/viewer {:name nextjournal.clerk.viewer/map-entry-viewer, :render-fn #clerk/render-fn+opts [{:render-evaluator :sci} (fn [xs opts] (into [:<>] (comp (nextjournal.clerk.render/inspect-children opts) (interpose " ")) xs))], :page-size 2, :hash "5dsRuzZximgoCTqHkts5WgKf7zc8xg"}}], :nextjournal/viewer {:name nextjournal.clerk.viewer/map-viewer, :render-fn #clerk/render-fn+opts [{:render-evaluator :sci} nextjournal.clerk.render/render-map], :opening-paren "{", :closing-paren ("}"), :page-size 10, :hash "5drc3ac5ux7kS4h2vozdxwsrKDqSmn"}, :nextjournal/render-opts {:id "config-processor/anon-expr-5dtnGPfWLtQHpDou8uDEQEDM4ykztq-result"}}, :nextjournal/blob-id "5dqtQiYtMpf4XzCPpWra83D75RJD2D"}, :nextjournal/render-opts {:id "config-processor/anon-expr-5dtnGPfWLtQHpDou8uDEQEDM4ykztq-result"}, :nextjournal/viewer {:name nextjournal.clerk.viewer/result-viewer, :render-fn #clerk/render-fn+opts [{:render-evaluator :sci} nextjournal.clerk.render/render-result], :hash "5dtGVHesd2XCTLFYF3aY4kJvkrX1x1"}}], :nextjournal/viewer {:name nextjournal.clerk.viewer/cell-viewer, :render-fn #clerk/render-fn+opts [{:render-evaluator :sci} (fn [xs opts] (into [:<>] (nextjournal.clerk.render/inspect-children opts) xs))], :hash "5dtX6xLh3vbeFdswBY6jLXmB8QTqo2"}} {:path [], :nextjournal/value [:div.viewer.markdown-viewer.w-full.max-w-prose.px-8 {:data-block-id "config-processor/markdown-5dt63ubNBEjhKJ5dsw6wETpSSRSB4y"} [:p [:<> "Now this shows 1 passed test, so we know our config parsing works exactly as we want."]] [:p [:<> "Next we actually need to "] [:em [:<> "process"]] [:<> " the config that we have parsed"] [#clerk/render-fn+opts [{:eval true} nextjournal.clerk.render/inspect-presented] {:nextjournal/value [:<> " "], :nextjournal/viewer {:name nextjournal.clerk.viewer/html-viewer, :render-fn #clerk/render-fn+opts [{:render-evaluator :sci} nextjournal.clerk.render/render-html], :hash "5drpr3yzJ1CcHNbRHnK2sVyn7YUmXB"}}] [:<> "Now because way may have Pulumi outputs for previous whose values we want to use within the config"] [#clerk/render-fn+opts [{:eval true} nextjournal.clerk.render/inspect-presented] {:nextjournal/value [:<> " "], :nextjournal/viewer {:name nextjournal.clerk.viewer/html-viewer, :render-fn #clerk/render-fn+opts [{:render-evaluator :sci} nextjournal.clerk.render/render-html], :hash "5drpr3yzJ1CcHNbRHnK2sVyn7YUmXB"}}] [:<> "we need to resolve their values asynchronously"]] [:p [:<> "Important to note, but there aren't great ways around the clj->js and js->clj as they are in the core"] [#clerk/render-fn+opts [{:eval true} nextjournal.clerk.render/inspect-presented] {:nextjournal/value [:<> " "], :nextjournal/viewer {:name nextjournal.clerk.viewer/html-viewer, :render-fn #clerk/render-fn+opts [{:render-evaluator :sci} nextjournal.clerk.render/render-html], :hash "5drpr3yzJ1CcHNbRHnK2sVyn7YUmXB"}}] [:<> "namespace for Clojurescript... so we have implemented those in our user.clj so they can be processed correctly."] [#clerk/render-fn+opts [{:eval true} nextjournal.clerk.render/inspect-presented] {:nextjournal/value [:<> " "], :nextjournal/viewer {:name nextjournal.clerk.viewer/html-viewer, :render-fn #clerk/render-fn+opts [{:render-evaluator :sci} nextjournal.clerk.render/render-html], :hash "5drpr3yzJ1CcHNbRHnK2sVyn7YUmXB"}}] [:<> "The downside is any editor will flag these as errors."] [#clerk/render-fn+opts [{:eval true} nextjournal.clerk.render/inspect-presented] {:nextjournal/value [:<> " "], :nextjournal/viewer {:name nextjournal.clerk.viewer/html-viewer, :render-fn #clerk/render-fn+opts [{:render-evaluator :sci} nextjournal.clerk.render/render-html], :hash "5drpr3yzJ1CcHNbRHnK2sVyn7YUmXB"}}] [:<> "It may prove worthwhile to try to see the about creating the path with the least friction then."] [#clerk/render-fn+opts [{:eval true} nextjournal.clerk.render/inspect-presented] {:nextjournal/value [:<> " "], :nextjournal/viewer {:name nextjournal.clerk.viewer/html-viewer, :render-fn #clerk/render-fn+opts [{:render-evaluator :sci} nextjournal.clerk.render/render-html], :hash "5drpr3yzJ1CcHNbRHnK2sVyn7YUmXB"}}] [:<> "Seeing as Pulumi is the ONLY part that needs the values as JS objects... we can instead try to ensure"] [#clerk/render-fn+opts [{:eval true} nextjournal.clerk.render/inspect-presented] {:nextjournal/value [:<> " "], :nextjournal/viewer {:name nextjournal.clerk.viewer/html-viewer, :render-fn #clerk/render-fn+opts [{:render-evaluator :sci} nextjournal.clerk.render/render-html], :hash "5drpr3yzJ1CcHNbRHnK2sVyn7YUmXB"}}] [:<> "Everything FROM Pulumi is returned in Clojurescript and every call TO Pulumi is auto-converted to JS"]]], :nextjournal/render-opts {:id "config-processor/markdown-5dt63ubNBEjhKJ5dsw6wETpSSRSB4y"}, :nextjournal/viewer {:name nextjournal.clerk.viewer/markdown-node-viewer, :render-fn #clerk/render-fn+opts [{:render-evaluator :sci} identity], :hash "5dsg4Bx9A9L7WvvCgamUoRtxUsmYCe"}} {:path [], :nextjournal/value [{:path [0], :nextjournal/value "(defn generic-transform\n  \"Takes a creator function and executes it with resolved arguments,\n   handling asynchronicity when secrets are present.\"\n  [creator-fn opts base-values options]\n  (pulumi/apply-output options\n                       #(creator-fn (deep-merge base-values (proc/resolve-template opts %)))))", :nextjournal/render-opts {:loc {:line 234, :end-line 240, :column 1, :end-column 95}, :id "config-processor/generic-transform-code"}, :nextjournal/viewer {:name nextjournal.clerk.viewer/code-block-viewer, :render-fn #clerk/render-fn+opts [{:render-evaluator :sci} nextjournal.clerk.render/render-code-block], :hash "5dru1FUcVRTRrVKJFbNw4FG2wXmiwB"}}], :nextjournal/viewer {:name nextjournal.clerk.viewer/cell-viewer, :render-fn #clerk/render-fn+opts [{:render-evaluator :sci} (fn [xs opts] (into [:<>] (nextjournal.clerk.render/inspect-children opts) xs))], :hash "5dtX6xLh3vbeFdswBY6jLXmB8QTqo2"}} {:path [], :nextjournal/value [{:path [0], :nextjournal/value "(generic-transform (fn [args] args)  {:app-name \"cats\"} {:silly-hands {}} {:provider-template:storage-class {}})", :nextjournal/render-opts {:loc {:line 242, :end-line 242, :column 1, :end-column 113}, :id "config-processor/anon-expr-5dsKZWK6DQsoZ5mhmfRbqoAfMWBLx5-code"}, :nextjournal/viewer {:name nextjournal.clerk.viewer/code-block-viewer, :render-fn #clerk/render-fn+opts [{:render-evaluator :sci} nextjournal.clerk.render/render-code-block], :hash "5dru1FUcVRTRrVKJFbNw4FG2wXmiwB"}} {:path [1], :nextjournal/value {:nextjournal/presented {:path [1], :nextjournal/value [{:path [1 0], :nextjournal/value [{:path [1 0 0], :nextjournal/value :app-name, :nextjournal/viewer {:name nextjournal.clerk.viewer/keyword-viewer, :render-fn #clerk/render-fn+opts [{:render-evaluator :sci} (fn [x] [:span.cmt-atom.inspected-value (str x)])], :hash "5dsp5Uy2KDqwuALVVk33HXMZdpXGBq"}} {:path [1 0 1], :nextjournal/value "cats", :nextjournal/viewer {:name nextjournal.clerk.viewer/string-viewer, :render-fn #clerk/render-fn+opts [{:render-evaluator :sci} nextjournal.clerk.render/render-quoted-string], :opening-paren "\"", :closing-paren ("\""), :page-size 80, :hash "5dsDiKZaSjZpuyav79P69dRKiDtE2s"}}], :nextjournal/viewer {:name nextjournal.clerk.viewer/map-entry-viewer, :render-fn #clerk/render-fn+opts [{:render-evaluator :sci} (fn [xs opts] (into [:<>] (comp (nextjournal.clerk.render/inspect-children opts) (interpose " ")) xs))], :page-size 2, :hash "5dsRuzZximgoCTqHkts5WgKf7zc8xg"}} {:path [1 1], :nextjournal/value [{:path [1 1 0], :nextjournal/value :silly-hands, :nextjournal/viewer {:name nextjournal.clerk.viewer/keyword-viewer, :render-fn #clerk/render-fn+opts [{:render-evaluator :sci} (fn [x] [:span.cmt-atom.inspected-value (str x)])], :hash "5dsp5Uy2KDqwuALVVk33HXMZdpXGBq"}} {:path [1 1 1], :nextjournal/value [], :nextjournal/viewer {:name nextjournal.clerk.viewer/map-viewer, :render-fn #clerk/render-fn+opts [{:render-evaluator :sci} nextjournal.clerk.render/render-map], :opening-paren "{", :closing-paren ("}" "}"), :page-size 10, :hash "5drc3ac5ux7kS4h2vozdxwsrKDqSmn"}}], :nextjournal/viewer {:name nextjournal.clerk.viewer/map-entry-viewer, :render-fn #clerk/render-fn+opts [{:render-evaluator :sci} (fn [xs opts] (into [:<>] (comp (nextjournal.clerk.render/inspect-children opts) (interpose " ")) xs))], :page-size 2, :hash "5dsRuzZximgoCTqHkts5WgKf7zc8xg"}}], :nextjournal/viewer {:name nextjournal.clerk.viewer/map-viewer, :render-fn #clerk/render-fn+opts [{:render-evaluator :sci} nextjournal.clerk.render/render-map], :opening-paren "{", :page-size 10, :hash "5drc3ac5ux7kS4h2vozdxwsrKDqSmn"}, :nextjournal/render-opts {:id "config-processor/anon-expr-5dsKZWK6DQsoZ5mhmfRbqoAfMWBLx5-result-1"}}, :nextjournal/blob-id "5dr2ndQrMRN88iNaJajSg8fvCN97o6"}, :nextjournal/render-opts {:id "config-processor/anon-expr-5dsKZWK6DQsoZ5mhmfRbqoAfMWBLx5-result-1"}, :nextjournal/viewer {:name nextjournal.clerk.viewer/result-viewer, :render-fn #clerk/render-fn+opts [{:render-evaluator :sci} nextjournal.clerk.render/render-result], :hash "5dtGVHesd2XCTLFYF3aY4kJvkrX1x1"}}], :nextjournal/viewer {:name nextjournal.clerk.viewer/cell-viewer, :render-fn #clerk/render-fn+opts [{:render-evaluator :sci} (fn [xs opts] (into [:<>] (nextjournal.clerk.render/inspect-children opts) xs))], :hash "5dtX6xLh3vbeFdswBY6jLXmB8QTqo2"}} {:path [], :nextjournal/value [:div.viewer.markdown-viewer.w-full.max-w-prose.px-8 {:data-block-id "config-processor/markdown-5dtAZi8RcWsDPUS6N6D13R6fSVqCne"} [:p [:<> "We need to define how an individual resource (the individual resources that comprise this resource's steps)"] [#clerk/render-fn+opts [{:eval true} nextjournal.clerk.render/inspect-presented] {:nextjournal/value [:<> " "], :nextjournal/viewer {:name nextjournal.clerk.viewer/html-viewer, :render-fn #clerk/render-fn+opts [{:render-evaluator :sci} nextjournal.clerk.render/render-html], :hash "5drpr3yzJ1CcHNbRHnK2sVyn7YUmXB"}}] [:<> "in the Resource Config Definition"] [#clerk/render-fn+opts [{:eval true} nextjournal.clerk.render/inspect-presented] {:nextjournal/value [:<> " "], :nextjournal/viewer {:name nextjournal.clerk.viewer/html-viewer, :render-fn #clerk/render-fn+opts [{:render-evaluator :sci} nextjournal.clerk.render/render-html], :hash "5drpr3yzJ1CcHNbRHnK2sVyn7YUmXB"}}] [:<> "in order to actually provide some dynamic options later, we'll use a multi-method that handles the registered"] [#clerk/render-fn+opts [{:eval true} nextjournal.clerk.render/inspect-presented] {:nextjournal/value [:<> " "], :nextjournal/viewer {:name nextjournal.clerk.viewer/html-viewer, :render-fn #clerk/render-fn+opts [{:render-evaluator :sci} nextjournal.clerk.render/render-html], :hash "5drpr3yzJ1CcHNbRHnK2sVyn7YUmXB"}}] [:<> "components specs."]]], :nextjournal/render-opts {:id "config-processor/markdown-5dtAZi8RcWsDPUS6N6D13R6fSVqCne"}, :nextjournal/viewer {:name nextjournal.clerk.viewer/markdown-node-viewer, :render-fn #clerk/render-fn+opts [{:render-evaluator :sci} identity], :hash "5dsg4Bx9A9L7WvvCgamUoRtxUsmYCe"}} {:path [], :nextjournal/value [{:path [0], :nextjournal/value "(defmulti deploy-resource\n  \"Generic resource deployment multimethod.\n  Dispatches on the fully-qualified resource keyword.\n  Returns a map of {:resource (the-pulumi-resource) :common-opts-update {map-of-new-state}}.\"\n  (fn [dispatch-key _config] dispatch-key))", :nextjournal/render-opts {:loc {:line 248, :end-line 252, :column 1, :end-column 44}, :id "config-processor/deploy-resource-code"}, :nextjournal/viewer {:name nextjournal.clerk.viewer/code-block-viewer, :render-fn #clerk/render-fn+opts [{:render-evaluator :sci} nextjournal.clerk.render/render-code-block], :hash "5dru1FUcVRTRrVKJFbNw4FG2wXmiwB"}} {:path [1], :nextjournal/value {:nextjournal/presented {:path [1], :nextjournal/value "#object[clojure.lang.MultiFn 0xee49f34 \"clojure.lang.MultiFn@ee49f34\"]", :nextjournal/viewer {:name nextjournal.clerk.viewer/read+inspect-viewer, :render-fn #clerk/render-fn+opts [{:render-evaluator :sci} (fn [x] (try [nextjournal.clerk.render/inspect (nextjournal.clerk.viewer/read-string-without-tag-table x)] (catch js/Error _e (nextjournal.clerk.render/render-unreadable-edn x))))], :hash "5dt2ru159tAMavCJULP69Zvz1i4Zfd"}, :nextjournal/render-opts {:id "config-processor/deploy-resource-result-1"}}, :nextjournal/blob-id "5du5x2Yh2JghBAtDEx9SET3Bkx2Kcj"}, :nextjournal/render-opts {:id "config-processor/deploy-resource-result-1"}, :nextjournal/viewer {:name nextjournal.clerk.viewer/result-viewer, :render-fn #clerk/render-fn+opts [{:render-evaluator :sci} nextjournal.clerk.render/render-result], :hash "5dtGVHesd2XCTLFYF3aY4kJvkrX1x1"}}], :nextjournal/viewer {:name nextjournal.clerk.viewer/cell-viewer, :render-fn #clerk/render-fn+opts [{:render-evaluator :sci} (fn [xs opts] (into [:<>] (nextjournal.clerk.render/inspect-children opts) xs))], :hash "5dtX6xLh3vbeFdswBY6jLXmB8QTqo2"}} {:path [], :nextjournal/value [:div.viewer.markdown-viewer.w-full.max-w-prose.px-8 {:data-block-id "config-processor/markdown-5dsJaKn4TTPVph6ugvjB3T6CRnZKvo"} [:p [:<> "We'll define our component specs here with just a single provider for testing config execution"]]], :nextjournal/render-opts {:id "config-processor/markdown-5dsJaKn4TTPVph6ugvjB3T6CRnZKvo"}, :nextjournal/viewer {:name nextjournal.clerk.viewer/markdown-node-viewer, :render-fn #clerk/render-fn+opts [{:render-evaluator :sci} identity], :hash "5dsg4Bx9A9L7WvvCgamUoRtxUsmYCe"}} {:path [], :nextjournal/value [{:path [0], :nextjournal/value "(def component-specs provider-template-registry)", :nextjournal/render-opts {:loc {:line 255, :end-line 257, :column 1, :end-column 49}, :id "config-processor/component-specs-code"}, :nextjournal/viewer {:name nextjournal.clerk.viewer/code-block-viewer, :render-fn #clerk/render-fn+opts [{:render-evaluator :sci} nextjournal.clerk.render/render-code-block], :hash "5dru1FUcVRTRrVKJFbNw4FG2wXmiwB"}} {:path [1], :nextjournal/value {:nextjournal/presented {:path [1], :nextjournal/value [{:path [1 0], :nextjournal/value [{:path [1 0 0], :nextjournal/value :provider-template:example, :nextjournal/viewer {:name nextjournal.clerk.viewer/keyword-viewer, :render-fn #clerk/render-fn+opts [{:render-evaluator :sci} (fn [x] [:span.cmt-atom.inspected-value (str x)])], :hash "5dsp5Uy2KDqwuALVVk33HXMZdpXGBq"}} {:path [1 0 1], :nextjournal/value [{:path [1 0 1 0], :nextjournal/value [{:path [1 0 1 0 0], :nextjournal/value :constructor, :nextjournal/viewer {:name nextjournal.clerk.viewer/keyword-viewer, :render-fn #clerk/render-fn+opts [{:render-evaluator :sci} (fn [x] [:span.cmt-atom.inspected-value (str x)])], :hash "5dsp5Uy2KDqwuALVVk33HXMZdpXGBq"}} {:path [1 0 1 0 1], :nextjournal/value [{:path [1 0 1 0 1 0], :nextjournal/value .., :nextjournal/viewer {:name nextjournal.clerk.viewer/symbol-viewer, :render-fn #clerk/render-fn+opts [{:render-evaluator :sci} (fn [x] [:span.cmt-keyword.inspected-value (str x)])], :hash "5dtwc5kkzq7mnJapK1WH5rcPgXtaUw"}} {:path [1 0 1 0 1 1], :nextjournal/value provider-template, :nextjournal/viewer {:name nextjournal.clerk.viewer/symbol-viewer, :render-fn #clerk/render-fn+opts [{:render-evaluator :sci} (fn [x] [:span.cmt-keyword.inspected-value (str x)])], :hash "5dtwc5kkzq7mnJapK1WH5rcPgXtaUw"}} {:path [1 0 1 0 1 2], :nextjournal/value -here, :nextjournal/viewer {:name nextjournal.clerk.viewer/symbol-viewer, :render-fn #clerk/render-fn+opts [{:render-evaluator :sci} (fn [x] [:span.cmt-keyword.inspected-value (str x)])], :hash "5dtwc5kkzq7mnJapK1WH5rcPgXtaUw"}} {:path [1 0 1 0 1 3], :nextjournal/value -lives, :nextjournal/viewer {:name nextjournal.clerk.viewer/symbol-viewer, :render-fn #clerk/render-fn+opts [{:render-evaluator :sci} (fn [x] [:span.cmt-keyword.inspected-value (str x)])], :hash "5dtwc5kkzq7mnJapK1WH5rcPgXtaUw"}} {:path [1 0 1 0 1 4], :nextjournal/value -TheConstructor, :nextjournal/viewer {:name nextjournal.clerk.viewer/symbol-viewer, :render-fn #clerk/render-fn+opts [{:render-evaluator :sci} (fn [x] [:span.cmt-keyword.inspected-value (str x)])], :hash "5dtwc5kkzq7mnJapK1WH5rcPgXtaUw"}}], :nextjournal/viewer {:name nextjournal.clerk.viewer/sequential-viewer, :render-fn #clerk/render-fn+opts [{:render-evaluator :sci} nextjournal.clerk.render/render-coll], :opening-paren "(", :closing-paren (")"), :page-size 20, :hash "5dsgY1QgV2KqnvvrRRC3HXgCeF3Qge"}}], :nextjournal/viewer {:name nextjournal.clerk.viewer/map-entry-viewer, :render-fn #clerk/render-fn+opts [{:render-evaluator :sci} (fn [xs opts] (into [:<>] (comp (nextjournal.clerk.render/inspect-children opts) (interpose " ")) xs))], :page-size 2, :hash "5dsRuzZximgoCTqHkts5WgKf7zc8xg"}} {:path [1 0 1 1], :nextjournal/value [{:path [1 0 1 1 0], :nextjournal/value :defaults-fn, :nextjournal/viewer {:name nextjournal.clerk.viewer/keyword-viewer, :render-fn #clerk/render-fn+opts [{:render-evaluator :sci} (fn [x] [:span.cmt-atom.inspected-value (str x)])], :hash "5dsp5Uy2KDqwuALVVk33HXMZdpXGBq"}} {:path [1 0 1 1 1], :nextjournal/value "#object[general$fn__16892 0x6e74986c \"general$fn__16892@6e74986c\"]", :nextjournal/viewer {:name nextjournal.clerk.viewer/read+inspect-viewer, :render-fn #clerk/render-fn+opts [{:render-evaluator :sci} (fn [x] (try [nextjournal.clerk.render/inspect (nextjournal.clerk.viewer/read-string-without-tag-table x)] (catch js/Error _e (nextjournal.clerk.render/render-unreadable-edn x))))], :hash "5dt2ru159tAMavCJULP69Zvz1i4Zfd"}}], :nextjournal/viewer {:name nextjournal.clerk.viewer/map-entry-viewer, :render-fn #clerk/render-fn+opts [{:render-evaluator :sci} (fn [xs opts] (into [:<>] (comp (nextjournal.clerk.render/inspect-children opts) (interpose " ")) xs))], :page-size 2, :hash "5dsRuzZximgoCTqHkts5WgKf7zc8xg"}} {:path [1 0 1 2], :nextjournal/value [{:path [1 0 1 2 0], :nextjournal/value :provider-key, :nextjournal/viewer {:name nextjournal.clerk.viewer/keyword-viewer, :render-fn #clerk/render-fn+opts [{:render-evaluator :sci} (fn [x] [:span.cmt-atom.inspected-value (str x)])], :hash "5dsp5Uy2KDqwuALVVk33HXMZdpXGBq"}} {:path [1 0 1 2 1], :nextjournal/value :provider-template, :nextjournal/viewer {:name nextjournal.clerk.viewer/keyword-viewer, :render-fn #clerk/render-fn+opts [{:render-evaluator :sci} (fn [x] [:span.cmt-atom.inspected-value (str x)])], :hash "5dsp5Uy2KDqwuALVVk33HXMZdpXGBq"}}], :nextjournal/viewer {:name nextjournal.clerk.viewer/map-entry-viewer, :render-fn #clerk/render-fn+opts [{:render-evaluator :sci} (fn [xs opts] (into [:<>] (comp (nextjournal.clerk.render/inspect-children opts) (interpose " ")) xs))], :page-size 2, :hash "5dsRuzZximgoCTqHkts5WgKf7zc8xg"}}], :nextjournal/viewer {:name nextjournal.clerk.viewer/map-viewer, :render-fn #clerk/render-fn+opts [{:render-evaluator :sci} nextjournal.clerk.render/render-map], :opening-paren "{", :closing-paren ("}"), :page-size 10, :hash "5drc3ac5ux7kS4h2vozdxwsrKDqSmn"}}], :nextjournal/viewer {:name nextjournal.clerk.viewer/map-entry-viewer, :render-fn #clerk/render-fn+opts [{:render-evaluator :sci} (fn [xs opts] (into [:<>] (comp (nextjournal.clerk.render/inspect-children opts) (interpose " ")) xs))], :page-size 2, :hash "5dsRuzZximgoCTqHkts5WgKf7zc8xg"}} {:path [1 1], :nextjournal/value [{:path [1 1 0], :nextjournal/value :provider-template:storage-class, :nextjournal/viewer {:name nextjournal.clerk.viewer/keyword-viewer, :render-fn #clerk/render-fn+opts [{:render-evaluator :sci} (fn [x] [:span.cmt-atom.inspected-value (str x)])], :hash "5dsp5Uy2KDqwuALVVk33HXMZdpXGBq"}} {:path [1 1 1], :nextjournal/value [{:path [1 1 1 0], :nextjournal/value [{:path [1 1 1 0 0], :nextjournal/value :constructor, :nextjournal/viewer {:name nextjournal.clerk.viewer/keyword-viewer, :render-fn #clerk/render-fn+opts [{:render-evaluator :sci} (fn [x] [:span.cmt-atom.inspected-value (str x)])], :hash "5dsp5Uy2KDqwuALVVk33HXMZdpXGBq"}} {:path [1 1 1 0 1], :nextjournal/value [{:path [1 1 1 0 1 0], :nextjournal/value .., :nextjournal/viewer {:name nextjournal.clerk.viewer/symbol-viewer, :render-fn #clerk/render-fn+opts [{:render-evaluator :sci} (fn [x] [:span.cmt-keyword.inspected-value (str x)])], :hash "5dtwc5kkzq7mnJapK1WH5rcPgXtaUw"}} {:path [1 1 1 0 1 1], :nextjournal/value provider-template, :nextjournal/viewer {:name nextjournal.clerk.viewer/symbol-viewer, :render-fn #clerk/render-fn+opts [{:render-evaluator :sci} (fn [x] [:span.cmt-keyword.inspected-value (str x)])], :hash "5dtwc5kkzq7mnJapK1WH5rcPgXtaUw"}} {:path [1 1 1 0 1 2], :nextjournal/value -core, :nextjournal/viewer {:name nextjournal.clerk.viewer/symbol-viewer, :render-fn #clerk/render-fn+opts [{:render-evaluator :sci} (fn [x] [:span.cmt-keyword.inspected-value (str x)])], :hash "5dtwc5kkzq7mnJapK1WH5rcPgXtaUw"}} {:path [1 1 1 0 1 3], :nextjournal/value -v1, :nextjournal/viewer {:name nextjournal.clerk.viewer/symbol-viewer, :render-fn #clerk/render-fn+opts [{:render-evaluator :sci} (fn [x] [:span.cmt-keyword.inspected-value (str x)])], :hash "5dtwc5kkzq7mnJapK1WH5rcPgXtaUw"}} {:path [1 1 1 0 1 4], :nextjournal/value -StorageClass, :nextjournal/viewer {:name nextjournal.clerk.viewer/symbol-viewer, :render-fn #clerk/render-fn+opts [{:render-evaluator :sci} (fn [x] [:span.cmt-keyword.inspected-value (str x)])], :hash "5dtwc5kkzq7mnJapK1WH5rcPgXtaUw"}}], :nextjournal/viewer {:name nextjournal.clerk.viewer/sequential-viewer, :render-fn #clerk/render-fn+opts [{:render-evaluator :sci} nextjournal.clerk.render/render-coll], :opening-paren "(", :closing-paren (")"), :page-size 20, :hash "5dsgY1QgV2KqnvvrRRC3HXgCeF3Qge"}}], :nextjournal/viewer {:name nextjournal.clerk.viewer/map-entry-viewer, :render-fn #clerk/render-fn+opts [{:render-evaluator :sci} (fn [xs opts] (into [:<>] (comp (nextjournal.clerk.render/inspect-children opts) (interpose " ")) xs))], :page-size 2, :hash "5dsRuzZximgoCTqHkts5WgKf7zc8xg"}} {:path [1 1 1 1], :nextjournal/value [{:path [1 1 1 1 0], :nextjournal/value :defaults-fn, :nextjournal/viewer {:name nextjournal.clerk.viewer/keyword-viewer, :render-fn #clerk/render-fn+opts [{:render-evaluator :sci} (fn [x] [:span.cmt-atom.inspected-value (str x)])], :hash "5dsp5Uy2KDqwuALVVk33HXMZdpXGBq"}} {:path [1 1 1 1 1], :nextjournal/value "#object[general$fn__16894 0x1f112da2 \"general$fn__16894@1f112da2\"]", :nextjournal/viewer {:name nextjournal.clerk.viewer/read+inspect-viewer, :render-fn #clerk/render-fn+opts [{:render-evaluator :sci} (fn [x] (try [nextjournal.clerk.render/inspect (nextjournal.clerk.viewer/read-string-without-tag-table x)] (catch js/Error _e (nextjournal.clerk.render/render-unreadable-edn x))))], :hash "5dt2ru159tAMavCJULP69Zvz1i4Zfd"}}], :nextjournal/viewer {:name nextjournal.clerk.viewer/map-entry-viewer, :render-fn #clerk/render-fn+opts [{:render-evaluator :sci} (fn [xs opts] (into [:<>] (comp (nextjournal.clerk.render/inspect-children opts) (interpose " ")) xs))], :page-size 2, :hash "5dsRuzZximgoCTqHkts5WgKf7zc8xg"}} {:path [1 1 1 2], :nextjournal/value [{:path [1 1 1 2 0], :nextjournal/value :provider-key, :nextjournal/viewer {:name nextjournal.clerk.viewer/keyword-viewer, :render-fn #clerk/render-fn+opts [{:render-evaluator :sci} (fn [x] [:span.cmt-atom.inspected-value (str x)])], :hash "5dsp5Uy2KDqwuALVVk33HXMZdpXGBq"}} {:path [1 1 1 2 1], :nextjournal/value :provider-template, :nextjournal/viewer {:name nextjournal.clerk.viewer/keyword-viewer, :render-fn #clerk/render-fn+opts [{:render-evaluator :sci} (fn [x] [:span.cmt-atom.inspected-value (str x)])], :hash "5dsp5Uy2KDqwuALVVk33HXMZdpXGBq"}}], :nextjournal/viewer {:name nextjournal.clerk.viewer/map-entry-viewer, :render-fn #clerk/render-fn+opts [{:render-evaluator :sci} (fn [xs opts] (into [:<>] (comp (nextjournal.clerk.render/inspect-children opts) (interpose " ")) xs))], :page-size 2, :hash "5dsRuzZximgoCTqHkts5WgKf7zc8xg"}}], :nextjournal/viewer {:name nextjournal.clerk.viewer/map-viewer, :render-fn #clerk/render-fn+opts [{:render-evaluator :sci} nextjournal.clerk.render/render-map], :opening-paren "{", :closing-paren ("}" "}"), :page-size 10, :hash "5drc3ac5ux7kS4h2vozdxwsrKDqSmn"}}], :nextjournal/viewer {:name nextjournal.clerk.viewer/map-entry-viewer, :render-fn #clerk/render-fn+opts [{:render-evaluator :sci} (fn [xs opts] (into [:<>] (comp (nextjournal.clerk.render/inspect-children opts) (interpose " ")) xs))], :page-size 2, :hash "5dsRuzZximgoCTqHkts5WgKf7zc8xg"}}], :nextjournal/viewer {:name nextjournal.clerk.viewer/map-viewer, :render-fn #clerk/render-fn+opts [{:render-evaluator :sci} nextjournal.clerk.render/render-map], :opening-paren "{", :page-size 10, :hash "5drc3ac5ux7kS4h2vozdxwsrKDqSmn"}, :nextjournal/render-opts {:auto-expand-results? true, :id "config-processor/component-specs-result-1"}}, :nextjournal/blob-id "5dqyNBwhk1GTC2mRKXbnwB9dv6Z79c"}, :nextjournal/render-opts {:auto-expand-results? true, :id "config-processor/component-specs-result-1"}, :nextjournal/viewer {:name nextjournal.clerk.viewer/result-viewer, :render-fn #clerk/render-fn+opts [{:render-evaluator :sci} nextjournal.clerk.render/render-result], :hash "5dtGVHesd2XCTLFYF3aY4kJvkrX1x1"}}], :nextjournal/viewer {:name nextjournal.clerk.viewer/cell-viewer, :render-fn #clerk/render-fn+opts [{:render-evaluator :sci} (fn [xs opts] (into [:<>] (nextjournal.clerk.render/inspect-children opts) xs))], :hash "5dtX6xLh3vbeFdswBY6jLXmB8QTqo2"}} {:path [], :nextjournal/value [:div.viewer.markdown-viewer.w-full.max-w-prose.px-8 {:data-block-id "config-processor/markdown-5dtBtwmqYg5ezLr4ByStxX3XDtN3nj"} [:p [:<> "We should also make a simpler test-config for now until we finish our provider design"]]], :nextjournal/render-opts {:id "config-processor/markdown-5dtBtwmqYg5ezLr4ByStxX3XDtN3nj"}, :nextjournal/viewer {:name nextjournal.clerk.viewer/markdown-node-viewer, :render-fn #clerk/render-fn+opts [{:render-evaluator :sci} identity], :hash "5dsg4Bx9A9L7WvvCgamUoRtxUsmYCe"}} {:path [], :nextjournal/value [{:path [0], :nextjournal/value "(def test-config-2 {:app-name \"test\"\n                    :stack [{:provider-template:storage-class {:app-name 'app-name\n                                                               :app-namespace 'app-name\n                                                               :random-setting \"something\"}\n                             :pulumi-options {:safe {}}}]})", :nextjournal/render-opts {:loc {:line 260, :end-line 264, :column 1, :end-column 60}, :id "config-processor/test-config-2-code"}, :nextjournal/viewer {:name nextjournal.clerk.viewer/code-block-viewer, :render-fn #clerk/render-fn+opts [{:render-evaluator :sci} nextjournal.clerk.render/render-code-block], :hash "5dru1FUcVRTRrVKJFbNw4FG2wXmiwB"}} {:path [1], :nextjournal/value {:nextjournal/presented {:path [1], :nextjournal/value [{:path [1 0], :nextjournal/value [{:path [1 0 0], :nextjournal/value :app-name, :nextjournal/viewer {:name nextjournal.clerk.viewer/keyword-viewer, :render-fn #clerk/render-fn+opts [{:render-evaluator :sci} (fn [x] [:span.cmt-atom.inspected-value (str x)])], :hash "5dsp5Uy2KDqwuALVVk33HXMZdpXGBq"}} {:path [1 0 1], :nextjournal/value "test", :nextjournal/viewer {:name nextjournal.clerk.viewer/string-viewer, :render-fn #clerk/render-fn+opts [{:render-evaluator :sci} nextjournal.clerk.render/render-quoted-string], :opening-paren "\"", :closing-paren ("\""), :page-size 80, :hash "5dsDiKZaSjZpuyav79P69dRKiDtE2s"}}], :nextjournal/viewer {:name nextjournal.clerk.viewer/map-entry-viewer, :render-fn #clerk/render-fn+opts [{:render-evaluator :sci} (fn [xs opts] (into [:<>] (comp (nextjournal.clerk.render/inspect-children opts) (interpose " ")) xs))], :page-size 2, :hash "5dsRuzZximgoCTqHkts5WgKf7zc8xg"}} {:path [1 1], :nextjournal/value [{:path [1 1 0], :nextjournal/value :stack, :nextjournal/viewer {:name nextjournal.clerk.viewer/keyword-viewer, :render-fn #clerk/render-fn+opts [{:render-evaluator :sci} (fn [x] [:span.cmt-atom.inspected-value (str x)])], :hash "5dsp5Uy2KDqwuALVVk33HXMZdpXGBq"}} {:path [1 1 1], :nextjournal/value [{:path [1 1 1 0], :nextjournal/value [{:path [1 1 1 0 0], :nextjournal/value [{:path [1 1 1 0 0 0], :nextjournal/value :provider-template:storage-class, :nextjournal/viewer {:name nextjournal.clerk.viewer/keyword-viewer, :render-fn #clerk/render-fn+opts [{:render-evaluator :sci} (fn [x] [:span.cmt-atom.inspected-value (str x)])], :hash "5dsp5Uy2KDqwuALVVk33HXMZdpXGBq"}} {:path [1 1 1 0 0 1], :nextjournal/value [{:path [1 1 1 0 0 1 0], :nextjournal/value [{:path [1 1 1 0 0 1 0 0], :nextjournal/value :app-name, :nextjournal/viewer {:name nextjournal.clerk.viewer/keyword-viewer, :render-fn #clerk/render-fn+opts [{:render-evaluator :sci} (fn [x] [:span.cmt-atom.inspected-value (str x)])], :hash "5dsp5Uy2KDqwuALVVk33HXMZdpXGBq"}} {:path [1 1 1 0 0 1 0 1], :nextjournal/value app-name, :nextjournal/viewer {:name nextjournal.clerk.viewer/symbol-viewer, :render-fn #clerk/render-fn+opts [{:render-evaluator :sci} (fn [x] [:span.cmt-keyword.inspected-value (str x)])], :hash "5dtwc5kkzq7mnJapK1WH5rcPgXtaUw"}}], :nextjournal/viewer {:name nextjournal.clerk.viewer/map-entry-viewer, :render-fn #clerk/render-fn+opts [{:render-evaluator :sci} (fn [xs opts] (into [:<>] (comp (nextjournal.clerk.render/inspect-children opts) (interpose " ")) xs))], :page-size 2, :hash "5dsRuzZximgoCTqHkts5WgKf7zc8xg"}} {:path [1 1 1 0 0 1 1], :nextjournal/value [{:path [1 1 1 0 0 1 1 0], :nextjournal/value :app-namespace, :nextjournal/viewer {:name nextjournal.clerk.viewer/keyword-viewer, :render-fn #clerk/render-fn+opts [{:render-evaluator :sci} (fn [x] [:span.cmt-atom.inspected-value (str x)])], :hash "5dsp5Uy2KDqwuALVVk33HXMZdpXGBq"}} {:path [1 1 1 0 0 1 1 1], :nextjournal/value app-name, :nextjournal/viewer {:name nextjournal.clerk.viewer/symbol-viewer, :render-fn #clerk/render-fn+opts [{:render-evaluator :sci} (fn [x] [:span.cmt-keyword.inspected-value (str x)])], :hash "5dtwc5kkzq7mnJapK1WH5rcPgXtaUw"}}], :nextjournal/viewer {:name nextjournal.clerk.viewer/map-entry-viewer, :render-fn #clerk/render-fn+opts [{:render-evaluator :sci} (fn [xs opts] (into [:<>] (comp (nextjournal.clerk.render/inspect-children opts) (interpose " ")) xs))], :page-size 2, :hash "5dsRuzZximgoCTqHkts5WgKf7zc8xg"}} {:path [1 1 1 0 0 1 2], :nextjournal/value [{:path [1 1 1 0 0 1 2 0], :nextjournal/value :random-setting, :nextjournal/viewer {:name nextjournal.clerk.viewer/keyword-viewer, :render-fn #clerk/render-fn+opts [{:render-evaluator :sci} (fn [x] [:span.cmt-atom.inspected-value (str x)])], :hash "5dsp5Uy2KDqwuALVVk33HXMZdpXGBq"}} {:path [1 1 1 0 0 1 2 1], :nextjournal/value "something", :nextjournal/viewer {:name nextjournal.clerk.viewer/string-viewer, :render-fn #clerk/render-fn+opts [{:render-evaluator :sci} nextjournal.clerk.render/render-quoted-string], :opening-paren "\"", :closing-paren ("\"" "}"), :page-size 80, :hash "5dsDiKZaSjZpuyav79P69dRKiDtE2s"}}], :nextjournal/viewer {:name nextjournal.clerk.viewer/map-entry-viewer, :render-fn #clerk/render-fn+opts [{:render-evaluator :sci} (fn [xs opts] (into [:<>] (comp (nextjournal.clerk.render/inspect-children opts) (interpose " ")) xs))], :page-size 2, :hash "5dsRuzZximgoCTqHkts5WgKf7zc8xg"}}], :nextjournal/viewer {:name nextjournal.clerk.viewer/map-viewer, :render-fn #clerk/render-fn+opts [{:render-evaluator :sci} nextjournal.clerk.render/render-map], :opening-paren "{", :page-size 10, :hash "5drc3ac5ux7kS4h2vozdxwsrKDqSmn"}}], :nextjournal/viewer {:name nextjournal.clerk.viewer/map-entry-viewer, :render-fn #clerk/render-fn+opts [{:render-evaluator :sci} (fn [xs opts] (into [:<>] (comp (nextjournal.clerk.render/inspect-children opts) (interpose " ")) xs))], :page-size 2, :hash "5dsRuzZximgoCTqHkts5WgKf7zc8xg"}} {:path [1 1 1 0 1], :nextjournal/value [{:path [1 1 1 0 1 0], :nextjournal/value :pulumi-options, :nextjournal/viewer {:name nextjournal.clerk.viewer/keyword-viewer, :render-fn #clerk/render-fn+opts [{:render-evaluator :sci} (fn [x] [:span.cmt-atom.inspected-value (str x)])], :hash "5dsp5Uy2KDqwuALVVk33HXMZdpXGBq"}} {:path [1 1 1 0 1 1], :nextjournal/value [{:path [1 1 1 0 1 1 0], :nextjournal/value [{:path [1 1 1 0 1 1 0 0], :nextjournal/value :safe, :nextjournal/viewer {:name nextjournal.clerk.viewer/keyword-viewer, :render-fn #clerk/render-fn+opts [{:render-evaluator :sci} (fn [x] [:span.cmt-atom.inspected-value (str x)])], :hash "5dsp5Uy2KDqwuALVVk33HXMZdpXGBq"}} {:path [1 1 1 0 1 1 0 1], :nextjournal/value [], :nextjournal/viewer {:name nextjournal.clerk.viewer/map-viewer, :render-fn #clerk/render-fn+opts [{:render-evaluator :sci} nextjournal.clerk.render/render-map], :opening-paren "{", :closing-paren ("}" "}" "}" "]" "}"), :page-size 10, :hash "5drc3ac5ux7kS4h2vozdxwsrKDqSmn"}}], :nextjournal/viewer {:name nextjournal.clerk.viewer/map-entry-viewer, :render-fn #clerk/render-fn+opts [{:render-evaluator :sci} (fn [xs opts] (into [:<>] (comp (nextjournal.clerk.render/inspect-children opts) (interpose " ")) xs))], :page-size 2, :hash "5dsRuzZximgoCTqHkts5WgKf7zc8xg"}}], :nextjournal/viewer {:name nextjournal.clerk.viewer/map-viewer, :render-fn #clerk/render-fn+opts [{:render-evaluator :sci} nextjournal.clerk.render/render-map], :opening-paren "{", :page-size 10, :hash "5drc3ac5ux7kS4h2vozdxwsrKDqSmn"}}], :nextjournal/viewer {:name nextjournal.clerk.viewer/map-entry-viewer, :render-fn #clerk/render-fn+opts [{:render-evaluator :sci} (fn [xs opts] (into [:<>] (comp (nextjournal.clerk.render/inspect-children opts) (interpose " ")) xs))], :page-size 2, :hash "5dsRuzZximgoCTqHkts5WgKf7zc8xg"}}], :nextjournal/viewer {:name nextjournal.clerk.viewer/map-viewer, :render-fn #clerk/render-fn+opts [{:render-evaluator :sci} nextjournal.clerk.render/render-map], :opening-paren "{", :page-size 10, :hash "5drc3ac5ux7kS4h2vozdxwsrKDqSmn"}}], :nextjournal/viewer {:name nextjournal.clerk.viewer/vector-viewer, :render-fn #clerk/render-fn+opts [{:render-evaluator :sci} nextjournal.clerk.render/render-coll], :opening-paren "[", :page-size 20, :hash "5dsD1KJESfc8Dy8gPeGQfZCX2ayE8f"}}], :nextjournal/viewer {:name nextjournal.clerk.viewer/map-entry-viewer, :render-fn #clerk/render-fn+opts [{:render-evaluator :sci} (fn [xs opts] (into [:<>] (comp (nextjournal.clerk.render/inspect-children opts) (interpose " ")) xs))], :page-size 2, :hash "5dsRuzZximgoCTqHkts5WgKf7zc8xg"}}], :nextjournal/viewer {:name nextjournal.clerk.viewer/map-viewer, :render-fn #clerk/render-fn+opts [{:render-evaluator :sci} nextjournal.clerk.render/render-map], :opening-paren "{", :page-size 10, :hash "5drc3ac5ux7kS4h2vozdxwsrKDqSmn"}, :nextjournal/render-opts {:id "config-processor/test-config-2-result-1"}}, :nextjournal/blob-id "5dqsdHH2RAVExA3mWS3X2jfZABnDqS"}, :nextjournal/render-opts {:id "config-processor/test-config-2-result-1"}, :nextjournal/viewer {:name nextjournal.clerk.viewer/result-viewer, :render-fn #clerk/render-fn+opts [{:render-evaluator :sci} nextjournal.clerk.render/render-result], :hash "5dtGVHesd2XCTLFYF3aY4kJvkrX1x1"}}], :nextjournal/viewer {:name nextjournal.clerk.viewer/cell-viewer, :render-fn #clerk/render-fn+opts [{:render-evaluator :sci} (fn [xs opts] (into [:<>] (nextjournal.clerk.render/inspect-children opts) xs))], :hash "5dtX6xLh3vbeFdswBY6jLXmB8QTqo2"}} {:path [], :nextjournal/value [:div.viewer.markdown-viewer.w-full.max-w-prose.px-8 {:data-block-id "config-processor/markdown-5drwePdbLSuqSnxiHXX6b36R4NeBWu"} [:p [:<> "and the deploy-resource default function here"] [#clerk/render-fn+opts [{:eval true} nextjournal.clerk.render/inspect-presented] {:nextjournal/value [:<> " "], :nextjournal/viewer {:name nextjournal.clerk.viewer/html-viewer, :render-fn #clerk/render-fn+opts [{:render-evaluator :sci} nextjournal.clerk.render/render-html], :hash "5drpr3yzJ1CcHNbRHnK2sVyn7YUmXB"}}] [:<> "now it should be able to simply pick out the keys from the config itself that has been parsed earlier"] [#clerk/render-fn+opts [{:eval true} nextjournal.clerk.render/inspect-presented] {:nextjournal/value [:<> " "], :nextjournal/viewer {:name nextjournal.clerk.viewer/html-viewer, :render-fn #clerk/render-fn+opts [{:render-evaluator :sci} nextjournal.clerk.render/render-html], :hash "5drpr3yzJ1CcHNbRHnK2sVyn7YUmXB"}}] [:<> "and shape them into a form that can be passed to the constructor in the component spec for Pulumi"] [#clerk/render-fn+opts [{:eval true} nextjournal.clerk.render/inspect-presented] {:nextjournal/value [:<> " "], :nextjournal/viewer {:name nextjournal.clerk.viewer/html-viewer, :render-fn #clerk/render-fn+opts [{:render-evaluator :sci} nextjournal.clerk.render/render-html], :hash "5drpr3yzJ1CcHNbRHnK2sVyn7YUmXB"}}] [:<> "to generate the given resource"]] [:p [:<> "Defining a helper debug atom for debugging in real-time w/ Clerk"]]], :nextjournal/render-opts {:id "config-processor/markdown-5drwePdbLSuqSnxiHXX6b36R4NeBWu"}, :nextjournal/viewer {:name nextjournal.clerk.viewer/markdown-node-viewer, :render-fn #clerk/render-fn+opts [{:render-evaluator :sci} identity], :hash "5dsg4Bx9A9L7WvvCgamUoRtxUsmYCe"}} {:path [], :nextjournal/value [{:path [0], :nextjournal/value "(defonce debug-log (atom []))", :nextjournal/render-opts {:loc {:line 272, :end-line 272, :column 1, :end-column 30}, :id "config-processor/debug-log-code"}, :nextjournal/viewer {:name nextjournal.clerk.viewer/code-block-viewer, :render-fn #clerk/render-fn+opts [{:render-evaluator :sci} nextjournal.clerk.render/render-code-block], :hash "5dru1FUcVRTRrVKJFbNw4FG2wXmiwB"}} {:path [1], :nextjournal/value {:nextjournal/presented {:path [1], :nextjournal/value {:tag {:path [1 :tag], :nextjournal/value "object", :nextjournal/viewer {:name nextjournal.clerk.viewer/string-viewer, :render-fn #clerk/render-fn+opts [{:render-evaluator :sci} nextjournal.clerk.render/render-quoted-string], :opening-paren "\"", :closing-paren "\"", :page-size 80, :hash "5dsDiKZaSjZpuyav79P69dRKiDtE2s"}}, :value {:path [1 :value], :nextjournal/value [{:path [1 :value 0], :nextjournal/value clojure.lang.Atom, :nextjournal/viewer {:name nextjournal.clerk.viewer/symbol-viewer, :render-fn #clerk/render-fn+opts [{:render-evaluator :sci} (fn [x] [:span.cmt-keyword.inspected-value (str x)])], :hash "5dtwc5kkzq7mnJapK1WH5rcPgXtaUw"}} {:path [1 :value 1], :nextjournal/value 931071799, :nextjournal/viewer {:name nextjournal.clerk.viewer/number-hex-viewer, :render-fn #clerk/render-fn+opts [{:render-evaluator :sci} (fn [num] (nextjournal.clerk.render/render-number (str "0x" (.toString (js/Number. num) 16))))], :hash "5duAe5YusWW99fBRyGNJYycPAHynYB"}} {:path [1 :value 2], :nextjournal/value [{:path [1 :value 2 0], :nextjournal/value [{:path [1 :value 2 0 0], :nextjournal/value :status, :nextjournal/viewer {:name nextjournal.clerk.viewer/keyword-viewer, :render-fn #clerk/render-fn+opts [{:render-evaluator :sci} (fn [x] [:span.cmt-atom.inspected-value (str x)])], :hash "5dsp5Uy2KDqwuALVVk33HXMZdpXGBq"}} {:path [1 :value 2 0 1], :nextjournal/value :ready, :nextjournal/viewer {:name nextjournal.clerk.viewer/keyword-viewer, :render-fn #clerk/render-fn+opts [{:render-evaluator :sci} (fn [x] [:span.cmt-atom.inspected-value (str x)])], :hash "5dsp5Uy2KDqwuALVVk33HXMZdpXGBq"}}], :nextjournal/viewer {:name nextjournal.clerk.viewer/map-entry-viewer, :render-fn #clerk/render-fn+opts [{:render-evaluator :sci} (fn [xs opts] (into [:<>] (comp (nextjournal.clerk.render/inspect-children opts) (interpose " ")) xs))], :page-size 2, :hash "5dsRuzZximgoCTqHkts5WgKf7zc8xg"}} {:path [1 :value 2 1], :nextjournal/value [{:path [1 :value 2 1 0], :nextjournal/value :val, :nextjournal/viewer {:name nextjournal.clerk.viewer/keyword-viewer, :render-fn #clerk/render-fn+opts [{:render-evaluator :sci} (fn [x] [:span.cmt-atom.inspected-value (str x)])], :hash "5dsp5Uy2KDqwuALVVk33HXMZdpXGBq"}} {:path [1 :value 2 1 1], :nextjournal/value [{:path [1 :value 2 1 1 0], :nextjournal/value :provider-template:storage-class, :nextjournal/viewer {:name nextjournal.clerk.viewer/keyword-viewer, :render-fn #clerk/render-fn+opts [{:render-evaluator :sci} (fn [x] [:span.cmt-atom.inspected-value (str x)])], :hash "5dsp5Uy2KDqwuALVVk33HXMZdpXGBq"}}], :nextjournal/viewer {:name nextjournal.clerk.viewer/vector-viewer, :render-fn #clerk/render-fn+opts [{:render-evaluator :sci} nextjournal.clerk.render/render-coll], :opening-paren "[", :closing-paren "]", :page-size 20, :hash "5dsD1KJESfc8Dy8gPeGQfZCX2ayE8f"}}], :nextjournal/viewer {:name nextjournal.clerk.viewer/map-entry-viewer, :render-fn #clerk/render-fn+opts [{:render-evaluator :sci} (fn [xs opts] (into [:<>] (comp (nextjournal.clerk.render/inspect-children opts) (interpose " ")) xs))], :page-size 2, :hash "5dsRuzZximgoCTqHkts5WgKf7zc8xg"}}], :nextjournal/viewer {:name nextjournal.clerk.viewer/map-viewer, :render-fn #clerk/render-fn+opts [{:render-evaluator :sci} nextjournal.clerk.render/render-map], :opening-paren "{", :closing-paren "}", :page-size 10, :hash "5drc3ac5ux7kS4h2vozdxwsrKDqSmn"}}], :nextjournal/viewer {:name nextjournal.clerk.viewer/vector-viewer, :render-fn #clerk/render-fn+opts [{:render-evaluator :sci} nextjournal.clerk.render/render-coll], :opening-paren "[", :closing-paren "]", :page-size 20, :hash "5dsD1KJESfc8Dy8gPeGQfZCX2ayE8f"}}}, :nextjournal/viewer {:name nextjournal.clerk.viewer/tagged-value-viewer, :render-fn #clerk/render-fn+opts [{:render-evaluator :sci} (fn [{:keys [tag value space?]} opts] (nextjournal.clerk.render/render-tagged-value {:space? (:nextjournal/value space?)} (str "#" (:nextjournal/value tag)) [nextjournal.clerk.render/inspect-presented value]))], :hash "5dr1HpSR8stnV1Ptv6zvnjabB7Kt58"}, :nextjournal/render-opts {:id "config-processor/debug-log-result-1"}}, :nextjournal/blob-id "5duBbZqccH5j3cHnwkLksrM8RwJ9to"}, :nextjournal/render-opts {:id "config-processor/debug-log-result-1"}, :nextjournal/viewer {:name nextjournal.clerk.viewer/result-viewer, :render-fn #clerk/render-fn+opts [{:render-evaluator :sci} nextjournal.clerk.render/render-result], :hash "5dtGVHesd2XCTLFYF3aY4kJvkrX1x1"}}], :nextjournal/viewer {:name nextjournal.clerk.viewer/cell-viewer, :render-fn #clerk/render-fn+opts [{:render-evaluator :sci} (fn [xs opts] (into [:<>] (nextjournal.clerk.render/inspect-children opts) xs))], :hash "5dtX6xLh3vbeFdswBY6jLXmB8QTqo2"}} {:path [], :nextjournal/value [{:path [0], :nextjournal/value "(reset! debug-log [])", :nextjournal/render-opts {:loc {:line 273, :end-line 273, :column 1, :end-column 22}, :id "config-processor/anon-expr-5dr4xcgzvtAne9MwR8pjfwuPRNzN7U-code"}, :nextjournal/viewer {:name nextjournal.clerk.viewer/code-block-viewer, :render-fn #clerk/render-fn+opts [{:render-evaluator :sci} nextjournal.clerk.render/render-code-block], :hash "5dru1FUcVRTRrVKJFbNw4FG2wXmiwB"}} {:path [1], :nextjournal/value {:nextjournal/presented {:path [1], :nextjournal/value [], :nextjournal/viewer {:name nextjournal.clerk.viewer/vector-viewer, :render-fn #clerk/render-fn+opts [{:render-evaluator :sci} nextjournal.clerk.render/render-coll], :opening-paren "[", :closing-paren ("]"), :page-size 20, :hash "5dsD1KJESfc8Dy8gPeGQfZCX2ayE8f"}, :nextjournal/render-opts {:id "config-processor/anon-expr-5dr4xcgzvtAne9MwR8pjfwuPRNzN7U-result-1"}}, :nextjournal/blob-id "5drf5P1ABmnkn2YoZ1LTehPDhJQWwU"}, :nextjournal/render-opts {:id "config-processor/anon-expr-5dr4xcgzvtAne9MwR8pjfwuPRNzN7U-result-1"}, :nextjournal/viewer {:name nextjournal.clerk.viewer/result-viewer, :render-fn #clerk/render-fn+opts [{:render-evaluator :sci} nextjournal.clerk.render/render-result], :hash "5dtGVHesd2XCTLFYF3aY4kJvkrX1x1"}}], :nextjournal/viewer {:name nextjournal.clerk.viewer/cell-viewer, :render-fn #clerk/render-fn+opts [{:render-evaluator :sci} (fn [xs opts] (into [:<>] (nextjournal.clerk.render/inspect-children opts) xs))], :hash "5dtX6xLh3vbeFdswBY6jLXmB8QTqo2"}} {:path [], :nextjournal/value [:div.viewer.markdown-viewer.w-full.max-w-prose.px-8 {:data-block-id "config-processor/markdown-5dst9CAksc3FoxoKtr7FVBibcxcbsB"} [:p [:<> "Starting the conversion of the old deploy resource function. Since the actual process is convoluted"] [#clerk/render-fn+opts [{:eval true} nextjournal.clerk.render/inspect-presented] {:nextjournal/value [:<> " "], :nextjournal/viewer {:name nextjournal.clerk.viewer/html-viewer, :render-fn #clerk/render-fn+opts [{:render-evaluator :sci} nextjournal.clerk.render/render-html], :hash "5drpr3yzJ1CcHNbRHnK2sVyn7YUmXB"}}] [:<> "We'll instead start with the higher-order functions before this."] [#clerk/render-fn+opts [{:eval true} nextjournal.clerk.render/inspect-presented] {:nextjournal/value [:<> " "], :nextjournal/viewer {:name nextjournal.clerk.viewer/html-viewer, :render-fn #clerk/render-fn+opts [{:render-evaluator :sci} nextjournal.clerk.render/render-html], :hash "5drpr3yzJ1CcHNbRHnK2sVyn7YUmXB"}}] [:<> "Including sorting our solution for provider organization and loading."]]], :nextjournal/render-opts {:id "config-processor/markdown-5dst9CAksc3FoxoKtr7FVBibcxcbsB"}, :nextjournal/viewer {:name nextjournal.clerk.viewer/markdown-node-viewer, :render-fn #clerk/render-fn+opts [{:render-evaluator :sci} identity], :hash "5dsg4Bx9A9L7WvvCgamUoRtxUsmYCe"}} {:path [], :nextjournal/value [{:path [0], :nextjournal/value "(defmethod deploy-resource :default\n  [dispatch-key full-config]\n  #_(if-let [spec (get component-specs dispatch-key)]\n      (let [app-name       (:app-name full-config)\n            dependsOn      (:dependsOn full-config)\n            provider-key   (:provider-key spec)\n            provider       (get full-config provider-key)\n            resource-class (:constructor spec)\n\n            opts-key       (keyword (str (name dispatch-key) \"-opts\"))\n\n\n            component-opts (get full-config opts-key)\n\n            env            {:options full-config :secrets (:secrets full-config) :component-opts component-opts}\n\n            raw-defaults   (when-let [df (:default-fn spec)] (df env))]\n\n        (if resource-class\n          (let [base-creator (fn [final-args suffix]\n                               (let [final-name (if suffix\n                                                  (str app-name \"-\" suffix)\n                                                  app-name)]\n                                 (pulumi/new-resource resource-class\n                                                      final-name\n                                                      final-args\n                                                      {provider\n                                                       dependsOn})))]\n            {:resource\n             (p-> raw-defaults\n                  #(let [defaults-list (if (vector? %)\n                                         %\n                                         [%])\n                         is-multi?     (vector? %) resources\n                         (doall\n                          (map-indexed\n                           (fn [idx item]\n                             (let [suffix (cond\n                                            (:_suffix item) (:_suffix item)\n                                            is-multi? (str idx)\n                                            :else nil)\n                                   clean-item (dissoc item :_suffix)\n                                   item-creator (fn [resolved-args]\n                                                  (base-creator resolved-args suffix))\n                                   _ (println item-creator)]\n\n                               (generic-transform item-creator\n                                                  component-opts\n                                                  clean-item\n                                                  full-config)))\n                           defaults-list))]\n                     (if is-multi? resources (first resources))))})\n\n          (throw (ex-info (str \"No :constructor found for spec: \" dispatch-key) {:dispatch-key dispatch-key\n                                                                                 :type :missing-constructor}))))\n\n      (throw (ex-info (str \"Unknown resource: \" dispatch-key) {:dispatch-key dispatch-key}))))", :nextjournal/render-opts {:loc {:line 279, :end-line 335, :column 1, :end-column 95}, :id "config-processor/deploy-resource#2-code"}, :nextjournal/viewer {:name nextjournal.clerk.viewer/code-block-viewer, :render-fn #clerk/render-fn+opts [{:render-evaluator :sci} nextjournal.clerk.render/render-code-block], :hash "5dru1FUcVRTRrVKJFbNw4FG2wXmiwB"}} {:path [1], :nextjournal/value {:nextjournal/presented {:path [1], :nextjournal/value "#object[clojure.lang.MultiFn 0xee49f34 \"clojure.lang.MultiFn@ee49f34\"]", :nextjournal/viewer {:name nextjournal.clerk.viewer/read+inspect-viewer, :render-fn #clerk/render-fn+opts [{:render-evaluator :sci} (fn [x] (try [nextjournal.clerk.render/inspect (nextjournal.clerk.viewer/read-string-without-tag-table x)] (catch js/Error _e (nextjournal.clerk.render/render-unreadable-edn x))))], :hash "5dt2ru159tAMavCJULP69Zvz1i4Zfd"}, :nextjournal/render-opts {:id "config-processor/deploy-resource#2-result-1"}}, :nextjournal/blob-id "5dt8qe8a4L4vECZ7rciXHJVTzbcL9w"}, :nextjournal/render-opts {:id "config-processor/deploy-resource#2-result-1"}, :nextjournal/viewer {:name nextjournal.clerk.viewer/result-viewer, :render-fn #clerk/render-fn+opts [{:render-evaluator :sci} nextjournal.clerk.render/render-result], :hash "5dtGVHesd2XCTLFYF3aY4kJvkrX1x1"}}], :nextjournal/viewer {:name nextjournal.clerk.viewer/cell-viewer, :render-fn #clerk/render-fn+opts [{:render-evaluator :sci} (fn [xs opts] (into [:<>] (nextjournal.clerk.render/inspect-children opts) xs))], :hash "5dtX6xLh3vbeFdswBY6jLXmB8QTqo2"}} {:path [], :nextjournal/value [:div.viewer.markdown-viewer.w-full.max-w-prose.px-8 {:data-block-id "config-processor/markdown-5dsKst4L2mYvrQxTYG7tK3qcv3zv7F"} [:p [:<> "Simple little helper function"] [#clerk/render-fn+opts [{:eval true} nextjournal.clerk.render/inspect-presented] {:nextjournal/value [:<> " "], :nextjournal/viewer {:name nextjournal.clerk.viewer/html-viewer, :render-fn #clerk/render-fn+opts [{:render-evaluator :sci} nextjournal.clerk.render/render-html], :hash "5drpr3yzJ1CcHNbRHnK2sVyn7YUmXB"}}] [:<> "Just using it to merge to the inner of the resource step map and associate"] [#clerk/render-fn+opts [{:eval true} nextjournal.clerk.render/inspect-presented] {:nextjournal/value [:<> " "], :nextjournal/viewer {:name nextjournal.clerk.viewer/html-viewer, :render-fn #clerk/render-fn+opts [{:render-evaluator :sci} nextjournal.clerk.render/render-html], :hash "5drpr3yzJ1CcHNbRHnK2sVyn7YUmXB"}}] [:<> "depends on to pulumi options"]]], :nextjournal/render-opts {:id "config-processor/markdown-5dsKst4L2mYvrQxTYG7tK3qcv3zv7F"}, :nextjournal/viewer {:name nextjournal.clerk.viewer/markdown-node-viewer, :render-fn #clerk/render-fn+opts [{:render-evaluator :sci} identity], :hash "5dsg4Bx9A9L7WvvCgamUoRtxUsmYCe"}} {:path [], :nextjournal/value [{:path [0], :nextjournal/value "(defn merge-into-stack-entry\n  [obj target-key merge-path merge-map]\n  (let [stack (:stack obj)\n        idx   (some (fn [[i m]]\n                      (when (contains? m target-key)\n                        i))\n                    (map-indexed vector stack))]\n    (if (nil? idx)\n      obj\n      (update-in obj (into [:stack idx] merge-path)\n                 merge merge-map))))", :nextjournal/render-opts {:loc {:line 341, :end-line 351, :column 1, :end-column 37}, :id "config-processor/merge-into-stack-entry-code"}, :nextjournal/viewer {:name nextjournal.clerk.viewer/code-block-viewer, :render-fn #clerk/render-fn+opts [{:render-evaluator :sci} nextjournal.clerk.render/render-code-block], :hash "5dru1FUcVRTRrVKJFbNw4FG2wXmiwB"}} {:path [1], :nextjournal/value {:nextjournal/presented {:path [1], :nextjournal/value "#object[config_processor$merge_into_stack_entry 0x525cb986 \"config_processor$merge_into_stack_entry@525cb986\"]", :nextjournal/viewer {:name nextjournal.clerk.viewer/read+inspect-viewer, :render-fn #clerk/render-fn+opts [{:render-evaluator :sci} (fn [x] (try [nextjournal.clerk.render/inspect (nextjournal.clerk.viewer/read-string-without-tag-table x)] (catch js/Error _e (nextjournal.clerk.render/render-unreadable-edn x))))], :hash "5dt2ru159tAMavCJULP69Zvz1i4Zfd"}, :nextjournal/render-opts {:id "config-processor/merge-into-stack-entry-result-1"}}, :nextjournal/blob-id nil}, :nextjournal/render-opts {:id "config-processor/merge-into-stack-entry-result-1"}, :nextjournal/viewer {:name nextjournal.clerk.viewer/result-viewer, :render-fn #clerk/render-fn+opts [{:render-evaluator :sci} nextjournal.clerk.render/render-result], :hash "5dtGVHesd2XCTLFYF3aY4kJvkrX1x1"}}], :nextjournal/viewer {:name nextjournal.clerk.viewer/cell-viewer, :render-fn #clerk/render-fn+opts [{:render-evaluator :sci} (fn [xs opts] (into [:<>] (nextjournal.clerk.render/inspect-children opts) xs))], :hash "5dtX6xLh3vbeFdswBY6jLXmB8QTqo2"}} {:path [], :nextjournal/value [:div.viewer.markdown-viewer.w-full.max-w-prose.px-8 {:data-block-id "config-processor/markdown-5dtGAPS7nxFwNjD1vZ3NffSLybBtjr"} [:p [:<> "Simplify the merging..."] [#clerk/render-fn+opts [{:eval true} nextjournal.clerk.render/inspect-presented] {:nextjournal/value [:<> " "], :nextjournal/viewer {:name nextjournal.clerk.viewer/html-viewer, :render-fn #clerk/render-fn+opts [{:render-evaluator :sci} nextjournal.clerk.render/render-html], :hash "5drpr3yzJ1CcHNbRHnK2sVyn7YUmXB"}}] [:<> "However, in doing this we still fail to address the actual uniqueness where duplicates"] [#clerk/render-fn+opts [{:eval true} nextjournal.clerk.render/inspect-presented] {:nextjournal/value [:<> " "], :nextjournal/viewer {:name nextjournal.clerk.viewer/html-viewer, :render-fn #clerk/render-fn+opts [{:render-evaluator :sci} nextjournal.clerk.render/render-html], :hash "5drpr3yzJ1CcHNbRHnK2sVyn7YUmXB"}}] [:<> "can cause issue (since depends-on seems too simplistic)"] [#clerk/render-fn+opts [{:eval true} nextjournal.clerk.render/inspect-presented] {:nextjournal/value [:<> " "], :nextjournal/viewer {:name nextjournal.clerk.viewer/html-viewer, :render-fn #clerk/render-fn+opts [{:render-evaluator :sci} nextjournal.clerk.render/render-html], :hash "5drpr3yzJ1CcHNbRHnK2sVyn7YUmXB"}}] [:<> "Certainly might be tired though, so I'll revisit this also in the morning."]]], :nextjournal/render-opts {:id "config-processor/markdown-5dtGAPS7nxFwNjD1vZ3NffSLybBtjr"}, :nextjournal/viewer {:name nextjournal.clerk.viewer/markdown-node-viewer, :render-fn #clerk/render-fn+opts [{:render-evaluator :sci} identity], :hash "5dsg4Bx9A9L7WvvCgamUoRtxUsmYCe"}} {:path [], :nextjournal/value [{:path [0], :nextjournal/value "(defn handle-keyword-item [last-resource dispatch-key final-config common-opts]\n  (let [deploy-config (merge-into-stack-entry\n                       final-config\n                       :provider-template:storage-class\n                       [:pulumi-options]\n                       {:depends-on (cond-> []\n                                      last-resource (conj last-resource)\n                                      (:depends-on final-config) (into (:depends-on final-config)))})\n\n\n        result-map    (deploy-resource dispatch-key deploy-config)\n        resource      (:resource result-map)]\n\n    [resource\n     nil\n     (merge common-opts (:common-opts-update result-map))]))", :nextjournal/render-opts {:loc {:line 357, :end-line 372, :column 1, :end-column 61}, :id "config-processor/handle-keyword-item-code"}, :nextjournal/viewer {:name nextjournal.clerk.viewer/code-block-viewer, :render-fn #clerk/render-fn+opts [{:render-evaluator :sci} nextjournal.clerk.render/render-code-block], :hash "5dru1FUcVRTRrVKJFbNw4FG2wXmiwB"}} {:path [1], :nextjournal/value {:nextjournal/presented {:path [1], :nextjournal/value "#object[config_processor$handle_keyword_item 0x2eea76bc \"config_processor$handle_keyword_item@2eea76bc\"]", :nextjournal/viewer {:name nextjournal.clerk.viewer/read+inspect-viewer, :render-fn #clerk/render-fn+opts [{:render-evaluator :sci} (fn [x] (try [nextjournal.clerk.render/inspect (nextjournal.clerk.viewer/read-string-without-tag-table x)] (catch js/Error _e (nextjournal.clerk.render/render-unreadable-edn x))))], :hash "5dt2ru159tAMavCJULP69Zvz1i4Zfd"}, :nextjournal/render-opts {:id "config-processor/handle-keyword-item-result-1"}}, :nextjournal/blob-id nil}, :nextjournal/render-opts {:id "config-processor/handle-keyword-item-result-1"}, :nextjournal/viewer {:name nextjournal.clerk.viewer/result-viewer, :render-fn #clerk/render-fn+opts [{:render-evaluator :sci} nextjournal.clerk.render/render-result], :hash "5dtGVHesd2XCTLFYF3aY4kJvkrX1x1"}}], :nextjournal/viewer {:name nextjournal.clerk.viewer/cell-viewer, :render-fn #clerk/render-fn+opts [{:render-evaluator :sci} (fn [xs opts] (into [:<>] (nextjournal.clerk.render/inspect-children opts) xs))], :hash "5dtX6xLh3vbeFdswBY6jLXmB8QTqo2"}} {:path [], :nextjournal/value [:div.viewer.markdown-viewer.w-full.max-w-prose.px-8 {:data-block-id "config-processor/markdown-5drcmi1RGEfez2NNPZnQV6W6pmSjvw"} [:p [:<> "Have not touched this yet."]]], :nextjournal/render-opts {:id "config-processor/markdown-5drcmi1RGEfez2NNPZnQV6W6pmSjvw"}, :nextjournal/viewer {:name nextjournal.clerk.viewer/markdown-node-viewer, :render-fn #clerk/render-fn+opts [{:render-evaluator :sci} identity], :hash "5dsg4Bx9A9L7WvvCgamUoRtxUsmYCe"}} {:path [], :nextjournal/value [{:path [0], :nextjournal/value "(defn handle-list-item [last-resource item config common-opts]\n  (let [provider-key (first item)\n        resource-keys (rest item)\n\n        nested-result\n        (reduce\n         (fn [nested-acc resource-key]\n           (let [inner-last-resource (get nested-acc :last-resource)\n                 inner-resources-map (get nested-acc :resources)\n                 inner-common-opts   (get nested-acc :common-opts)\n                 dispatch-key (keyword (str (name provider-key) \":\" (name resource-key)))\n                 [new-resource new-resource-map new-common-opts]\n                 (handle-keyword-item inner-last-resource dispatch-key config inner-common-opts)]\n             {:last-resource (or new-resource inner-last-resource)\n              :resources     (merge inner-resources-map new-resource-map)\n              :common-opts   new-common-opts}))\n         {:last-resource last-resource\n          :resources     {}\n          :common-opts   common-opts}\n\n         resource-keys)]\n\n    [(:last-resource nested-result)\n     (:resources nested-result)\n     (:common-opts nested-result)]))", :nextjournal/render-opts {:loc {:line 376, :end-line 400, :column 1, :end-column 37}, :id "config-processor/handle-list-item-code"}, :nextjournal/viewer {:name nextjournal.clerk.viewer/code-block-viewer, :render-fn #clerk/render-fn+opts [{:render-evaluator :sci} nextjournal.clerk.render/render-code-block], :hash "5dru1FUcVRTRrVKJFbNw4FG2wXmiwB"}} {:path [1], :nextjournal/value {:nextjournal/presented {:path [1], :nextjournal/value "#object[config_processor$handle_list_item 0x1629947a \"config_processor$handle_list_item@1629947a\"]", :nextjournal/viewer {:name nextjournal.clerk.viewer/read+inspect-viewer, :render-fn #clerk/render-fn+opts [{:render-evaluator :sci} (fn [x] (try [nextjournal.clerk.render/inspect (nextjournal.clerk.viewer/read-string-without-tag-table x)] (catch js/Error _e (nextjournal.clerk.render/render-unreadable-edn x))))], :hash "5dt2ru159tAMavCJULP69Zvz1i4Zfd"}, :nextjournal/render-opts {:id "config-processor/handle-list-item-result-1"}}, :nextjournal/blob-id nil}, :nextjournal/render-opts {:id "config-processor/handle-list-item-result-1"}, :nextjournal/viewer {:name nextjournal.clerk.viewer/result-viewer, :render-fn #clerk/render-fn+opts [{:render-evaluator :sci} nextjournal.clerk.render/render-result], :hash "5dtGVHesd2XCTLFYF3aY4kJvkrX1x1"}}], :nextjournal/viewer {:name nextjournal.clerk.viewer/cell-viewer, :render-fn #clerk/render-fn+opts [{:render-evaluator :sci} (fn [xs opts] (into [:<>] (nextjournal.clerk.render/inspect-children opts) xs))], :hash "5dtX6xLh3vbeFdswBY6jLXmB8QTqo2"}} {:path [], :nextjournal/value [:div.viewer.markdown-viewer.w-full.max-w-prose.px-8 {:data-block-id "config-processor/markdown-5dta3qrGsCAQ81E2hZcpdzoJtvoAER"} [:p [:<> "This made me start thinking about using the Clojure feature 'spec'"] [#clerk/render-fn+opts [{:eval true} nextjournal.clerk.render/inspect-presented] {:nextjournal/value [:<> " "], :nextjournal/viewer {:name nextjournal.clerk.viewer/html-viewer, :render-fn #clerk/render-fn+opts [{:render-evaluator :sci} nextjournal.clerk.render/render-html], :hash "5drpr3yzJ1CcHNbRHnK2sVyn7YUmXB"}}] [:<> "I'll probably revisit a lot of this and better define using spec"]]], :nextjournal/render-opts {:id "config-processor/markdown-5dta3qrGsCAQ81E2hZcpdzoJtvoAER"}, :nextjournal/viewer {:name nextjournal.clerk.viewer/markdown-node-viewer, :render-fn #clerk/render-fn+opts [{:render-evaluator :sci} identity], :hash "5dsg4Bx9A9L7WvvCgamUoRtxUsmYCe"}} {:path [], :nextjournal/value [{:path [0], :nextjournal/value "(defn derive-identity [type-kw config resources-map]\n  (let [user-alias (:alias config)\n        resource-name (or (:name config) (get-in config [:metadata :name]))\n        default-key type-kw]\n\n    (cond\n      user-alias user-alias\n      (contains? resources-map default-key)\n      (if resource-name\n        (keyword (name type-kw) (str resource-name))\n        (throw (ex-info (str \"Duplicate resource type \" type-kw \" detected. \"\n                             \"Please provide an :alias or a :name.\")\n                        {:type type-kw :config config})))\n      :else default-key)))", :nextjournal/render-opts {:loc {:line 405, :end-line 418, :column 1, :end-column 27}, :id "config-processor/derive-identity-code"}, :nextjournal/viewer {:name nextjournal.clerk.viewer/code-block-viewer, :render-fn #clerk/render-fn+opts [{:render-evaluator :sci} nextjournal.clerk.render/render-code-block], :hash "5dru1FUcVRTRrVKJFbNw4FG2wXmiwB"}} {:path [1], :nextjournal/value {:nextjournal/presented {:path [1], :nextjournal/value "#object[config_processor$derive_identity 0x2e6e0c7e \"config_processor$derive_identity@2e6e0c7e\"]", :nextjournal/viewer {:name nextjournal.clerk.viewer/read+inspect-viewer, :render-fn #clerk/render-fn+opts [{:render-evaluator :sci} (fn [x] (try [nextjournal.clerk.render/inspect (nextjournal.clerk.viewer/read-string-without-tag-table x)] (catch js/Error _e (nextjournal.clerk.render/render-unreadable-edn x))))], :hash "5dt2ru159tAMavCJULP69Zvz1i4Zfd"}, :nextjournal/render-opts {:id "config-processor/derive-identity-result-1"}}, :nextjournal/blob-id nil}, :nextjournal/render-opts {:id "config-processor/derive-identity-result-1"}, :nextjournal/viewer {:name nextjournal.clerk.viewer/result-viewer, :render-fn #clerk/render-fn+opts [{:render-evaluator :sci} nextjournal.clerk.render/render-result], :hash "5dtGVHesd2XCTLFYF3aY4kJvkrX1x1"}}], :nextjournal/viewer {:name nextjournal.clerk.viewer/cell-viewer, :render-fn #clerk/render-fn+opts [{:render-evaluator :sci} (fn [xs opts] (into [:<>] (nextjournal.clerk.render/inspect-children opts) xs))], :hash "5dtX6xLh3vbeFdswBY6jLXmB8QTqo2"}} {:path [], :nextjournal/value [:div.viewer.markdown-viewer.w-full.max-w-prose.px-8 {:data-block-id "config-processor/markdown-5dsc45yZwRekVZCHtyWa9q2ZzWs3yC"} [:p [:<> "Going to slowly work out which parts we can peel away and simplify"] [#clerk/render-fn+opts [{:eval true} nextjournal.clerk.render/inspect-presented] {:nextjournal/value [:<> " "], :nextjournal/viewer {:name nextjournal.clerk.viewer/html-viewer, :render-fn #clerk/render-fn+opts [{:render-evaluator :sci} nextjournal.clerk.render/render-html], :hash "5drpr3yzJ1CcHNbRHnK2sVyn7YUmXB"}}] [:<> "From the initial."] [#clerk/render-fn+opts [{:eval true} nextjournal.clerk.render/inspect-presented] {:nextjournal/value [:<> " "], :nextjournal/viewer {:name nextjournal.clerk.viewer/html-viewer, :render-fn #clerk/render-fn+opts [{:render-evaluator :sci} nextjournal.clerk.render/render-html], :hash "5drpr3yzJ1CcHNbRHnK2sVyn7YUmXB"}}] [:<> "It'll likely make more sense to simply define the problem and map it out, but"] [#clerk/render-fn+opts [{:eval true} nextjournal.clerk.render/inspect-presented] {:nextjournal/value [:<> " "], :nextjournal/viewer {:name nextjournal.clerk.viewer/html-viewer, :render-fn #clerk/render-fn+opts [{:render-evaluator :sci} nextjournal.clerk.render/render-html], :hash "5drpr3yzJ1CcHNbRHnK2sVyn7YUmXB"}}] [:<> "we spent a chunk of time just writing out provider templating, so this was"] [#clerk/render-fn+opts [{:eval true} nextjournal.clerk.render/inspect-presented] {:nextjournal/value [:<> " "], :nextjournal/viewer {:name nextjournal.clerk.viewer/html-viewer, :render-fn #clerk/render-fn+opts [{:render-evaluator :sci} nextjournal.clerk.render/render-html], :hash "5drpr3yzJ1CcHNbRHnK2sVyn7YUmXB"}}] [:<> "a bit more rushed."]]], :nextjournal/render-opts {:id "config-processor/markdown-5dsc45yZwRekVZCHtyWa9q2ZzWs3yC"}, :nextjournal/viewer {:name nextjournal.clerk.viewer/markdown-node-viewer, :render-fn #clerk/render-fn+opts [{:render-evaluator :sci} identity], :hash "5dsg4Bx9A9L7WvvCgamUoRtxUsmYCe"}} {:path [], :nextjournal/value [{:path [0], :nextjournal/value "(defn process-stack [stack-items config initial-common-opts]\n  (reduce\n   (fn [acc item]\n     (let [{:keys [last-resource resources-map common-opts]} acc]\n\n       (cond\n         (vector? item)\n         (let [[new-res new-map new-opts]\n               (handle-list-item last-resource item config common-opts)]\n           {:last-resource (or new-res last-resource)\n            :resources-map (merge resources-map new-map)\n            :common-opts   new-opts})\n         :else\n         (let [[type-kw specific-config]\n               (cond\n                 (keyword? item) [item {}]\n                 (map? item)     (first item)\n                 :else (throw (ex-info \"Unknown item\" {:item item})))\n\n               storage-key (derive-identity type-kw specific-config resources-map)\n               _ (reset! debug-log [])\n               _ (swap! debug-log conj storage-key)\n               [new-res _ result-opts] \n               (handle-keyword-item last-resource\n                                    type-kw\n                                    config\n                                    common-opts)]\n\n           {:last-resource (or new-res last-resource)\n            :resources-map (assoc resources-map storage-key new-res)\n            :common-opts   (merge common-opts result-opts)}))))\n   {:last-resource nil :resources-map {} :common-opts initial-common-opts}\n   stack-items))", :nextjournal/render-opts {:loc {:line 426, :end-line 458, :column 1, :end-column 17}, :id "config-processor/process-stack-code"}, :nextjournal/viewer {:name nextjournal.clerk.viewer/code-block-viewer, :render-fn #clerk/render-fn+opts [{:render-evaluator :sci} nextjournal.clerk.render/render-code-block], :hash "5dru1FUcVRTRrVKJFbNw4FG2wXmiwB"}} {:path [1], :nextjournal/value {:nextjournal/presented {:path [1], :nextjournal/value "#object[config_processor$process_stack 0x194910bc \"config_processor$process_stack@194910bc\"]", :nextjournal/viewer {:name nextjournal.clerk.viewer/read+inspect-viewer, :render-fn #clerk/render-fn+opts [{:render-evaluator :sci} (fn [x] (try [nextjournal.clerk.render/inspect (nextjournal.clerk.viewer/read-string-without-tag-table x)] (catch js/Error _e (nextjournal.clerk.render/render-unreadable-edn x))))], :hash "5dt2ru159tAMavCJULP69Zvz1i4Zfd"}, :nextjournal/render-opts {:id "config-processor/process-stack-result-1"}}, :nextjournal/blob-id nil}, :nextjournal/render-opts {:id "config-processor/process-stack-result-1"}, :nextjournal/viewer {:name nextjournal.clerk.viewer/result-viewer, :render-fn #clerk/render-fn+opts [{:render-evaluator :sci} nextjournal.clerk.render/render-result], :hash "5dtGVHesd2XCTLFYF3aY4kJvkrX1x1"}}], :nextjournal/viewer {:name nextjournal.clerk.viewer/cell-viewer, :render-fn #clerk/render-fn+opts [{:render-evaluator :sci} (fn [xs opts] (into [:<>] (nextjournal.clerk.render/inspect-children opts) xs))], :hash "5dtX6xLh3vbeFdswBY6jLXmB8QTqo2"}} {:path [], :nextjournal/value [{:path [0], :nextjournal/value "(process-stack (:stack test-config-2) test-config-2 (select-keys test-config-2 [:app-name :app-namespace]))", :nextjournal/render-opts {:loc {:line 461, :end-line 463, :column 1, :end-column 108}, :id "config-processor/anon-expr-5dqoCBE3VwzUMTpF3KG4KEeT4AnHhV-code"}, :nextjournal/viewer {:name nextjournal.clerk.viewer/code-block-viewer, :render-fn #clerk/render-fn+opts [{:render-evaluator :sci} nextjournal.clerk.render/render-code-block], :hash "5dru1FUcVRTRrVKJFbNw4FG2wXmiwB"}} {:path [1], :nextjournal/value {:nextjournal/presented {:path [1], :nextjournal/value [{:path [1 0], :nextjournal/value [{:path [1 0 0], :nextjournal/value :common-opts, :nextjournal/viewer {:name nextjournal.clerk.viewer/keyword-viewer, :render-fn #clerk/render-fn+opts [{:render-evaluator :sci} (fn [x] [:span.cmt-atom.inspected-value (str x)])], :hash "5dsp5Uy2KDqwuALVVk33HXMZdpXGBq"}} {:path [1 0 1], :nextjournal/value [{:path [1 0 1 0], :nextjournal/value [{:path [1 0 1 0 0], :nextjournal/value :app-name, :nextjournal/viewer {:name nextjournal.clerk.viewer/keyword-viewer, :render-fn #clerk/render-fn+opts [{:render-evaluator :sci} (fn [x] [:span.cmt-atom.inspected-value (str x)])], :hash "5dsp5Uy2KDqwuALVVk33HXMZdpXGBq"}} {:path [1 0 1 0 1], :nextjournal/value "test", :nextjournal/viewer {:name nextjournal.clerk.viewer/string-viewer, :render-fn #clerk/render-fn+opts [{:render-evaluator :sci} nextjournal.clerk.render/render-quoted-string], :opening-paren "\"", :closing-paren ("\"" "}"), :page-size 80, :hash "5dsDiKZaSjZpuyav79P69dRKiDtE2s"}}], :nextjournal/viewer {:name nextjournal.clerk.viewer/map-entry-viewer, :render-fn #clerk/render-fn+opts [{:render-evaluator :sci} (fn [xs opts] (into [:<>] (comp (nextjournal.clerk.render/inspect-children opts) (interpose " ")) xs))], :page-size 2, :hash "5dsRuzZximgoCTqHkts5WgKf7zc8xg"}}], :nextjournal/viewer {:name nextjournal.clerk.viewer/map-viewer, :render-fn #clerk/render-fn+opts [{:render-evaluator :sci} nextjournal.clerk.render/render-map], :opening-paren "{", :page-size 10, :hash "5drc3ac5ux7kS4h2vozdxwsrKDqSmn"}}], :nextjournal/viewer {:name nextjournal.clerk.viewer/map-entry-viewer, :render-fn #clerk/render-fn+opts [{:render-evaluator :sci} (fn [xs opts] (into [:<>] (comp (nextjournal.clerk.render/inspect-children opts) (interpose " ")) xs))], :page-size 2, :hash "5dsRuzZximgoCTqHkts5WgKf7zc8xg"}} {:path [1 1], :nextjournal/value [{:path [1 1 0], :nextjournal/value :last-resource, :nextjournal/viewer {:name nextjournal.clerk.viewer/keyword-viewer, :render-fn #clerk/render-fn+opts [{:render-evaluator :sci} (fn [x] [:span.cmt-atom.inspected-value (str x)])], :hash "5dsp5Uy2KDqwuALVVk33HXMZdpXGBq"}} {:path [1 1 1], :nextjournal/value nil, :nextjournal/viewer {:name nextjournal.clerk.viewer/nil-viewer, :render-fn #clerk/render-fn+opts [{:render-evaluator :sci} (fn [_] [:span.cmt-default.inspected-value "nil"])], :hash "5ds5uDqqy4yJDMFDdH4gQZN84hJLZM"}}], :nextjournal/viewer {:name nextjournal.clerk.viewer/map-entry-viewer, :render-fn #clerk/render-fn+opts [{:render-evaluator :sci} (fn [xs opts] (into [:<>] (comp (nextjournal.clerk.render/inspect-children opts) (interpose " ")) xs))], :page-size 2, :hash "5dsRuzZximgoCTqHkts5WgKf7zc8xg"}} {:path [1 2], :nextjournal/value [{:path [1 2 0], :nextjournal/value :resources-map, :nextjournal/viewer {:name nextjournal.clerk.viewer/keyword-viewer, :render-fn #clerk/render-fn+opts [{:render-evaluator :sci} (fn [x] [:span.cmt-atom.inspected-value (str x)])], :hash "5dsp5Uy2KDqwuALVVk33HXMZdpXGBq"}} {:path [1 2 1], :nextjournal/value [{:path [1 2 1 0], :nextjournal/value [{:path [1 2 1 0 0], :nextjournal/value :provider-template:storage-class, :nextjournal/viewer {:name nextjournal.clerk.viewer/keyword-viewer, :render-fn #clerk/render-fn+opts [{:render-evaluator :sci} (fn [x] [:span.cmt-atom.inspected-value (str x)])], :hash "5dsp5Uy2KDqwuALVVk33HXMZdpXGBq"}} {:path [1 2 1 0 1], :nextjournal/value nil, :nextjournal/viewer {:name nextjournal.clerk.viewer/nil-viewer, :render-fn #clerk/render-fn+opts [{:render-evaluator :sci} (fn [_] [:span.cmt-default.inspected-value "nil"])], :hash "5ds5uDqqy4yJDMFDdH4gQZN84hJLZM"}}], :nextjournal/viewer {:name nextjournal.clerk.viewer/map-entry-viewer, :render-fn #clerk/render-fn+opts [{:render-evaluator :sci} (fn [xs opts] (into [:<>] (comp (nextjournal.clerk.render/inspect-children opts) (interpose " ")) xs))], :page-size 2, :hash "5dsRuzZximgoCTqHkts5WgKf7zc8xg"}}], :nextjournal/viewer {:name nextjournal.clerk.viewer/map-viewer, :render-fn #clerk/render-fn+opts [{:render-evaluator :sci} nextjournal.clerk.render/render-map], :opening-paren "{", :closing-paren ("}" "}"), :page-size 10, :hash "5drc3ac5ux7kS4h2vozdxwsrKDqSmn"}}], :nextjournal/viewer {:name nextjournal.clerk.viewer/map-entry-viewer, :render-fn #clerk/render-fn+opts [{:render-evaluator :sci} (fn [xs opts] (into [:<>] (comp (nextjournal.clerk.render/inspect-children opts) (interpose " ")) xs))], :page-size 2, :hash "5dsRuzZximgoCTqHkts5WgKf7zc8xg"}}], :nextjournal/viewer {:name nextjournal.clerk.viewer/map-viewer, :render-fn #clerk/render-fn+opts [{:render-evaluator :sci} nextjournal.clerk.render/render-map], :opening-paren "{", :page-size 10, :hash "5drc3ac5ux7kS4h2vozdxwsrKDqSmn"}, :nextjournal/render-opts {:auto-expand-results? true, :id "config-processor/anon-expr-5dqoCBE3VwzUMTpF3KG4KEeT4AnHhV-result-1"}}, :nextjournal/blob-id "5dtnDtwBjbnosMTso3bCaifAFtgLWY"}, :nextjournal/render-opts {:auto-expand-results? true, :id "config-processor/anon-expr-5dqoCBE3VwzUMTpF3KG4KEeT4AnHhV-result-1"}, :nextjournal/viewer {:name nextjournal.clerk.viewer/result-viewer, :render-fn #clerk/render-fn+opts [{:render-evaluator :sci} nextjournal.clerk.render/render-result], :hash "5dtGVHesd2XCTLFYF3aY4kJvkrX1x1"}}], :nextjournal/viewer {:name nextjournal.clerk.viewer/cell-viewer, :render-fn #clerk/render-fn+opts [{:render-evaluator :sci} (fn [xs opts] (into [:<>] (nextjournal.clerk.render/inspect-children opts) xs))], :hash "5dtX6xLh3vbeFdswBY6jLXmB8QTqo2"}} {:path [], :nextjournal/value [{:path [0], :nextjournal/value "(-> (:resources-map (process-stack (:stack test-config-2) test-config-2 (select-keys test-config-2 [:app-name :app-namespace])))\n    (get :provider-template:storage-class))", :nextjournal/render-opts {:loc {:line 466, :end-line 467, :column 1, :end-column 44}, :id "config-processor/anon-expr-5dr4tZ4myXmzdcsNesPFFUvpdG723z-code"}, :nextjournal/viewer {:name nextjournal.clerk.viewer/code-block-viewer, :render-fn #clerk/render-fn+opts [{:render-evaluator :sci} nextjournal.clerk.render/render-code-block], :hash "5dru1FUcVRTRrVKJFbNw4FG2wXmiwB"}} {:path [1], :nextjournal/value {:nextjournal/presented {:path [1], :nextjournal/value nil, :nextjournal/viewer {:name nextjournal.clerk.viewer/nil-viewer, :render-fn #clerk/render-fn+opts [{:render-evaluator :sci} (fn [_] [:span.cmt-default.inspected-value "nil"])], :hash "5ds5uDqqy4yJDMFDdH4gQZN84hJLZM"}, :nextjournal/render-opts {:id "config-processor/anon-expr-5dr4tZ4myXmzdcsNesPFFUvpdG723z-result-1"}}, :nextjournal/blob-id "5drccoonSEoRqD7zffjwm9Z72hQSwy"}, :nextjournal/render-opts {:id "config-processor/anon-expr-5dr4tZ4myXmzdcsNesPFFUvpdG723z-result-1"}, :nextjournal/viewer {:name nextjournal.clerk.viewer/result-viewer, :render-fn #clerk/render-fn+opts [{:render-evaluator :sci} nextjournal.clerk.render/render-result], :hash "5dtGVHesd2XCTLFYF3aY4kJvkrX1x1"}}], :nextjournal/viewer {:name nextjournal.clerk.viewer/cell-viewer, :render-fn #clerk/render-fn+opts [{:render-evaluator :sci} (fn [xs opts] (into [:<>] (nextjournal.clerk.render/inspect-children opts) xs))], :hash "5dtX6xLh3vbeFdswBY6jLXmB8QTqo2"}} {:path [], :nextjournal/value [{:path [0], :nextjournal/value "@debug-log", :nextjournal/render-opts {:loc {:line 469, :end-line 471, :column 1, :end-column 11}, :id "config-processor/anon-expr-5dsBSE6dH6Vm1FP2FUVRkEmcciYWLu-code"}, :nextjournal/viewer {:name nextjournal.clerk.viewer/code-block-viewer, :render-fn #clerk/render-fn+opts [{:render-evaluator :sci} nextjournal.clerk.render/render-code-block], :hash "5dru1FUcVRTRrVKJFbNw4FG2wXmiwB"}} {:path [1], :nextjournal/value {:nextjournal/presented {:path [1], :nextjournal/value [{:path [1 0], :nextjournal/value :provider-template:storage-class, :nextjournal/viewer {:name nextjournal.clerk.viewer/keyword-viewer, :render-fn #clerk/render-fn+opts [{:render-evaluator :sci} (fn [x] [:span.cmt-atom.inspected-value (str x)])], :hash "5dsp5Uy2KDqwuALVVk33HXMZdpXGBq"}}], :nextjournal/viewer {:name nextjournal.clerk.viewer/vector-viewer, :render-fn #clerk/render-fn+opts [{:render-evaluator :sci} nextjournal.clerk.render/render-coll], :opening-paren "[", :closing-paren ("]"), :page-size 20, :hash "5dsD1KJESfc8Dy8gPeGQfZCX2ayE8f"}, :nextjournal/render-opts {:auto-expand-results? true, :id "config-processor/anon-expr-5dsBSE6dH6Vm1FP2FUVRkEmcciYWLu-result-1"}}, :nextjournal/blob-id "5dtaYmkzg7sKVy4dYSaFbJPFehqrx9"}, :nextjournal/render-opts {:auto-expand-results? true, :id "config-processor/anon-expr-5dsBSE6dH6Vm1FP2FUVRkEmcciYWLu-result-1"}, :nextjournal/viewer {:name nextjournal.clerk.viewer/result-viewer, :render-fn #clerk/render-fn+opts [{:render-evaluator :sci} nextjournal.clerk.render/render-result], :hash "5dtGVHesd2XCTLFYF3aY4kJvkrX1x1"}}], :nextjournal/viewer {:name nextjournal.clerk.viewer/cell-viewer, :render-fn #clerk/render-fn+opts [{:render-evaluator :sci} (fn [xs opts] (into [:<>] (nextjournal.clerk.render/inspect-children opts) xs))], :hash "5dtX6xLh3vbeFdswBY6jLXmB8QTqo2"}}]}, :nextjournal/viewer {:name nextjournal.clerk.viewer/notebook-viewer, :render-fn #clerk/render-fn+opts [{:render-evaluator :sci} nextjournal.clerk.render/render-notebook], :hash "5duAFDxE4sCnRX71Wo6zeCpC9C3djE"}, :katex? nil}